(function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(n){return 0==n?0:n>0?1:-1});var n={subtract:function(n,t){return{x:n.x-t.x,y:n.y-t.y}},dotProduct:function(n,t){return n.x*t.x+n.y*t.y},square:function(n){return Math.sqrt(n.x*n.x+n.y*n.y)},scale:function(n,t){return{x:n.x*t,y:n.y*t}}},e=64,l=Math.pow(2,-e-1),o=function(t,i){for(var f,h=[],a=v(t,i),c=i.length-1,y=2*c-1,p=r(a,y,h,0),e=n.subtract(t,i[0]),o=n.square(e),l=0,s=0;p>s;s++)e=n.subtract(t,u(i,c,h[s],null,null)),f=n.square(e),o>f&&(o=f,l=h[s]);return e=n.subtract(t,i[c]),f=n.square(e),o>f&&(o=f,l=1),{location:l,distance:o}},a=function(n,t){var i=o(n,t);return{point:u(t,t.length-1,i.location,null,null),location:i.location}},v=function(t,i){for(var f,o,p,w,u=i.length-1,l=2*u-1,a=[],h=[],c=[],e=[],b=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],r=0;u>=r;r++)a[r]=n.subtract(i[r],t);for(r=0;u-1>=r;r++)h[r]=n.subtract(i[r+1],i[r]),h[r]=n.scale(h[r],3);for(f=0;u-1>=f;f++)for(o=0;u>=o;o++)c[f]||(c[f]=[]),c[f][o]=n.dotProduct(h[f],a[o]);for(r=0;l>=r;r++)e[r]||(e[r]=[]),e[r].y=0,e[r].x=parseFloat(r)/l;for(var v=u,y=u-1,s=0;v+y>=s;s++)for(p=Math.max(0,s-y),w=Math.min(s,v),r=p;w>=r;r++)j=s-r,e[r+j].y+=c[j][r]*b[j][r];return e},r=function(n,t,i,f){var s,h,c=[],l=[],a=[],v=[],o;switch(y(n,t)){case 0:return 0;case 1:if(f>=e)return i[0]=(n[0].x+n[t].x)/2,1;if(p(n,t))return i[0]=w(n,t),1}for(u(n,t,.5,c,l),s=r(c,t,a,f+1),h=r(l,t,v,f+1),o=0;s>o;o++)i[o]=a[o];for(o=0;h>o;o++)i[o+s]=v[o];return s+h},y=function(n,t){for(var u,f=0,i=u=Math.sgn(n[0].y),r=1;t>=r;r++)i=Math.sgn(n[r].y),i!=u&&f++,u=i;return f},p=function(n,t){var d,p,w,g,nt,e,o,s,h,c,b,r,k,a,i,v,y,u,f;for(e=n[0].y-n[t].y,o=n[t].x-n[0].x,s=n[0].x*n[t].y-n[t].x*n[0].y,y=max_distance_below=0,u=1;t>u;u++)f=e*n[u].x+o*n[u].y+s,f>y?y=f:max_distance_below>f&&(max_distance_below=f);return b=0,r=1,k=0,a=e,i=o,v=s-y,h=b*i-a*r,c=1/h,p=(r*v-i*k)*c,a=e,i=o,v=s-max_distance_below,h=b*i-a*r,c=1/h,w=(r*v-i*k)*c,g=Math.min(p,w),nt=Math.max(p,w),d=nt-g,l>d?1:0},w=function(n,t){var i=1,r=n[t].x-n[0].x,u=n[t].y-n[0].y,f=n[0].x-0,e=n[0].y-0,o=r*0-u*i,s=1/o,h=(r*e-u*f)*s;return 0+i*h},u=function(n,t,i,r,u){for(var o,e=[[]],f=0;t>=f;f++)e[0][f]=n[f];for(o=1;t>=o;o++)for(f=0;t-o>=f;f++)e[o]||(e[o]=[]),e[o][f]||(e[o][f]={}),e[o][f].x=(1-i)*e[o-1][f].x+i*e[o-1][f+1].x,e[o][f].y=(1-i)*e[o-1][f].y+i*e[o-1][f+1].y;if(null!=r)for(f=0;t>=f;f++)r[f]=e[f][0];if(null!=u)for(f=0;t>=f;f++)u[f]=e[t-f][f];return e[t][0]},s={},b=function(n){var t=s[n],r,u,i;if(!t){t=[];var f=function(){return function(t){return Math.pow(t,n)}},e=function(){return function(t){return Math.pow(1-t,n)}},o=function(n){return function(){return n}},h=function(){return function(n){return n}},c=function(){return function(n){return 1-n}},l=function(n){return function(t){for(var r=1,i=0;i<n.length;i++)r*=n[i](t);return r}};for(t.push(new f),r=1;n>r;r++){for(u=[new o(n)],i=0;n-r>i;i++)u.push(new h);for(i=0;r>i;i++)u.push(new c);t.push(new l(u))}t.push(new e);s[n]=t}return t},t=function(n,t){for(var r=b(n.length-1),u=0,f=0,i=0;i<n.length;i++)u+=n[i].x*r[i](t),f+=n[i].y*r[i](t);return{x:u,y:f}},h=function(n,t){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},c=function(n){return n[0].x==n[1].x&&n[0].y==n[1].y},i=function(n,i,r){if(c(n))return{point:n[0],location:i};for(var e=t(n,i),o=0,f=i,s=r>0?1:-1,u=null;o<Math.abs(r);)f+=.005*s,u=t(n,f),o+=h(u,e),e=u;return{point:u,location:f}},k=function(n){if(c(n))return 0;for(var u=t(n,0),f=0,i=0,r=null;1>i;)i+=.005*1,r=t(n,i),f+=h(r,u),u=r;return f},d=function(n,t,r){return i(n,t,r).point},g=function(n,t,r){return i(n,t,r).location},f=function(n,i){var r=t(n,i),u=t(n.slice(0,n.length-1),i),f=u.y-r.y,e=u.x-r.x;return 0==f?1/0:Math.atan(f/e)},nt=function(n,t,r){var u=i(n,t,r);return u.location>1&&(u.location=1),u.location<0&&(u.location=0),f(n,u.location)},tt=function(n,t,r,u){u=null==u?0:u;var e=i(n,t,u),c=f(n,e.location),o=Math.atan(-1/c),s=r/2*Math.sin(o),h=r/2*Math.cos(o);return[{x:e.point.x+h,y:e.point.y+s},{x:e.point.x-h,y:e.point.y-s}]};this.jsBezier={distanceFromCurve:o,gradientAtPoint:f,gradientAtPointAlongCurveFrom:nt,nearestPointOnCurve:a,pointOnCurve:t,pointAlongCurveFrom:d,perpendicularToCurveAt:tt,locationAlongCurveFrom:g,getLength:k}}).call(this),function(){"use strict";var n=this.Biltong={},r=function(n){return"[object Array]"===Object.prototype.toString.call(n)},t=function(n,t,i){return n=r(n)?n:[n.x,n.y],t=r(t)?t:[t.x,t.y],i(n,t)},i=n.gradient=function(n,i){return t(n,i,function(n,t){return t[0]==n[0]?t[1]>n[1]?1/0:-1/0:t[1]==n[1]?t[0]>n[0]?0:-0:(t[1]-n[1])/(t[0]-n[0])})},u=(n.normal=function(n,t){return-1/i(n,t)},n.lineLength=function(n,i){return t(n,i,function(n,t){return Math.sqrt(Math.pow(t[1]-n[1],2)+Math.pow(t[0]-n[0],2))})},n.quadrant=function(n,i){return t(n,i,function(n,t){return t[0]>n[0]?t[1]>n[1]?2:1:t[0]==n[0]?t[1]>n[1]?2:1:t[1]>n[1]?3:4})}),f=(n.theta=function(n,r){return t(n,r,function(n,t){var e=i(n,t),r=Math.atan(e),f=u(n,t);return(4==f||3==f)&&(r+=Math.PI),0>r&&(r+=2*Math.PI),r})},n.intersects=function(n,t){var i=n.x,s=n.x+n.w,u=n.y,f=n.y+n.h,r=t.x,h=t.x+t.w,e=t.y,o=t.y+t.h;return r>=i&&s>=r&&e>=u&&f>=e||h>=i&&s>=h&&e>=u&&f>=e||r>=i&&s>=r&&o>=u&&f>=o||h>=i&&s>=r&&o>=u&&f>=o||i>=r&&h>=i&&u>=e&&o>=u||s>=r&&h>=s&&u>=e&&o>=u||i>=r&&h>=i&&f>=e&&o>=f||s>=r&&h>=i&&f>=e&&o>=f},n.encloses=function(n,t,i){var u=n.x,f=n.x+n.w,e=n.y,o=n.y+n.h,s=t.x,h=t.x+t.w,c=t.y,l=t.y+t.h,r=function(n,t,r,u){return i?t>=n&&r>=u:t>n&&r>u};return r(u,s,f,h)&&r(e,c,o,l)},[null,[1,-1],[1,1],[-1,1],[-1,-1]]),e=[null,[-1,-1],[-1,1],[1,1],[1,-1]];n.pointOnLine=function(n,t,r){var c=i(n,t),o=u(n,t),s=r>0?f[o]:e[o],h=Math.atan(c),l=Math.abs(r*Math.sin(h))*s[1],a=Math.abs(r*Math.cos(h))*s[0];return{x:n.x+a,y:n.y+l}};n.perpendicularLineTo=function(n,t,r){var o=i(n,t),u=Math.atan(-1/o),f=r/2*Math.sin(u),e=r/2*Math.cos(u);return[{x:t.x+e,y:t.y+f},{x:t.x-e,y:t.y-f}]}}.call(this),function(){"use strict";var v={android:navigator.userAgent.toLowerCase().indexOf("android")>-1},r=function(n,t,i){i=i||n.parentNode;for(var u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1},e=function(n){return"string"==typeof n?document.getElementById(n):n},u=function(n){return n.srcElement||n.target},y=function(n,t){for(var i=0,r=n.length;r>i&&n[i]!=t;i++);i<n.length&&n.splice(i,1)},g=1,p=function(n,t,i){var r=g++;return n.__ta=n.__ta||{},n.__ta[t]=n.__ta[t]||{},n.__ta[t][r]=i,i.__tauid=r,r},nt=function(n,t,i){if(n.__ta&&n.__ta[t]&&delete n.__ta[t][i.__tauid],i.__taExtra){for(var r=0;r<i.__taExtra.length;r++)c(n,i.__taExtra[r][0],i.__taExtra[r][1]);i.__taExtra.length=0}i.__taUnstore&&i.__taUnstore()},o=function(n,t,i,f){if(null==n)return i;var o=n.split(","),e=function(n){e.__tauid=i.__tauid;for(var s=u(n),f=0;f<o.length;f++)r(s,o[f],t)&&i.apply(s,arguments)};return tt(i,f,e),e},tt=function(n,t,i){n.__taExtra=n.__taExtra||[];n.__taExtra.push([t,i])},t=function(t,r,u,f){if(i&&n[r]){var e=o(f,t,u,n[r]);h(t,n[r],e,u)}"focus"===r&&null==t.getAttribute("tabindex")&&t.setAttribute("tabindex","1");h(t,r,o(f,t,u,r),u)},it=function(n,i,r,f){if(null==n.__taSmartClicks){var e=function(t){n.__tad=s(t)},o=function(t){n.__tau=s(t)},h=function(t){if(n.__tad&&n.__tau&&n.__tad[0]===n.__tau[0]&&n.__tad[1]===n.__tau[1])for(var i=0;i<n.__taSmartClicks.length;i++)n.__taSmartClicks[i].apply(u(t),[t])};t(n,"mousedown",e,f);t(n,"mouseup",o,f);t(n,"click",h,f);n.__taSmartClicks=[]}n.__taSmartClicks.push(r);r.__taUnstore=function(){y(n.__taSmartClicks,r)}},w={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},rt=function(n,i){return function(e,o,s,h){if("contextmenu"==o&&f)t(e,o,s,h);else{if(null==e.__taTapHandler){var c=e.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},l=function(t){for(var f=t.srcElement||t.target,u=0;u<c.downSelectors.length;u++)if(null==c.downSelectors[u]||r(f,c.downSelectors[u],e)){c.down=!0;setTimeout(v,n);setTimeout(p,i);break}},a=function(n){var o,s,t,f,i;if(c.down){o=n.srcElement||n.target;c.taps++;s=ht(n);for(t in w)if(f=w[t],f.touches===s&&(1===f.taps||f.taps===c.taps))for(i=0;i<c[t].length;i++)(null==c[t][i][1]||r(o,c[t][i][1],e))&&c[t][i][0].apply(u(n),[n])}},v=function(){c.down=!1},p=function(){c.taps=0};t(e,"mousedown",l);t(e,"mouseup",a)}e.__taTapHandler.downSelectors.push(h);e.__taTapHandler[o].push([s,h]);s.__taUnstore=function(){y(e.__taTapHandler[o],s)}}}},b=function(n,t,i,r){for(var u in i.__tamee[n])i.__tamee[n][u].apply(r,[t])},ut=function(){var n=[];return function(t,i,f,e){if(!t.__tamee){t.__tamee={over:!1,mouseenter:[],mouseexit:[]};var s=function(i){var f=u(i);(null!=e||f!=t||t.__tamee.over)&&(!r(f,e,t)||null!=f.__tamee&&f.__tamee.over)||(b("mouseenter",i,t,f),f.__tamee=f.__tamee||{},f.__tamee.over=!0,n.push(f))},c=function(i){for(var f=u(i),e=0;e<n.length;e++)f!=n[e]||r(i.relatedTarget||i.toElement,"*",f)||(f.__tamee.over=!1,n.splice(e,1),b("mouseexit",i,t,f))};h(t,"mouseover",o(e,t,s,"mouseover"),s);h(t,"mouseout",o(e,t,c,"mouseout"),c)}f.__taUnstore=function(){delete t.__tamee[i][f.__tauid]};p(t,i,f);t.__tamee[i][f.__tauid]=f}},i="ontouchstart"in document.documentElement,f="onmousedown"in document.documentElement,n={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},k=function(){var n=-1,t,i;return"Microsoft Internet Explorer"==navigator.appName&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=i.exec(t)&&(n=parseFloat(RegExp.$1))),n}(),ft=k>-1&&9>k,a=function(n,t){if(null==n)return[0,0];var r=d(n),i=st(r,0);return[i[t+"X"],i[t+"Y"]]},s=function(n){return null==n?[0,0]:ft?[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop]:a(n,"page")},et=function(n){return a(n,"screen")},ot=function(n){return a(n,"client")},st=function(n,t){return n.item?n.item(t):n[t]},d=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},ht=function(n){return d(n).length},h=function(n,t,i,r){if(p(n,t,i),r.__tauid=i.__tauid,n.addEventListener)n.addEventListener(t,i,!1);else if(n.attachEvent){var u=t+i.__tauid;n["e"+u]=i;n[u]=function(){n["e"+u]&&n["e"+u](window.event)};n.attachEvent("on"+t,n[u])}},c=function(t,r,u){null!=u&&l(t,function(){var f=e(this),o;(nt(f,r,u),null!=u.__tauid)&&(f.removeEventListener?(f.removeEventListener(r,u,!1),i&&n[r]&&f.removeEventListener(n[r],u,!1)):this.detachEvent&&(o=r+u.__tauid,f[o]&&f.detachEvent("on"+r,f[o]),f[o]=null,f["e"+o]=null));u.__taTouchProxy&&c(t,u.__taTouchProxy[1],u.__taTouchProxy[0])})},l=function(n,t){if(null!=n){n="undefined"!=typeof Window&&"unknown"!=typeof n.top&&n==n.top?[n]:"string"!=typeof n&&null==n.tagName&&null!=n.length?n:"string"==typeof n?document.querySelectorAll(n):[n];for(var i=0;i<n.length;i++)t.apply(n[i])}};this.Mottle=function(r){r=r||{};var u=r.clickThreshold||150,o=r.dblClickThreshold||350,h=new ut,a=new rt(u,o),y=r.smartClicks,p=function(n,i,r,u){null!=r&&l(n,function(){var n=e(this);y&&"click"===i?it(n,i,r,u):"tap"===i||"dbltap"===i||"contextmenu"===i?a(n,i,r,u):"mouseenter"===i||"mouseexit"==i?h(n,i,r,u):t(n,i,r,u)})};this.remove=function(n){return l(n,function(){var n=e(this),t,i;if(n.__ta)for(t in n.__ta)for(i in n.__ta[t])c(n,t,n.__ta[t][i]);n.parentNode&&n.parentNode.removeChild(n)}),this};this.on=function(){var n=arguments[0],t=4==arguments.length?arguments[2]:null,i=arguments[1],r=arguments[arguments.length-1];return p(n,i,r,t),this};this.off=function(n,t,i){return c(n,t,i),this};this.trigger=function(t,r,u,o){var p=f&&("undefined"==typeof MouseEvent||null==u||u.constructor===MouseEvent),a=i&&!f&&n[r]?n[r]:r,w=!(i&&!f&&n[r]),y=s(u),h=et(u),c=ot(u);return l(t,function(){var t,f=e(this),s,b,k,l;u=u||{screenX:h[0],screenY:h[1],clientX:c[0],clientY:c[1]};s=function(n){o&&(n.payload=o)};b={TouchEvent:function(n){var t=document.createTouch(window,f,0,y[0],y[1],h[0],h[1],c[0],c[1],0,0,0,0),i=document.createTouchList(t),r=document.createTouchList(t),u=document.createTouchList(t);n.initTouchEvent(a,!0,!0,window,null,h[0],h[1],c[0],c[1],!1,!1,!1,!1,i,r,u,1,0)},MouseEvents:function(n){if(n.initMouseEvent(a,!0,!0,window,0,h[0],h[1],c[0],c[1],!1,!1,!1,!1,1,f),v.android){var t=document.createTouch(window,f,0,y[0],y[1],h[0],h[1],c[0],c[1],0,0,0,0);n.touches=n.targetTouches=n.changedTouches=document.createTouchList(t)}}};document.createEvent?(k=!w&&!p&&i&&n[r]&&!v.android,l=k?"TouchEvent":"MouseEvents",t=document.createEvent(l),b[l](t),s(t),f.dispatchEvent(t)):document.createEventObject&&(t=document.createEventObject(),t.eventType=t.eventName=a,t.screenX=h[0],t.screenY=h[1],t.clientX=c[0],t.clientY=c[1],s(t),f.fireEvent("on"+a,t))}),this}};Mottle.consume=function(n,t){n.stopPropagation?n.stopPropagation():n.returnValue=!1;!t&&n.preventDefault&&n.preventDefault()};Mottle.pageLocation=s;Mottle.setForceTouchEvents=function(n){i=n};Mottle.setForceMouseEvents=function(n){f=n}}.call(this),function(){"use strict";var a=function(n){var r=n.getBoundingClientRect(),t=document.body,i=document.documentElement,u=window.pageYOffset||i.scrollTop||t.scrollTop,f=window.pageXOffset||i.scrollLeft||t.scrollLeft,e=i.clientTop||t.clientTop||0,o=i.clientLeft||t.clientLeft||0,s=r.top+u-e,h=r.left+f-o;return{top:Math.round(s),left:Math.round(h)}},f=function(n,t,i){i=i||n.parentNode;for(var u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1},e=function(){var n=-1,t,i;return"Microsoft Internet Explorer"==navigator.appName&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=i.exec(t)&&(n=parseFloat(RegExp.$1))),n}(),v=50,y=50,p=e>-1&&9>e,o=function(n){if(p)return[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop];var i=b(n),t=w(i,0);return[t.pageX,t.pageY]},w=function(n,t){return n.item?n.item(t):n[t]},b=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},s={draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select"},k="katavorio-drag-scope",r=["stop","start","drag","drop","over","out"],d=function(){},g=function(){return!0},t=function(n,t,i){for(var r=0;r<n.length;r++)n[r]!=i&&t(n[r])},h=function(n,i,r,u){t(n,function(n){n.setActive(i);i&&n.updatePosition();r&&n.setHover(u,i)})},n=function(n,t){if(null!=n){n="string"!=typeof n&&null==n.tagName&&null!=n.length?n:[n];for(var i=0;i<n.length;i++)t.apply(n[i],[n[i]])}},c=function(n){n.stopPropagation?(n.stopPropagation(),n.preventDefault()):n.returnValue=!1},nt="input,textarea,select,button,option",tt=function(n,t,i){var r=n.srcElement||n.target;return!f(r,i.getInputFilterSelector(),t)},l=function(t,i,r,f){this.params=i||{};this.el=t;this.params.addClass(this.el,this._class);this.uuid=u();var e=!0;return this.setEnabled=function(n){e=n},this.isEnabled=function(){return e},this.toggleEnabled=function(){e=!e},this.setScope=function(n){this.scopes=n?n.split(/\s+/):[f]},this.addScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){i[n]=!0});this.scopes=[];for(r in i)this.scopes.push(r)},this.removeScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){delete i[n]});this.scopes=[];for(r in i)this.scopes.push(r)},this.toggleScope=function(t){var i={},r;n(this.scopes,function(n){i[n]=!0});n(t?t.split(/\s+/):[],function(n){i[n]?delete i[n]:i[n]=!0});this.scopes=[];for(r in i)this.scopes.push(r)},this.setScope(i.scope),this.k=i.katavorio,i.katavorio},it=function(n,t,i){var s,nt,it,ut,e,b;this._class=i.draggable;s=l.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var p=[0,0],k=null,d=!1,et=this.params.consumeStartEvent!==!1,r=this.el,ft=this.params.clone;this.params.scroll;t.multipleDrop!==!1;nt=t.snapThreshold||5;it=function(n,t,i,r,u){r=r||nt;u=u||nt;var h=Math.floor(n[0]/t),f=t*h,o=f+t,c=Math.abs(n[0]-f)<=r?f:Math.abs(o-n[0])<=r?o:n[0],l=Math.floor(n[1]/i),e=i*l,s=e+i,a=Math.abs(n[1]-e)<=u?e:Math.abs(s-n[1])<=u?s:n[1];return[c,a]};this.toGrid=function(n){return null==this.params.grid?n:it(n,this.params.grid[0],this.params.grid[1])};this.snap=function(n,t){if(null!=r){n=n||(this.params.grid?this.params.grid[0]:v);t=t||(this.params.grid?this.params.grid[1]:y);var i=this.params.getPosition(r);this.params.setPosition(r,it(i,n,t,n,t))}};this.constrain="function"==typeof this.params.constrain?this.params.constrain:this.params.constrain||this.params.containment?function(n){return[Math.max(0,Math.min(ut.w-this.size[0],n[0])),Math.max(0,Math.min(ut.h-this.size[1],n[1]))]}:function(n){return n};var ot=function(n){return"function"==typeof n?(n._katavorioId=u(),n._katavorioId):n},w={},st=function(n){var r,i,t;for(r in w)if(i=w[r],t=i[0](n),i[1]&&(t=!t),!t)return!1;return!0},rt=this.setFilter=function(t,i){if(t){var r=ot(t);w[r]=[function(i){var r,u=i.srcElement||i.target;return"string"==typeof t?r=f(u,t,n):"function"==typeof t&&(r=t(i,n)),r},i!==!1]}};this.addFilter=rt;this.removeFilter=function(n){var t="function"==typeof n?n._katavorioId:n;delete w[t]};this.clearAllFilters=function(){w={}};this.canDrag=this.params.canDrag||g;e=[];b=[];this.downListener=function(n){var f=this.rightButtonCanDrag||3!==n.which&&2!==n.button,u,t;f&&this.isEnabled()&&this.canDrag()&&(u=st(n)&&tt(n,this.el,this.k),u?(ft?(r=this.el.cloneNode(!0),r.setAttribute("id",null),r.style.position="absolute",t=a(this.el),r.style.left=t.left+"px",r.style.top=t.top+"px",document.body.appendChild(r)):r=this.el,et&&c(n),p=o(n),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),s.markSelection(this),this.params.addClass(document.body,i.noSelect)):this.params.consumeFilteredEvents&&c(n))}.bind(this);this.moveListener=function(n){var r;if(p){if(!d&&(r=this.params.events.start({el:this.el,pos:k,e:n,drag:this}),r!==!1)){if(!p)return;this.mark(!0);d=!0}if(p){b.length=0;var u=o(n),t=u[0]-p[0],i=u[1]-p[1],f=this.params.ignoreZoom?1:s.getZoom();t/=f;i/=f;this.moveBy(t,i,n);s.updateSelection(t,i,this)}}}.bind(this);this.upListener=function(n){p&&(p=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,i.noSelect),this.unmark(n),s.unmarkSelection(this,n),this.stop(n),s.notifySelectionDragStop(this,n),d=!1,ft&&(r&&r.parentNode&&r.parentNode.removeChild(r),r=null))}.bind(this);this.getFilters=function(){return w};this.abort=function(){null!=p&&this.upListener()};this.getDragElement=function(){return r||this.el};this.notifyStart=function(n){this.params.events.start({el:this.el,pos:this.params.getPosition(r),e:n,drag:this})};this.stop=function(n,t){var i,o;if(t||d){var f=[],u=s.getSelection(),e=this.params.getPosition(r);if(u.length>1)for(i=0;i<u.length;i++)o=this.params.getPosition(u[i].el),f.push([u[i].el,{left:o[0],top:o[1]},u[i]]);else f.push([r,{left:e[0],top:e[1]},this]);this.params.events.stop({el:r,pos:e,e:n,drag:this,selection:f})}};this.mark=function(n){if(k=this.params.getPosition(r),this.size=this.params.getSize(r),e=s.getMatchingDroppables(this),h(e,!0,!1,this),this.params.addClass(r,this.params.dragClass||i.drag),this.params.constrain||this.params.containment){var t=this.params.getSize(r.parentNode);ut={w:t[0],h:t[1]}}n&&s.notifySelectionDragStart(this)};this.unmark=function(n){var t,u;for(h(e,!1,!0,this),this.params.removeClass(r,this.params.dragClass||i.drag),e.length=0,t=0;t<b.length;t++)if(u=b[t].drop(this,n),u===!0)break};this.moveBy=function(n,t,i){var f,o,u,s;for(b.length=0,f=this.constrain(this.toGrid([k[0]+n,k[1]+t]),r),o={x:f[0],y:f[1],w:this.size[0],h:this.size[1]},this.params.setPosition(r,f),u=0;u<e.length;u++)s={x:e[u].position[0],y:e[u].position[1],w:e[u].size[0],h:e[u].size[1]},this.params.intersects(o,s)&&e[u].canDrop(this)?(b.push(e[u]),e[u].setHover(this,!0,i)):e[u].isHover()&&e[u].setHover(this,!1,i);this.params.events.drag({el:this.el,pos:f,e:i,drag:this})};this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener);this.params.unbind(document,"mousemove",this.moveListener);this.params.unbind(document,"mouseup",this.upListener);this.downListener=null;this.upListener=null;this.moveListener=null};this.params.bind(this.el,"mousedown",this.downListener);this.params.handle?rt(this.params.handle,!1):rt(this.params.filter,this.params.filterExclude)},rt=function(n,t,i){this._class=i.droppable;this.params=t||{};this._activeClass=t.activeClass||i.active;this._hoverClass=t.hoverClass||i.hover;l.apply(this,arguments);var r=!1;this.setActive=function(n){this.params[n?"addClass":"removeClass"](this.el,this._activeClass)};this.updatePosition=function(){this.position=this.params.getPosition(this.el);this.size=this.params.getSize(this.el)};this.canDrop=this.params.canDrop||function(){return!0};this.isHover=function(){return r};this.setHover=function(n,t,i){(t||null==this.el._katavorioDragHover||this.el._katavorioDragHover==n.el._katavorio)&&(this.params[t?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=t?n.el._katavorio:null,r!==t&&this.params.events[t?"over":"out"]({el:this.el,e:i,drag:n,drop:this}),r=t)};this.drop=function(n,t){return this.params.events.drop({drag:n,e:t,drop:this})};this.destroy=function(){this._class=null;this._activeClass=null;this._hoverClass=null;r=null}},u=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=0|16*Math.random(),i="x"==n?t:8|3&t;return i.toString(16)})},i=function(n){return null==n?null:(n="string"==typeof n?document.getElementById(n):n,null==n?null:(n._katavorio=n._katavorio||u(),n))};this.Katavorio=function(u){var f=[],o={},h,a,c,v;this._dragsByScope={};this._dropsByScope={};var y=1,l=function(n,t){for(var i=0;i<n.scopes.length;i++)t[n.scopes[i]]=t[n.scopes[i]]||[],t[n.scopes[i]].push(n)},p=function(n,t){for(var f,r=0,i=0;i<n.scopes.length;i++)t[n.scopes[i]]&&(f=u.indexOf(t[n.scopes[i]],n),-1!=f&&(t[n.scopes[i]].splice(f,1),r++));return r>0},w=(this.getMatchingDroppables=function(n){for(var t,i,u=[],f={},r=0;r<n.scopes.length;r++)if(t=this._dropsByScope[n.scopes[r]],t)for(i=0;i<t.length;i++)t[i].canDrop(n)&&!f[t[i].uuid]&&t[i].el!==n.el&&(f[t[i].uuid]=!0,u.push(t[i]));return u},function(n){var i,t;n=n||{};i={events:{}};for(t in u)i[t]=u[t];for(t in n)i[t]=n[t];for(t=0;t<r.length;t++)i.events[r[t]]=n[r[t]]||d;return i.katavorio=this,i}.bind(this)),e={},b=u.css||{},g=u.scope||k;for(h in s)e[h]=s[h];for(h in b)e[h]=b[h];a=u.inputFilterSelector||nt;this.getInputFilterSelector=function(){return a};this.setInputFilterSelector=function(n){return a=n,this};this.draggable=function(t,r){var f=[];return n(t,function(n){if(n=i(n),null!=n){var t=w(r);n._katavorioDrag=new it(n,t,e,g);l(n._katavorioDrag,this._dragsByScope);f.push(n._katavorioDrag);u.addClass(n,e.draggable)}}.bind(this)),f};this.droppable=function(t,r){var f=[];return n(t,function(n){n=i(n);null!=n&&(n._katavorioDrop=new rt(n,w(r),e,g),l(n._katavorioDrop,this._dropsByScope),f.push(n._katavorioDrop),u.addClass(n,e.droppable))}.bind(this)),f};this.select=function(t){return n(t,function(){var n=i(this);n&&n._katavorioDrag&&(o[n._katavorio]||(f.push(n._katavorioDrag),o[n._katavorio]=[n,f.length-1],u.addClass(n,e.selected)))}),this};this.deselect=function(t){return n(t,function(){var n=i(this),s,r,t;if(n&&n._katavorio&&(s=o[n._katavorio],s)){for(r=[],t=0;t<f.length;t++)f[t].el!==n&&r.push(f[t]);f=r;delete o[n._katavorio];u.removeClass(n,e.selected)}}),this};this.deselectAll=function(){var n,t;for(n in o)t=o[n],u.removeClass(t[0],e.selected);f.length=0;o={}};this.markSelection=function(n){t(f,function(n){n.mark()},n)};this.unmarkSelection=function(n,i){t(f,function(n){n.unmark(i)},n)};this.getSelection=function(){return f.slice(0)};this.updateSelection=function(n,i,r){t(f,function(t){t.moveBy(n,i)},r)};this.notifySelectionDragStop=function(n,i){t(f,function(n){n.stop(i,!0)},n)};this.notifySelectionDragStart=function(n,i){t(f,function(n){n.notifyStart(i)},n)};this.setZoom=function(n){y=n};this.getZoom=function(){return y};c=function(n,t,i,r){null!=n&&(p(n,i),n[r](t),l(n,i))};n(["set","add","remove","toggle"],function(n){this[n+"Scope"]=function(t,i){c(t._katavorioDrag,i,this._dragsByScope,n+"Scope");c(t._katavorioDrop,i,this._dropsByScope,n+"Scope")}.bind(this);this[n+"DragScope"]=function(t,i){c(t._katavorioDrag,i,this._dragsByScope,n+"Scope")}.bind(this);this[n+"DropScope"]=function(t,i){c(t._katavorioDrop,i,this._dropsByScope,n+"Scope")}.bind(this)}.bind(this));this.snapToGrid=function(n,i){for(var r in this._dragsByScope)t(this._dragsByScope[r],function(t){t.snap(n,i)})};this.getDragsForScope=function(n){return this._dragsByScope[n]};this.getDropsForScope=function(n){return this._dropsByScope[n]};v=function(n,t,r){n=i(n);n[t]&&(p(n[t],r)&&n[t].destroy(),n[t]=null)};this.elementRemoved=function(n){this.destroyDraggable(n);this.destroyDroppable(n)};this.destroyDraggable=function(n){v(n,"_katavorioDrag",this._dragsByScope)};this.destroyDroppable=function(n){v(n,"_katavorioDrop",this._dropsByScope)};this.reset=function(){this._dragsByScope={};this._dropsByScope={};f=[];o={}}}}.call(this),function(){var t=function(n){return"[object Array]"===Object.prototype.toString.call(n)},o=function(n){return"[object Number]"===Object.prototype.toString.call(n)},r=function(n){return"string"==typeof n},u=function(n){return"boolean"==typeof n},s=function(n){return null==n},i=function(n){return null==n?!1:"[object Object]"===Object.prototype.toString.call(n)},f=function(n){return"[object Date]"===Object.prototype.toString.call(n)},e=function(n){return"[object Function]"===Object.prototype.toString.call(n)},h=function(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},c=this,n=c.jsPlumbUtil={isArray:t,isString:r,isBoolean:u,isNull:s,isObject:i,isDate:f,isFunction:e,isEmpty:h,isNumber:o,clone:function(n){var s,o,h,c;if(r(n))return""+n;if(u(n))return!!n;if(f(n))return new Date(n.getTime());if(e(n))return n;if(t(n)){for(s=[],o=0;o<n.length;o++)s.push(this.clone(n[o]));return s}if(i(n)){h={};for(c in n)h[c]=this.clone(n[c]);return h}return n},merge:function(n,f,e){var h,o,l={},s,c;for(e=e||[],o=0;o<e.length;o++)l[e[o]]=!0;s=this.clone(n);for(o in f)if(null==s[o])s[o]=f[o];else if(r(f[o])||u(f[o]))l[o]?(h=[],h.push.apply(h,t(s[o])?s[o]:[s[o]]),h.push.apply(h,t(f[o])?f[o]:[f[o]]),s[o]=h):s[o]=f[o];else if(t(f[o]))h=[],t(s[o])&&h.push.apply(h,s[o]),h.push.apply(h,f[o]),s[o]=h;else if(i(f[o])){i(s[o])||(s[o]={});for(c in f[o])s[o][c]=f[o][c]}return s},replace:function(n,t,i){if(null!=n){var u=n,r=u;return t.replace(/([^\.])+/g,function(n,t,u,f){var e=n.match(/([^\[0-9]+){1}(\[)([0-9+])/),h=u+n.length>=f.length,s=function(){return r[e[1]]||function(){return r[e[1]]=[],r[e[1]]}()},o;h?e?s()[e[3]]=i:r[n]=i:e?(o=s(),r=o[e[3]]||function(){return o[e[3]]={},o[e[3]]}()):r=r[n]||function(){return r[n]={},r[n]}()}),n}},functionChain:function(n,t,i){for(var u,r=0;r<i.length;r++)if(u=i[r][0][i[r][1]].apply(i[r][0],i[r][2]),u===t)return u;return n},populate:function(n,u){var e=function(n){var i=n.match(/(\${.*?})/g),t,r;if(null!=i)for(t=0;t<i.length;t++)r=u[i[t].substring(2,i[t].length-1)]||"",null!=r&&(n=n.replace(i[t],r));return n},f=function(n){var o,u,s,h;if(null!=n){if(r(n))return e(n);if(t(n)){for(o=[],u=0;u<n.length;u++)o.push(f(n[u]));return o}if(i(n)){s={};for(h in n)s[h]=f(n[h]);return s}return n}};return f(n)},convertStyle:function(n,t){var i;if("transparent"===n)return n;var u=n,e=function(n){return 1==n.length?"0"+n:n},r=function(n){return e(Number(n).toString(16))},f=/(rgb[a]?\()(.*)(\))/;return n.match(f)&&(i=n.match(f)[2].split(","),u="#"+r(i[0])+r(i[1])+r(i[2]),t||4!=i.length||(u+=r(i[3]))),u},findWithFunction:function(n,t){if(n)for(var i=0;i<n.length;i++)if(t(n[i]))return i;return-1},indexOf:function(t,i){return t.indexOf?t.indexOf(i):n.findWithFunction(t,function(n){return n==i})},removeWithFunction:function(t,i){var r=n.findWithFunction(t,i);return r>-1&&t.splice(r,1),-1!=r},remove:function(t,i){var r=n.indexOf(t,i);return r>-1&&t.splice(r,1),-1!=r},addWithFunction:function(t,i,r){-1==n.findWithFunction(t,r)&&t.push(i)},addToList:function(n,t,i,r){var u=n[t];return null==u&&(u=[],n[t]=u),u[r?"unshift":"push"](i),u},extend:function(n,i){var r,u,f,e;for(i=t(i)?i:[i],r=0;r<i.length;r++)for(u in i[r].prototype)i[r].prototype.hasOwnProperty(u)&&(n.prototype[u]=i[r].prototype[u]);if(f=function(n,t){return function(){for(r=0;r<i.length;r++)i[r].prototype[n]&&i[r].prototype[n].apply(this,arguments);return t.apply(this,arguments)}},e=function(t){for(var i in t)n.prototype[i]=f(i,t[i])},arguments.length>2)for(r=2;r<arguments.length;r++)e(arguments[r]);return n},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=0|16*Math.random(),i="x"==n?t:8|3&t;return i.toString(16)})},logEnabled:!0,log:function(){if(n.logEnabled&&"undefined"!=typeof console)try{var t=arguments[arguments.length-1];console.log(t)}catch(i){}},wrap:function(t,i,r){return t=t||function(){},i=i||function(){},function(){var u=null;try{u=i.apply(this,arguments)}catch(f){n.log("jsPlumb function failed : "+f)}if(null==r||u!==r)try{u=t.apply(this,arguments)}catch(f){n.log("wrapped function failed : "+f)}return u}}};n.EventGenerator=function(){var t={},i=!1,r={ready:!0};this.bind=function(i,r,u){var e=function(i){n.addToList(t,i,r,u);r.__jsPlumb=r.__jsPlumb||{};r.__jsPlumb[jsPlumbUtil.uuid()]=i},f;if("string"==typeof i)e(i);else if(null!=i.length)for(f=0;f<i.length;f++)e(i[f]);return this};this.fire=function(u,f,e){if(!i&&t[u]){var c=t[u].length,o=0,s=!1,h=null;if(!this.shouldFireEvent||this.shouldFireEvent(u,f,e))for(;!s&&c>o&&h!==!1;){if(r[u])t[u][o].apply(this,[f,e]);else try{h=t[u][o].apply(this,[f,e])}catch(l){n.log("jsPlumb: fire failed for event "+u+" : "+l)}o++;(null==t||null==t[u])&&(s=!0)}}return this};this.unbind=function(i,r){var u,f;if(0===arguments.length)t={};else if(1===arguments.length){if("string"==typeof i)delete t[i];else if(i.__jsPlumb)for(f in i.__jsPlumb)u=i.__jsPlumb[f],n.remove(t[u]||[],i)}else 2===arguments.length&&n.remove(t[i]||[],r);return this};this.getListener=function(n){return t[n]};this.setSuspendEvents=function(n){i=n};this.isSuspendEvents=function(){return i};this.silently=function(n){this.setSuspendEvents(!0);try{n()}catch(t){jsPlumbUtil.log("Cannot execute silent function "+t)}this.setSuspendEvents(!1)};this.cleanupListeners=function(){for(var n in t)t[n]=null}};n.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}};Function.prototype.bind||(Function.prototype.bind=function(n){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var r=Array.prototype.slice.call(arguments,1),u=this,t=function(){},i=function(){return u.apply(this instanceof t&&n?this:n,r.concat(Array.prototype.slice.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i})}.call(this),function(){"use strict";var t=this,n=t.jsPlumbUtil;n.ieVersion=/MSIE\s([\d.]+)/.test(navigator.userAgent)?new Number(RegExp.$1):-1;n.oldIE=n.ieVersion>-1&&n.ieVersion<9;n.matchesSelector=function(n,t,i){i=i||n.parentNode;for(var u=i.querySelectorAll(t),r=0;r<u.length;r++)if(u[r]===n)return!0;return!1};n.consume=function(n,t){n.stopPropagation?n.stopPropagation():n.returnValue=!1;!t&&n.preventDefault&&n.preventDefault()};n.sizeElement=function(n,t,i,r,u){n&&(n.style.height=u+"px",n.height=u,n.style.width=r+"px",n.width=r,n.style.left=t+"px",n.style.top=i+"px")}}.call(this),function(){"use strict";var e,y=this,u=[],t=y.jsPlumbUtil,r=function(){return""+(new Date).getTime()},c=function(t){if(t._jsPlumb.paintStyle&&t._jsPlumb.hoverPaintStyle){var i={};n.extend(i,t._jsPlumb.paintStyle);n.extend(i,t._jsPlumb.hoverPaintStyle);delete t._jsPlumb.hoverPaintStyle;i.gradient&&t._jsPlumb.paintStyle.fillStyle&&delete i.gradient;t._jsPlumb.hoverPaintStyle=i}},l=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],p=function(n,t,i,r){var f=n.getAttachedElements(),u,e;if(f)for(u=0,e=f.length;e>u;u++)r&&r==f[u]||f[u].setHover(t,!0,i)},f=function(n){return null==n?null:n.split(" ")},a=function(n,t,i){for(var r in t)n[r]=i},i=function(n,i,r){var f,c,e,o;if(n.getDefaultType){var l=n.getTypeDescriptor(),s={},h=n.getDefaultType(),u=t.merge({},h);for(a(s,h,"__default"),f=0,c=n._jsPlumb.types.length;c>f;f++)e=n._jsPlumb.types[f],"__default"!==e&&(o=n._jsPlumb.instance.getType(e,l),null!=o&&(u=t.merge(u,o,["cssClass"]),a(s,o,e)));i&&(u=t.populate(u,i));n.applyType(u,r,s);r||n.repaint()}},o=window.jsPlumbUIComponent=function(i){var u,f,r,e,o,s;jsPlumbUtil.EventGenerator.apply(this,arguments);var h=this,c=arguments,l=h.idPrefix,a=l+(new Date).getTime();if(this._jsPlumb={instance:i._jsPlumb,parameters:i.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:i.beforeDetach,beforeDrop:i.beforeDrop,overlayPlacements:[],hoverClass:i.hoverClass||i._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(n,t,i){this._jsPlumb.typeCache[i]=this._jsPlumb.typeCache[i]||{};this._jsPlumb.typeCache[i][n]=t},this.getCachedTypeItem=function(n,t){return this._jsPlumb.typeCache[t]?this._jsPlumb.typeCache[t][n]:null},this.getId=function(){return a},u=i.overlays||[],f={},this.defaultOverlayKeys){for(r=0;r<this.defaultOverlayKeys.length;r++)Array.prototype.push.apply(u,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[r]]||[]);for(r=0;r<u.length;r++)e=n.convertToFullOverlaySpec(u[r]),f[e[1].id]=e}if(o={overlays:f,parameters:i.parameters||{},scope:i.scope||this._jsPlumb.instance.getDefaultScope()},this.getDefaultType=function(){return o},this.appendToDefaultType=function(n){for(var t in n)o[t]=n[t]},i.events)for(r in i.events)h.bind(r,i.events[r]);this.clone=function(){var n={};return this.constructor.apply(n,c),n}.bind(this);this.isDetachAllowed=function(n){var i=!0;if(this._jsPlumb.beforeDetach)try{i=this._jsPlumb.beforeDetach(n)}catch(r){t.log("jsPlumb: beforeDetach callback failed",r)}return i};this.isDropAllowed=function(n,i,r,u,f,e,o){var s=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:n,targetId:i,scope:r,connection:u,dropEndpoint:f,source:e,target:o});if(this._jsPlumb.beforeDrop)try{s=this._jsPlumb.beforeDrop({sourceId:n,targetId:i,scope:r,connection:u,dropEndpoint:f,source:e,target:o})}catch(h){t.log("jsPlumb: beforeDrop callback failed",h)}return s};s=[];this.setListenerComponent=function(n){for(var t=0;t<s.length;t++)s[t][3]=n}},s=function(n,t){var r=n._jsPlumb.types[t],i=n._jsPlumb.instance.getType(r,n.getTypeDescriptor());null!=i&&i.cssClass&&n.canvas&&n._jsPlumb.instance.removeClass(n.canvas,i.cssClass)},n;jsPlumbUtil.extend(o,jsPlumbUtil.EventGenerator,{getParameter:function(n){return this._jsPlumb.parameters[n]},setParameter:function(n,t){this._jsPlumb.parameters[n]=t},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(n){this._jsPlumb.parameters=n},hasClass:function(t){return n.hasClass(this.canvas,t)},addClass:function(t){n.addClass(this.canvas,t)},removeClass:function(t){n.removeClass(this.canvas,t)},updateClasses:function(t,i){n.updateClasses(this.canvas,t,i)},setType:function(n,t,r){this.clearTypes();this._jsPlumb.types=f(n)||[];i(this,t,r)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(n,t){i(this,n,t)},hasType:function(n){return-1!=jsPlumbUtil.indexOf(this._jsPlumb.types,n)},addType:function(n,t,r){var e=f(n),o=!1,u,s;if(null!=e){for(u=0,s=e.length;s>u;u++)this.hasType(e[u])||(this._jsPlumb.types.push(e[u]),o=!0);o&&i(this,t,r)}},removeType:function(n,r){var e=f(n),o=!1,c=function(n){var i=t.indexOf(this._jsPlumb.types,n);return-1!=i?(s(this,i),this._jsPlumb.types.splice(i,1),!0):!1}.bind(this),u,h;if(null!=e){for(u=0,h=e.length;h>u;u++)o=c(e[u])||o;o&&i(this,null,r)}},clearTypes:function(n){for(var r=this._jsPlumb.types.length,t=0;r>t;t++)s(this,0),this._jsPlumb.types.splice(0,1);i(this,{},n)},toggleType:function(n,t,r){var e=f(n),u,h,o;if(null!=e){for(u=0,h=e.length;h>u;u++)o=jsPlumbUtil.indexOf(this._jsPlumb.types,e[u]),-1!=o?(s(this,o),this._jsPlumb.types.splice(o,1)):this._jsPlumb.types.push(e[u]);i(this,t,r)}},applyType:function(n,t){if(this.setPaintStyle(n.paintStyle,t),this.setHoverPaintStyle(n.hoverPaintStyle,t),n.parameters)for(var i in n.parameters)this.setParameter(i,n.parameters[i]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(n,t){this._jsPlumb.paintStyle=n;this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle;c(this);t||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(n,t){this._jsPlumb.hoverPaintStyle=n;c(this);t||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(n){(n||null==this.typeId)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(n,t,i){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){if(this._jsPlumb.hover=n,null!=this.canvas){if(null!=this._jsPlumb.instance.hoverClass){var u=n?"addClass":"removeClass";this._jsPlumb.instance[u](this.canvas,this._jsPlumb.instance.hoverClass)}null!=this._jsPlumb.hoverClass&&this._jsPlumb.instance[u](this.canvas,this._jsPlumb.hoverClass)}null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=n?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(i=i||r(),this.repaint({timestamp:i,recalc:!1})));this.getAttachedElements&&!t&&p(this,n,r(),this)}}});var v=0,w=function(){var n=v+1;return v++,n},h=window.jsPlumbInstance=function(i){var dt,p,b,nr,ri,ui,tr,fi,oi,rr,si,bt,kt,ht,ct,hi,ci,li;this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:4,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};i&&n.extend(this.Defaults,i);this.logEnabled=this.Defaults.LogEnabled;this._connectionTypes={};this._endpointTypes={};jsPlumbUtil.EventGenerator.apply(this);var f=this,ai=w(),ur=f.bind,vi={},lt=1,c=function(n){if(null==n)return null;if(3==n.nodeType||8==n.nodeType)return{el:n,text:!0};var t=f.getElement(n);return{el:t,id:jsPlumbUtil.isString(n)&&null==t?n:a(t)}};this.getInstanceIndex=function(){return ai};this.setZoom=function(n,t){return jsPlumbUtil.oldIE||(lt=n,f.fire("zoom",lt),t&&f.repaintEverything()),!jsPlumbUtil.oldIE};this.getZoom=function(){return lt};for(dt in this.Defaults)vi[dt]=this.Defaults[dt];b=[];this.unbindContainer=function(){if(null!=p&&b.length>0)for(var n=0;n<b.length;n++)f.off(p,b[n][0],b[n][1])};this.setContainer=function(n){this.unbindContainer();n=this.getElement(n);this.select().each(function(t){t.moveParent(n)});this.selectEndpoints().each(function(t){t.moveParent(n)});p=n;b.length=0;for(var t=function(n,t){var i=t.srcElement||t.target,r=(i&&i.parentNode?i.parentNode._jsPlumb:null)||(i?i._jsPlumb:null)||(i&&i.parentNode&&i.parentNode.parentNode?i.parentNode.parentNode._jsPlumb:null);r&&(r.fire(n,r,t),f.fire(n,r.component||r,t))},i=function(n,t,i){b.push([n,i]);f.on(p,n,t,i)},u=function(n){i(n,"._jsPlumb_connector > *",function(i){t(n,i)});i(n,"._jsPlumb_endpoint, ._jsPlumb_endpoint > *, ._jsPlumb_endpoint svg *",function(i){t(n,i)});i(n,"._jsPlumb_overlay, ._jsPlumb_overlay *",function(i){t(n,i)})},r=0;r<l.length;r++)u(l[r])};this.getContainer=function(){return p};this.bind=function(n,t){"ready"===n&&gt?t():ur.apply(f,[n,t])};f.importDefaults=function(n){for(var t in n)f.Defaults[t]=n[t];return n.Container&&f.setContainer(n.Container),f};f.restoreDefaults=function(){return f.Defaults=n.extend({},vi),f};var yi=null,gt=!1,k=[],s={},d={},v={},h={},at={},tt={},pi=!1,y=[],it=!1,rt=null,wi=this.Defaults.Scope,bi=null,fr=1,ft=function(){return""+fr++},er=function(n,t){p?p.appendChild(n):t?this.getElement(t).appendChild(n):this.appendToRoot(n)}.bind(this),et=function(t,i,u,e){var s,o,c,h,l;if(!n.headless&&!it){if(s=a(t),o=f.getDragManager().getElementsForDraggable(s),null==u&&(u=r()),c=wt({elId:s,offset:i,recalc:!1,timestamp:u}),o)for(h in o)wt({elId:o[h].id,offset:{left:c.o.left+o[h].offset.left,top:c.o.top+o[h].offset.top},recalc:!1,timestamp:u});if(f.anchorManager.redraw(s,i,u,null,e),o)for(l in o)f.anchorManager.redraw(o[l].id,i,u,o[l].offset,e,!0)}},ot=function(n){return d[n]},ki=function(i,r,u,e){var v,o,c,l;if(!n.headless&&(v=null==r?!1:r,v&&n.isDragSupported(i,f)&&!n.isAlreadyDraggable(i,f))){o=u||f.Defaults.DragOptions;o=n.extend({},o);var y=n.dragEvents.drag,p=n.dragEvents.stop,w=n.dragEvents.start,d=f.getElement(i),b=f.getDragManager().getDragAncestor(d),k={left:0,top:0},s=k,h=!1;ei(e,i);o[w]=t.wrap(o[w],function(){return s=null!=b?f.getOffset(b):k,f.setHoverSuspended(!0),f.select({source:i}).addClass(f.elementDraggingClass+" "+f.sourceElementDraggingClass,!0),f.select({target:i}).addClass(f.elementDraggingClass+" "+f.targetElementDraggingClass,!0),f.setConnectionBeingDragged(!0),o.canDrag?u.canDrag():void 0},!1);o[y]=t.wrap(o[y],function(){var n=f.getUIPosition(arguments,f.getZoom());n.left+=s.left;n.top+=s.top;et(i,n,null,!0);h&&f.addClass(i,"jsPlumb_dragged");h=!0});o[p]=t.wrap(o[p],function(){var t=[],r,n;for(t=1==arguments.length&&arguments[0].selection&&arguments[0].selection.length>0?arguments[0].selection:[[i,f.getUIPosition(arguments,f.getZoom(),!0)]],r=function(n){et(n[0],n[1]);f.removeClass(n[0],"jsPlumb_dragged");f.select({source:n[0]}).removeClass(f.elementDraggingClass+" "+f.sourceElementDraggingClass,!0);f.select({target:n[0]}).removeClass(f.elementDraggingClass+" "+f.targetElementDraggingClass,!0);f.getDragManager().dragEnded(n[0])},n=0;n<t.length;n++)r(t[n]);h=!1;f.setHoverSuspended(!1);f.setConnectionBeingDragged(!1)});c=a(i);tt[c]=!0;l=tt[c];o.disabled=null==l?!1:!l;f.initDraggable(i,o);f.getDragManager().register(i)}},or=function(n,t){for(var i,u=n.scope.split(/\s/),f=t.scope.split(/\s/),r=0;r<u.length;r++)for(i=0;i<f.length;i++)if(f[i]==u[r])return!0;return!1},sr=function(i,r){var u=n.extend({},i),e,o;if(r&&n.extend(u,r),u.source&&(u.source.endpoint?u.sourceEndpoint=u.source:u.source=f.getElement(u.source)),u.target&&(u.target.endpoint?u.targetEndpoint=u.target:u.target=f.getElement(u.target)),i.uuids&&(u.sourceEndpoint=ot(i.uuids[0]),u.targetEndpoint=ot(i.uuids[1])),u.sourceEndpoint&&u.sourceEndpoint.isFull())return t.log(f,"could not add connection; source endpoint is full"),void 0;if(u.targetEndpoint&&u.targetEndpoint.isFull())return t.log(f,"could not add connection; target endpoint is full"),void 0;if(!u.type&&u.sourceEndpoint&&(u.type=u.sourceEndpoint.connectionType),u.sourceEndpoint&&u.sourceEndpoint.connectorOverlays)for(u.overlays=u.overlays||[],e=0,o=u.sourceEndpoint.connectorOverlays.length;o>e;e++)u.overlays.push(u.sourceEndpoint.connectorOverlays[e]);!u["pointer-events"]&&u.sourceEndpoint&&u.sourceEndpoint.connectorPointerEvents&&(u["pointer-events"]=u.sourceEndpoint.connectorPointerEvents);var h=function(t,i){var u=n.extend({},t);for(var r in i)i[r]&&(u[r]=i[r]);return u},c=function(n,t,i){return f.addEndpoint(n,h(t,{anchor:u.anchors?u.anchors[i]:u.anchor,endpoint:u.endpoints?u.endpoints[i]:u.endpoint,paintStyle:u.endpointStyles?u.endpointStyles[i]:u.endpointStyle,hoverPaintStyle:u.endpointHoverStyles?u.endpointHoverStyles[i]:u.endpointHoverStyle}))},s=function(n,t,i){var e,r,f;if(u[n]&&!u[n].endpoint&&!u[n+"Endpoint"]&&!u.newConnection&&(e=a(u[n]),r=i[e],r)){if(!r.enabled||(f=null!=r.endpoint&&r.endpoint._jsPlumb?r.endpoint:c(u[n],r.def,t),f.isFull()))return!1;u[n+"Endpoint"]=f;f._doNotDeleteOnDetach=!1;f._deleteOnDetach=!0;r.uniqueEndpoint&&(r.endpoint?f.finalEndpoint=r.endpoint:(r.endpoint=f,f._deleteOnDetach=!1,f._doNotDeleteOnDetach=!0))}};if(s("source",0,this.sourceEndpointDefinitions)!==!1&&s("target",1,this.targetEndpointDefinitions)!==!1)return(u.sourceEndpoint&&u.targetEndpoint&&(or(u.sourceEndpoint,u.targetEndpoint)||(u=null)),u)}.bind(f),ni=function(n){var i=f.Defaults.ConnectionType||f.getDefaultConnectionType(),t;return n._jsPlumb=f,n.newConnection=ni,n.newEndpoint=ti,n.endpointsByUUID=d,n.endpointsByElement=s,n.finaliseConnection=di,n.id="con_"+ft(),t=new i(n),t.isDetachable()&&(t.endpoints[0].initDraggable("_jsPlumbSource"),t.endpoints[1].initDraggable("_jsPlumbTarget")),t},di=f.finaliseConnection=function(n,t,i,r){if(t=t||{},n.suspendedEndpoint||k.push(n),n.endpoints[0].isTemporarySource=!1,(null==n.suspendedEndpoint||r)&&f.anchorManager.newConnection(n),et(n.source),!t.doNotFireConnectionEvent&&t.fireEvent!==!1){var u={connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]};f.fire("connection",u,i)}},ti=function(t,i){var e=f.Defaults.EndpointType||n.Endpoint,r=n.extend({},t),u;return r._jsPlumb=f,r.newConnection=ni,r.newEndpoint=ti,r.endpointsByUUID=d,r.endpointsByElement=s,r.fireDetachEvent=ui,r.elementId=i||a(r.source),u=new e(r),u.id="ep_"+ft(),ei(r.elementId,r.source),n.headless||f.getDragManager().endpointAdded(r.source,i),u},ii=function(n,t,i){var r=s[n],u,e,f,o,h;if(r&&r.length)for(u=0,e=r.length;e>u;u++){for(f=0,o=r[u].connections.length;o>f;f++)if(h=t(r[u].connections[f]),h)return;i&&i(r[u])}},hr=function(t,i){return n.each(t,function(n){f.isDragSupported(n)&&(tt[f.getAttribute(n,"id")]=i,f.setElementDraggable(n,i))})},gi=function(n,t,i){var r,u;t="block"===t;r=null;i&&(r=t?function(n){n.setVisible(!0,!0,!0)}:function(n){n.setVisible(!1,!0,!0)});u=c(n);ii(u.id,function(n){if(t&&i){var r=n.sourceId===u.id?1:0;n.endpoints[r].isVisible()&&n.setVisible(!0)}else n.setVisible(t)},r)},cr=function(t){return n.each(t,function(n){var i=f.getAttribute(n,"id"),t=null==tt[i]?!1:tt[i];return t=!t,tt[i]=t,f.setDraggable(n,t),t}.bind(this))},lr=function(n,t){var i=null;t&&(i=function(n){var t=n.isVisible();n.setVisible(!t)});ii(n,function(n){var t=n.isVisible();n.setVisible(!t)},i)},ar=function(n){var t=h[n];return t?{o:t,s:y[n]}:wt({elId:n})},a=function(n,t,i){if(jsPlumbUtil.isString(n))return n;if(null==n)return null;var r=f.getAttribute(n,"id");return r&&"undefined"!==r||(2==arguments.length&&void 0!==arguments[1]?r=t:(1==arguments.length||3==arguments.length&&!arguments[2])&&(r="jsPlumb_"+ai+"_"+ft()),i||f.setAttribute(n,"id",r)),r};this.setConnectionBeingDragged=function(n){pi=n};this.isConnectionBeingDragged=function(){return pi};this.connectorClass="_jsPlumb_connector";this.connectorOutlineClass="_jsPlumb_connector_outline";this.connectedClass="_jsPlumb_connected";this.hoverClass="_jsPlumb_hover";this.endpointClass="_jsPlumb_endpoint";this.endpointConnectedClass="_jsPlumb_endpoint_connected";this.endpointFullClass="_jsPlumb_endpoint_full";this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed";this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden";this.overlayClass="_jsPlumb_overlay";this.draggingClass="_jsPlumb_dragging";this.elementDraggingClass="_jsPlumb_element_dragging";this.sourceElementDraggingClass="_jsPlumb_source_element_dragging";this.targetElementDraggingClass="_jsPlumb_target_element_dragging";this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor";this.hoverSourceClass="_jsPlumb_source_hover";this.hoverTargetClass="_jsPlumb_target_hover";this.dragSelectClass="_jsPlumb_drag_select";this.Anchors={};this.Connectors={svg:{},vml:{}};this.Endpoints={svg:{},vml:{}};this.Overlays={svg:{},vml:{}};this.ConnectorRenderers={};this.SVG="svg";this.VML="vml";this.addEndpoint=function(i,r,u){var e;u=u||{};e=n.extend({},u);n.extend(e,r);e.endpoint=e.endpoint||f.Defaults.Endpoint;e.paintStyle=e.paintStyle||f.Defaults.EndpointStyle;for(var h=[],v=t.isArray(i)||null!=i.length&&!t.isString(i)?i:[i],l=0,w=v.length;w>l;l++){e.source=f.getElement(v[l]);pt(e.source);var c=a(e.source),o=ti(e,c),p=ei(c,e.source).info.o;t.addToList(s,c,o);it||o.paint({anchorLoc:o.anchor.compute({xy:[p.left,p.top],wh:y[c],element:o,timestamp:rt}),timestamp:rt});h.push(o);o._doNotDeleteOnDetach=!0}return 1==h.length?h[0]:h};this.addEndpoints=function(n,i,r){for(var u,e=[],o=0,s=i.length;s>o;o++)u=f.addEndpoint(n,i[o],r),t.isArray(u)?Array.prototype.push.apply(e,u):e.push(u);return e};this.animate=function(i,r,u){if(!this.animationSupported)return!1;u=u||{};var e=f.getElement(i),o=a(e),s=n.animEvents.step,h=n.animEvents.complete;u[s]=t.wrap(u[s],function(){f.revalidate(o)});u[h]=t.wrap(u[h],function(){f.revalidate(o)});f.doAnimate(e,r,u)};this.checkCondition=function(n){var i=f.getListener(n),u=!0,e,r,o;if(i&&i.length>0){e=Array.prototype.slice.call(arguments,1);try{for(r=0,o=i.length;o>r;r++)u=u&&i[r].apply(i[r],e)}catch(s){t.log(f,"cannot check condition ["+n+"]"+s)}}return u};this.connect=function(n,t){var r,i=sr(n,t);if(i){if(null==i.source&&null==i.sourceEndpoint)return jsPlumbUtil.log("Cannot establish connection - source does not exist"),void 0;if(null==i.target&&null==i.targetEndpoint)return jsPlumbUtil.log("Cannot establish connection - target does not exist"),void 0;pt(i.source);r=ni(i);di(r,i)}return r};nr=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}];ri=function(t,i,r,u){var f,s,e,o=nr[r],c=t[o.elId],l=(t[o.el],t.endpoints[r]),h={index:r,originalSourceId:0===r?c:t.sourceId,newSourceId:t.sourceId,originalTargetId:1==r?c:t.targetId,newTargetId:t.targetId,connection:t};if(i.constructor==n.Endpoint)f=i,f.addConnection(t);else if(s=a(i),e=this[o.epDefs][s],s===t[o.elId])f=null;else if(e){if(!e.enabled)return;f=null!=e.endpoint&&e.endpoint._jsPlumb?e.endpoint:this.addEndpoint(i,e.def);e.uniqueEndpoint&&(e.endpoint=f);f._doNotDeleteOnDetach=!1;f._deleteOnDetach=!0;f.addConnection(t)}else f=t.makeEndpoint(0===r,i,s),f._doNotDeleteOnDetach=!1,f._deleteOnDetach=!0;return null!=f&&(l.detachFromConnection(t),t.endpoints[r]=f,t[o.el]=f.element,t[o.elId]=f.elementId,h[0===r?"newSourceId":"newTargetId"]=f.elementId,tr(h),u||t.repaint()),h}.bind(this);this.setSource=function(n,t,i){var r=ri(n,t,0,i);this.anchorManager.sourceChanged(r.originalSourceId,r.newSourceId,n)};this.setTarget=function(n,t,i){var r=ri(n,t,1,i);this.anchorManager.updateOtherEndpoint(r.originalSourceId,r.originalTargetId,r.newTargetId,n)};this.deleteEndpoint=function(n,t){var i="string"==typeof n?d[n]:n;return i&&f.deleteObject({endpoint:i,dontUpdateHover:t}),f};this.deleteEveryEndpoint=function(){var u=f.setSuspendDrawing(!0),i,n,t,r;for(i in s)if(n=s[i],n&&n.length)for(t=0,r=n.length;r>t;t++)f.deleteEndpoint(n[t],!0);return s={},v={},d={},h={},at={},f.anchorManager.reset(),f.getDragManager().reset(),u||f.setSuspendDrawing(!1),f};ui=function(n,t,i){var u=f.Defaults.ConnectionType||f.getDefaultConnectionType(),e=n.constructor==u,r=e?{connection:n,source:n.source,target:n.target,sourceId:n.sourceId,targetId:n.targetId,sourceEndpoint:n.endpoints[0],targetEndpoint:n.endpoints[1]}:n;t&&f.fire("connectionDetached",r,i);f.anchorManager.connectionDetached(r)};tr=f.fireMoveEvent=function(n,t){f.fire("connectionMoved",n,t)};this.unregisterEndpoint=function(n){var t,i;n._jsPlumb.uuid&&(d[n._jsPlumb.uuid]=null);f.anchorManager.deleteEndpoint(n);for(t in s){if(i=s[t],i){for(var u=[],r=0,e=i.length;e>r;r++)i[r]!=n&&u.push(i[r]);s[t]=u}s[t].length<1&&delete s[t]}};this.detach=function(){var i,u,o;if(0!==arguments.length){var h=f.Defaults.ConnectionType||f.getDefaultConnectionType(),s=arguments[0].constructor==h,r=2==arguments.length?s?arguments[1]||{}:arguments[0]:arguments[0],e=r.fireEvent!==!1,c=r.forceDetach,t=s?arguments[0]:r.connection;t?(c||jsPlumbUtil.functionChain(!0,!1,[[t.endpoints[0],"isDetachAllowed",[t]],[t.endpoints[1],"isDetachAllowed",[t]],[t,"isDetachAllowed",[t]],[f,"checkCondition",["beforeDetach",t]]]))&&t.endpoints[0].detach(t,!1,!0,e):(i=n.extend({},r),i.uuids?ot(i.uuids[0]).detachFrom(ot(i.uuids[1]),e):i.sourceEndpoint&&i.targetEndpoint?i.sourceEndpoint.detachFrom(i.targetEndpoint):(u=a(f.getElement(i.source)),o=a(f.getElement(i.target)),ii(u,function(n){(n.sourceId==u&&n.targetId==o||n.targetId==u&&n.sourceId==o)&&f.checkCondition("beforeDetach",n)&&n.endpoints[0].detach(n,!1,!0,e)})))}};this.detachAllConnections=function(n,t){var u,i,r,e;if(t=t||{},n=f.getElement(n),u=a(n),i=s[u],i&&i.length)for(r=0,e=i.length;e>r;r++)i[r].detachAll(t.fireEvent!==!1,t.forceDetach);return f};this.detachEveryConnection=function(n){return n=n||{},f.batch(function(){var r,t,i,u;for(r in s)if(t=s[r],t&&t.length)for(i=0,u=t.length;u>i;i++)t[i].detachAll(n.fireEvent!==!1,n.forceDetach);k.length=0}),f};this.deleteObject=function(n){var t={endpoints:{},connections:{},endpointCount:0,connectionCount:0},c=n.fireEvent!==!1,u=n.deleteAttachedObjects!==!1,e=function(i){if(null!=i&&null==t.connections[i.id]&&(n.dontUpdateHover||null==i._jsPlumb||i.setHover(!1),t.connections[i.id]=i,t.connectionCount++,u))for(var r=0;r<i.endpoints.length;r++)i.endpoints[r]._deleteOnDetach&&o(i.endpoints[r])},o=function(i){var r,f;if(null!=i&&null==t.endpoints[i.id]&&(n.dontUpdateHover||null==i._jsPlumb||i.setHover(!1),t.endpoints[i.id]=i,t.endpointCount++,u))for(r=0;r<i.connections.length;r++)f=i.connections[r],e(f)},s,i,h,r;n.connection?e(n.connection):o(n.endpoint);for(s in t.connections)i=t.connections[s],i._jsPlumb&&(jsPlumbUtil.removeWithFunction(k,function(n){return i.id==n.id}),ui(i,c,n.originalEvent),i.endpoints[0].detachFromConnection(i),i.endpoints[1].detachFromConnection(i),i.cleanup(!0),i.destroy(!0));for(h in t.endpoints)r=t.endpoints[h],r._jsPlumb&&(f.unregisterEndpoint(r),r.cleanup(!0),r.destroy(!0));return t};this.draggable=function(n,t){var r,u,i;if("object"==typeof n&&n.length)for(r=0,u=n.length;u>r;r++)i=c(n[r]),i.el&&ki(i.el,!0,t,i.id);else i=c(n),i.el&&ki(i.el,!0,t,i.id);return f};var vr=function(n,t,i,r){for(var u=0,f=n.length;f>u;u++)n[u][t].apply(n[u],i);return r(n)},yr=function(n,t,i){for(var u=[],r=0,f=n.length;f>r;r++)u.push([n[r][t].apply(n[r],i),n[r]]);return u},ut=function(n,t,i){return function(){return vr(n,t,arguments,i)}},vt=function(n,t){return function(){return yr(n,t,arguments)}},g=function(n,t){var i=[],r,u;if(n)if("string"==typeof n){if("*"===n)return n;i.push(n)}else if(t)i=n;else if(n.length)for(r=0,u=n.length;u>r;r++)i.push(c(n[r]).id);else i.push(c(n).id);return i},nt=function(n,t,i){return"*"===n?!0:n.length>0?-1!=jsPlumbUtil.indexOf(n,t):!i};this.getConnections=function(n,t){var i;n?n.constructor==String&&(n={scope:n}):n={};for(var o=n.scope||f.getDefaultScope(),u=g(o,!0),s=g(n.source),h=g(n.target),r=!t&&u.length>1?{}:[],c=function(n,i){if(!t&&u.length>1){var f=r[n];null==f&&(f=r[n]=[]);f.push(i)}else r.push(i)},e=0,l=k.length;l>e;e++)i=k[e],nt(u,i.scope)&&nt(s,i.sourceId)&&nt(h,i.targetId)&&c(i.scope,i);return r};var pr=function(n,t){return function(i){for(var r=0,u=n.length;u>r;r++)i(n[r]);return t(n)}},wr=function(n){return function(t){return n[t]}},ir=function(n,t){for(var u={length:n.length,each:pr(n,t),get:wr(n)},f=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],e=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],i=0,r=f.length;r>i;i++)u[f[i]]=ut(n,f[i],t);for(i=0,r=e.length;r>i;i++)u[e[i]]=vt(n,e[i]);return u},st=function(t){var i=ir(t,st);return n.extend(i,{setDetachable:ut(t,"setDetachable",st),setReattach:ut(t,"setReattach",st),setConnector:ut(t,"setConnector",st),detach:function(){for(var n=0,i=t.length;i>n;n++)f.detach(t[n])},isDetachable:vt(t,"isDetachable"),isReattach:vt(t,"isReattach")})},yt=function(t){var i=ir(t,yt);return n.extend(i,{setEnabled:ut(t,"setEnabled",yt),setAnchor:ut(t,"setAnchor",yt),isEnabled:vt(t,"isEnabled"),detachAll:function(){for(var n=0,i=t.length;i>n;n++)t[n].detachAll()},remove:function(){for(var n=0,i=t.length;i>n;n++)f.deleteObject({endpoint:t[n]})}})};this.select=function(n){return n=n||{},n.scope=n.scope||"*",st(n.connections||f.getConnections(n,!0))};this.selectEndpoints=function(n){var t,r,h,i,c,l;n=n||{};n.scope=n.scope||"*";var u=!n.element&&!n.source&&!n.target,a=u?"*":g(n.element),f=u?"*":g(n.source),e=u?"*":g(n.target),v=g(n.scope,!0),o=[];for(t in s){var y=nt(a,t,!0),p=nt(f,t,!0),w="*"!=f,b=nt(e,t,!0),k="*"!=e;if(y||p||b)n:for(r=0,h=s[t].length;h>r;r++)if(i=s[t][r],nt(v,i.scope,!0)){if(c=w&&f.length>0&&!i.isSource,l=k&&e.length>0&&!i.isTarget,c||l)continue n;o.push(i)}}return yt(o)};this.getAllConnections=function(){return k};this.getDefaultScope=function(){return wi};this.getEndpoint=ot;this.getEndpoints=function(n){return s[c(n).id]};this.getDefaultEndpointType=function(){return n.Endpoint};this.getDefaultConnectionType=function(){return n.Connection};this.getId=a;this.appendElement=er;fi=!1;this.isHoverSuspended=function(){return fi};this.setHoverSuspended=function(n){fi=n};this.hide=function(n,t){return gi(n,"none",t),f};this.idstamp=ft;this.connectorsInitialized=!1;this.registerConnectorType=function(n,t){u.push([n,t])};var pt=function(n){if(!p&&n){var t=f.getElement(n);t.offsetParent&&f.setContainer(t.offsetParent)}},br=function(){f.Defaults.Container&&f.setContainer(f.Defaults.Container)},ei=f.manage=function(n,t){return v[n]||(v[n]={el:t,endpoints:[],connections:[]},v[n].info=wt({elId:n,timestamp:rt})),v[n]},wt=this.updateOffset=function(n){var i,r=n.timestamp,u=n.recalc,e=n.offset,t=n.elId;return it&&!r&&(r=rt),!u&&r&&r===at[t]?{o:n.offset||h[t],s:y[t]}:(u||!e&&null==h[t]?(i=v[t]?v[t].el:null,null!=i&&(y[t]=f.getSize(i),h[t]=f.getOffset(i),at[t]=r)):(h[t]=e||h[t],null==y[t]&&(i=v[t].el,null!=i&&(y[t]=f.getSize(i))),at[t]=r),h[t]&&!h[t].right&&(h[t].right=h[t].left+y[t][0],h[t].bottom=h[t].top+y[t][1],h[t].width=y[t][0],h[t].height=y[t][1],h[t].centerx=h[t].left+h[t].width/2,h[t].centery=h[t].top+h[t].height/2),{o:h[t],s:y[t]})};this.init=function(){var r,t,i;if(e=n.getRenderModes(),r=function(t,i,r){n.Connectors[t][i]=function(){r.apply(this,arguments);n.ConnectorRenderers[t].apply(this,arguments)};jsPlumbUtil.extend(n.Connectors[t][i],[r,n.ConnectorRenderers[t]])},!n.connectorsInitialized){for(t=0;t<u.length;t++)for(i=0;i<e.length;i++)r(e[i],u[t][1],u[t][0]);n.connectorsInitialized=!0}gt||(br(),f.anchorManager=new n.AnchorManager({jsPlumbInstance:f}),f.setRenderMode(f.Defaults.RenderMode),gt=!0,f.fire("ready",f))}.bind(this);this.log=yi;this.jsPlumbUIComponent=o;this.makeAnchor=function(){var e,s=function(t,i){if(n.Anchors[t])return new n.Anchors[t](i);if(!f.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+t+"'"};},o;if(0===arguments.length)return null;var i=arguments[0],u=arguments[1],r=(arguments[2],null);return i.compute&&i.getOrientation?i:("string"==typeof i?r=s(arguments[0],{elementId:u,jsPlumbInstance:f}):t.isArray(i)&&(t.isArray(i[0])||t.isString(i[0])?2==i.length&&t.isObject(i[1])?t.isString(i[0])?(e=n.extend({elementId:u,jsPlumbInstance:f},i[1]),r=s(i[0],e)):(e=n.extend({elementId:u,jsPlumbInstance:f,anchors:i[0]},i[1]),r=new n.DynamicAnchor(e)):r=new n.DynamicAnchor({anchors:i,selector:null,elementId:u,jsPlumbInstance:f}):(o={x:i[0],y:i[1],orientation:i.length>=4?[i[2],i[3]]:[0,0],offsets:i.length>=6?[i[4],i[5]]:[0,0],elementId:u,jsPlumbInstance:f,cssClass:7==i.length?i[6]:null},r=new n.Anchor(o),r.clone=function(){return new n.Anchor(o)})),r.id||(r.id="anchor_"+ft()),r)};this.makeAnchors=function(i,r,u){for(var o=[],e=0,s=i.length;s>e;e++)"string"==typeof i[e]?o.push(n.Anchors[i[e]]({elementId:r,jsPlumbInstance:u})):t.isArray(i[e])&&o.push(f.makeAnchor(i[e],r,u));return o};this.makeDynamicAnchor=function(t,i){return new n.DynamicAnchor({anchors:t,selector:i,elementId:null,jsPlumbInstance:f})};this.targetEndpointDefinitions={};oi=function(n,t,i){n.paintStyle=n.paintStyle||i.Defaults.EndpointStyles[t]||i.Defaults.EndpointStyle;n.hoverPaintStyle=n.hoverPaintStyle||i.Defaults.EndpointHoverStyles[t]||i.Defaults.EndpointHoverStyle;n.anchor=n.anchor||i.Defaults.Anchors[t]||i.Defaults.Anchor;n.endpoint=n.endpoint||i.Defaults.Endpoints[t]||i.Defaults.Endpoint};this.sourceEndpointDefinitions={};rr=function(n,t,i,r,u){for(var s=n.target||n.srcElement,f=!1,o=r.getSelector(t,i),e=0;e<o.length;e++)if(o[e]==s){f=!0;break}return u?!f:f};si=function(i,r,u,e,s,h){var c=new o(r),l=r._jsPlumb.EndpointDropHandler({jsPlumb:f,enabled:function(){return i.el[h].enabled},isFull:function(){var t=f.select({target:i.id}).length,n=i.el[h];return n.maxConnections>0&&t>=n.maxConnections},element:i.el,elementId:i.id,isSource:e,isTarget:s,addClass:function(n){f.addClass(i.el,n)},removeClass:function(n){f.removeClass(i.el,n)},onDrop:function(n){var t=n.endpoints[0];t.anchor.locked=!1},isDropAllowed:function(){return c.isDropAllowed.apply(c,arguments)},isRedrop:function(n){return null!=n.suspendedElement&&null!=n.suspendedEndpoint&&n.suspendedEndpoint.element===i.el},getEndpoint:function(n){var u=i.el[h],t=u.endpoint;if((null==t||null==t._jsPlumb)&&(t=f.addEndpoint(i.el,r),t._mtNew=!0),r.uniqueEndpoint&&(u.endpoint=t),t._doNotDeleteOnDetach=!1,t._deleteOnDetach=!0,n.isDetachable()&&t.initDraggable(),null!=t.anchor.positionFinder){var o=f.getUIPosition(arguments,f.getZoom()),s=f.getOffset(i.el),c=f.getSize(i.el),e=t.anchor.positionFinder(o,s,c,t.anchor.constructorParams);t.anchor.x=e[0];t.anchor.y=e[1]}return t},maybeCleanup:function(n){n._mtNew&&0===n.connections.length?f.deleteObject({endpoint:n}):delete n._mtNew}}),a=n.dragEvents.drop;return u.scope=u.scope||r.scope||f.Defaults.Scope,u[a]=t.wrap(u[a],l,!0),s&&(u[n.dragEvents.over]=function(){return!0}),u.definitionId=h,r.allowLoopback===!1&&(u.canDrop=function(n){var t=n.getDragElement()._jsPlumbRelatedElement;return t!=i.el}),f.initDroppable(i.el,u,"internal"),l};this.makeTarget=function(t,i,r){var u=n.extend({_jsPlumb:this},r);n.extend(u,i);oi(u,1,this);for(var o=(!(u.deleteEndpointsOnDetach===!1),u.maxConnections||-1),s=function(t){var i=c(t),f=i.id,e=n.extend({},u.dropOptions||{}),r;pt(f);r={def:u,uniqueEndpoint:u.uniqueEndpoint,maxConnections:o,enabled:!0};i.el._jsPlumbTarget=r;this.targetEndpointDefinitions[f]=r;si(i,u,e,u.isSource===!0,!0,"_jsPlumbTarget")}.bind(this),e=t.length&&t.constructor!=String?t:[t],f=0,h=e.length;h>f;f++)s(e[f]);return this};this.unmakeTarget=function(t,i){var r=c(t);return n.destroyDroppable(r.el),i||delete this.targetEndpointDefinitions[r.id],this};this.makeSource=function(i,r,u){var e=n.extend({_jsPlumb:this},u);n.extend(e,r);oi(e,0,this);for(var s=e.maxConnections||1,h=e.onMaxConnections,a=function(i){var o=i.id,k=this.getElement(i.el),c,a,b;pt(o);c={def:e,uniqueEndpoint:e.uniqueEndpoint,maxConnections:s,enabled:!0};this.sourceEndpointDefinitions[o]=c;i.el._jsPlumbSource=c;var v=n.dragEvents.stop,y=n.dragEvents.drag,u=n.extend({},e.dragOptions||{}),p=u.drag,w=u.stop,r=null,l=!1;u.scope=u.scope||e.scope;u[y]=t.wrap(u[y],function(){p&&p.apply(this,arguments);l=!1});u[v]=t.wrap(u[v],function(){if(w&&w.apply(this,arguments),this.currentlyDragging=!1,null!=r._jsPlumb){var l=e.anchor||this.Defaults.Anchor,u=r.anchor,s=r.connections[0],n=this.makeAnchor(l,o,this),h=r.element;if(null!=n.positionFinder){var t=f.getOffset(h),i=this.getSize(h),a={left:t.left+u.x*i[0],top:t.top+u.y*i[1]},c=n.positionFinder(a,t,i,n.constructorParams);n.x=c[0];n.y=c[1]}r.setAnchor(n,!0);r.repaint();this.repaint(r.elementId);null!=s&&this.repaint(s.targetId)}}.bind(this));a=function(t){var y=this.getOriginalEvent(t),c,w,b,p,a,v;if(3!==t.which&&2!==t.button&&(c=this.sourceEndpointDefinitions[o],c.enabled)){if((o=this.getId(this.getElement(i.el)),e.filter)&&(w=jsPlumbUtil.isString(e.filter)?rr(y,i.el,e.filter,this,e.filterExclude):e.filter(y,i.el),w===!1))return;if(b=this.select({source:o}).length,c.maxConnections>=0&&c.uniqueEndpoint&&b>=c.maxConnections)return h&&h({element:i.el,maxConnections:s},t),!1;p=n.getPositionOnElement(y,k,lt);a={};n.extend(a,e);a.isTemporarySource=!0;a.anchor=[p[0],p[1],0,0];a.dragOptions=u;r=this.addEndpoint(o,a);l=!0;r._doNotDeleteOnDetach=!1;r._deleteOnDetach=!0;c.uniqueEndpoint&&(c.endpoint?r.finalEndpoint=c.endpoint:(c.endpoint=r,r._deleteOnDetach=!1,r._doNotDeleteOnDetach=!0));v=function(){f.off(r.canvas,"mouseup",v);f.off(i.el,"mouseup",v);l&&(l=!1,f.deleteEndpoint(r))};f.on(r.canvas,"mouseup",v);f.on(i.el,"mouseup",v);f.trigger(r.canvas,"mousedown",t);jsPlumbUtil.consume(t)}}.bind(this);this.on(i.el,"mousedown",a);c.trigger=a;e.filter&&(jsPlumbUtil.isString(e.filter)||jsPlumbUtil.isFunction(e.filter))&&f.setDragFilter(i.el,e.filter);b=n.extend({},e.dropOptions||{});si(i,e,b,!0,e.isTarget===!0,"_jsPlumbSource")}.bind(this),l=i.length&&i.constructor!=String?i:[i],o=0,v=l.length;v>o;o++)a(c(l[o]));return this};this.unmakeSource=function(n,t){var i=c(n),r=this.sourceEndpointDefinitions[i.id].trigger;return r&&f.off(i.el,"mousedown",r),t||delete this.sourceEndpointDefinitions[i.id],this};this.unmakeEverySource=function(){for(var n in this.sourceEndpointDefinitions)f.unmakeSource(n,!0);return this.sourceEndpointDefinitions={},this};bt=function(n,t){var u,i,r;for(t=jsPlumbUtil.isArray(t)?t:[t],u=a(n),i=0;i<t.length;i++)if(r=this[t[i]][u],r)return r.def.scope||this.Defaults.Scope}.bind(this);kt=function(n,t,i){var u,r,f;for(i=jsPlumbUtil.isArray(i)?i:[i],u=a(n),r=0;r<i.length;r++)f=this[i[r]][u],f&&(f.def.scope=t,null!=this.scopeChange&&this.scopeChange(n,u,s[u],t,i[r]))}.bind(this);this.getScope=function(n){return bt(n,["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.getSourceScope=function(n){return bt(n,"sourceEndpointDefinitions")};this.getTargetScope=function(n){return bt(n,"targetEndpointDefinitions")};this.setScope=function(n,t){kt(n,t,["sourceEndpointDefinitions","targetEndpointDefinitions"])};this.setSourceScope=function(n,t){kt(n,t,"sourceEndpointDefinitions")};this.setTargetScope=function(n,t){kt(n,t,"targetEndpointDefinitions")};this.unmakeEveryTarget=function(){for(var n in this.targetEndpointDefinitions)f.unmakeTarget(n,!0);return this.targetEndpointDefinitions={},this};ht=function(n,i,r,u){var f="source"==n?this.sourceEndpointDefinitions:this.targetEndpointDefinitions,e,h,o,s;if(t.isString(i))f[i].enabled=u?!f[i].enabled:r;else if(i.length)for(e=0,h=i.length;h>e;e++)o=c(i[e]),f[o.id]&&(f[o.id].enabled=u?!f[o.id].enabled:r);else s=c(i).id,f[s].enabled=u?!f[s].enabled:r;return this}.bind(this);ct=function(n,i){return t.isString(n)||!n.length?i.apply(this,[n]):n.length?i.apply(this,[n[0]]):void 0}.bind(this);this.toggleSourceEnabled=function(n){return ht("source",n,null,!0),this.isSourceEnabled(n)};this.setSourceEnabled=function(n,t){return ht("source",n,t)};this.isSource=function(n){return ct(n,function(n){return null!=this.sourceEndpointDefinitions[c(n).id]}.bind(this))};this.isSourceEnabled=function(n){return ct(n,function(n){var t=this.sourceEndpointDefinitions[c(n).id];return t&&t.enabled===!0}.bind(this))};this.toggleTargetEnabled=function(n){return ht("target",n,null,!0),this.isTargetEnabled(n)};this.isTarget=function(n){return ct(n,function(n){return null!=this.targetEndpointDefinitions[c(n).id]}.bind(this))};this.isTargetEnabled=function(n){return ct(n,function(n){var t=this.targetEndpointDefinitions[c(n).id];return t&&t.enabled===!0}.bind(this))};this.setTargetEnabled=function(n,t){return ht("target",n,t)};this.ready=function(n){f.bind("ready",n)};hi=function(n,t){if("object"==typeof n&&n.length)for(var i=0,r=n.length;r>i;i++)t(n[i]);else t(n);return f};this.repaint=function(n,t,i){return hi(n,function(n){et(n,t,i)})};this.revalidate=function(n,t,i){return hi(n,function(n){var r=i?n:f.getId(n);f.updateOffset({elId:r,recalc:!0,timestamp:t});f.repaint(n)})};this.repaintEverything=function(){var n,t=r();for(n in s)f.updateOffset({elId:n,recalc:!0,timestamp:t});for(n in s)et(n,null,t);return this};this.removeAllEndpoints=function(n,t,i){i=i||[];var r=function(n){var u,o,e=c(n),h=s[e.id];if(h)for(i.push(e),u=0,o=h.length;o>u;u++)f.deleteEndpoint(h[u]);if(delete s[e.id],t&&e.el&&3!=e.el.nodeType&&8!=e.el.nodeType)for(u=0,o=e.el.childNodes.length;o>u;u++)r(e.el.childNodes[u])};return r(n),this};ci=function(n,t){f.removeAllEndpoints(n.id,!0,t);for(var r=function(n){f.getDragManager().elementRemoved(n.id);f.anchorManager.clearFor(n.id);f.anchorManager.removeFloatingConnection(n.id);delete f.floatingConnections[n.id];delete v[n.id];delete h[n.id];n.el&&(f.removeElement(n.el),n.el._jsPlumb=null)},i=1;i<t.length;i++)r(t[i]);r(n)};this.remove=function(n,t){var i=c(n),r=[];return i.text?i.el.parentNode.removeChild(i.el):i.id&&f.batch(function(){ci(i,r)},t===!1),f};this.empty=function(n,t){var r=[],i=function(n,t){var u=c(n);if(u.text)u.el.parentNode.removeChild(u.el);else if(u.el){for(;u.el.childNodes.length>0;)i(u.el.childNodes[0]);t||ci(u,r)}};return f.batch(function(){i(n,!0)},t===!1),f};this.reset=function(){f.silently(function(){f.deleteEveryEndpoint();f.unbind();this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};k.length=0;this.doReset&&this.doReset()}.bind(this))};li=function(n){n.canvas&&n.canvas.parentNode&&n.canvas.parentNode.removeChild(n.canvas);n.cleanup();n.destroy()};this.clear=function(){f.select().each(li);f.selectEndpoints().each(li);s={};d={}};this.setDefaultScope=function(n){return wi=n,f};this.setDraggable=hr;this.setId=function(n,t,i){var r,e,o,u,h,f;for(jsPlumbUtil.isString(n)?r=n:(n=this.getElement(n),r=this.getId(n)),e=this.getConnections({source:r,scope:"*"},!0),o=this.getConnections({target:r,scope:"*"},!0),t=""+t,i?n=this.getElement(t):(n=this.getElement(r),this.setAttribute(n,"id",t)),s[t]=s[r]||[],u=0,h=s[t].length;h>u;u++)s[t][u].setElementId(t),s[t][u].setReferenceElement(n);delete s[r];this.anchorManager.changeId(r,t);this.getDragManager().changeId(r,t);v[t]=v[r];delete v[r];f=function(i,r,u){for(var f=0,e=i.length;e>f;f++)i[f].endpoints[r].setElementId(t),i[f].endpoints[r].setReferenceElement(n),i[f][u+"Id"]=t,i[f][u]=n};f(e,0,"source");f(o,1,"target");this.repaint(t)};this.setDebugLog=function(n){yi=n};this.setSuspendDrawing=function(n,t){var i=it;return it=n,rt=n?(new Date).getTime():null,t&&this.repaintEverything(),i};this.isSuspendDrawing=function(){return it};this.getSuspendedAt=function(){return rt};this.batch=function(n,i){var r=this.isSuspendDrawing();r||this.setSuspendDrawing(!0);try{n()}catch(u){t.log("Function run while suspended failed",u)}r||this.setSuspendDrawing(!1,!i)};this.doWhileSuspended=this.batch;this.getCachedData=ar;this.timestamp=r;this.setRenderMode=function(t){if(t!==n.SVG&&t!==n.VML)throw new TypeError("Render mode ["+t+"] not supported");return bi=this.trySetRenderMode(t)};this.getRenderMode=function(){return bi};this.show=function(n,t){return gi(n,"block",t),f};this.toggleVisible=lr;this.toggleDraggable=cr;this.addListener=this.bind};jsPlumbUtil.extend(h,jsPlumbUtil.EventGenerator,{setAttribute:function(n,t,i){this.setAttribute(n,t,i)},getAttribute:function(t,i){return this.getAttribute(n.getElement(t),i)},convertToFullOverlaySpec:function(n){return jsPlumbUtil.isString(n)&&(n=[n,{}]),n[1].id=n[1].id||jsPlumbUtil.uuid(),n},registerConnectionType:function(t,i){var u,r,f;if(this._connectionTypes[t]=n.extend({},i),i.overlays){for(u={},r=0;r<i.overlays.length;r++)f=this.convertToFullOverlaySpec(i.overlays[r]),u[f[1].id]=f;this._connectionTypes[t].overlays=u}},registerConnectionTypes:function(n){for(var t in n)this.registerConnectionType(t,n[t])},registerEndpointType:function(t,i){this._endpointTypes[t]=n.extend({},i)},registerEndpointTypes:function(t){for(var i in t)this._endpointTypes[i]=n.extend({},t[i])},getType:function(n,t){return"connection"===t?this._connectionTypes[n]:this._endpointTypes[n]},setIdChanged:function(n,t){this.setId(n,t,!0)},setParent:function(n,t){var i=this.getElement(n),u=this.getId(i),r=this.getElement(t),f=this.getId(r);i.parentNode.removeChild(i);r.appendChild(i);this.getDragManager().setParent(i,u,r,f)},extend:function(n,t,i){var r;if(i)for(r=0;r<i.length;r++)n[i[r]]=t[i[r]];else for(r in t)n[r]=t[r];return n},floatingConnections:{},getFloatingAnchorIndex:function(n){return n.endpoints[0].isFloating()?0:1}});n=new h;"undefined"!=typeof window&&(window.jsPlumb=n);n.getInstance=function(n){var t=new h(n);return t.init(),t};n.each=function(t,i){if(null!=t)if("string"==typeof t)i(n.getElement(t));else if(null!=t.length)for(var r=0;r<t.length;r++)i(n.getElement(t[r]));else i(t)};"function"==typeof define&&(define("jsplumb",[],function(){return n}),define("jsplumbinstance",[],function(){return n.getInstance()}));"undefined"!=typeof exports&&(exports.jsPlumb=n)}.call(this),function(){var e=this;e.jsPlumbUtil;var o=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),n=function(){var i,t;return void 0===n.vml&&(i=document.body.appendChild(document.createElement("div")),i.innerHTML='<v:shape id="vml_flag1" adj="1" />',t=i.firstChild,null!=t&&null!=t.style?(t.style.behavior="url(#default#VML)",n.vml=t?"object"==typeof t.adj:!0):n.vml=!1,i.parentNode.removeChild(i)),n.vml},r=function(){var n=-1,t,i;return"Microsoft Internet Explorer"==navigator.appName&&(t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=i.exec(t)&&(n=parseFloat(RegExp.$1))),n}(),s=r>-1&&9>r,t=function(n,t){if(null==n)return[0,0];var r=v(n),i=a(r,0);return[i[t+"X"],i[t+"Y"]]},h=function(n){return null==n?[0,0]:s?[n.clientX+document.documentElement.scrollLeft,n.clientY+document.documentElement.scrollTop]:t(n,"page")},c=function(n){return t(n,"screen")},l=function(n){return t(n,"client")},a=function(n,t){return n.item?n.item(t):n[t]},v=function(n){return n.touches&&n.touches.length>0?n.touches:n.changedTouches&&n.changedTouches.length>0?n.changedTouches:n.targetTouches&&n.targetTouches.length>0?n.targetTouches:[n]},y=function(n){var u={},f=[],t={},r={},i={};this.register=function(e){var o=n.getId(e),h=n.getOffset(e),s;u[o]||(u[o]=e,f.push(e),t[o]={});s=function(u){var f,l,e,c;if(u)for(f=0;f<u.childNodes.length;f++)3!=u.childNodes[f].nodeType&&8!=u.childNodes[f].nodeType&&(l=jsPlumb.getElement(u.childNodes[f]),e=n.getId(u.childNodes[f],null,!0),e&&r[e]&&r[e]>0&&(c=n.getOffset(l),t[o][e]={id:e,offset:{left:c.left-h.left,top:c.top-h.top}},i[e]=o),s(u.childNodes[f]))};s(e)};this.updateOffsets=function(r){var u,c,o;if(null!=r){var s=jsPlumb.getElement(r),f=n.getId(s),e=t[f],h=n.getOffset(s);if(e)for(u in e)e.hasOwnProperty(u)&&(c=jsPlumb.getElement(u),o=n.getOffset(c),t[f][u]={id:u,offset:{left:o.left-h.left,top:o.top-h.top}},i[u]=f)}};this.endpointAdded=function(f,e){var l,o,s,h,c;for(e=e||n.getId(f),l=document.body,o=f.parentNode,r[e]=r[e]?r[e]+1:1;null!=o&&o!=l;){if(s=n.getId(o,null,!0),s&&u[s]){h=n.getOffset(o);null==t[s][e]&&(c=n.getOffset(f),t[s][e]={id:e,offset:{left:c.left-h.left,top:c.top-h.top}},i[e]=s);break}o=o.parentNode}};this.endpointDeleted=function(n){if(r[n.elementId]&&(r[n.elementId]--,r[n.elementId]<=0))for(var u in t)t.hasOwnProperty(u)&&t[u]&&(delete t[u][n.elementId],delete i[n.elementId])};this.changeId=function(n,r){t[r]=t[n];t[n]={};i[r]=i[n];i[n]=null};this.getElementsForDraggable=function(n){return t[n]};this.elementRemoved=function(n){var r=i[n];r&&(delete t[r][n],delete i[n])};this.reset=function(){u={};f=[];t={};r={}};this.dragEnded=function(t){var u=n.getId(t),r=i[u];r&&this.updateOffsets(r)};this.setParent=function(r,u,f,e){var o=i[u],s,h;o&&(t[e]||(t[e]={}),t[e][u]=t[o][u],delete t[o][u],s=n.getOffset(f),h=n.getOffset(r),t[e][u].offset={left:h.left-s.left,top:h.top-s.top},i[u]=e)};this.getDragAncestor=function(t){var u=jsPlumb.getElement(t),f=n.getId(u),r=i[f];return r?jsPlumb.getElement(r):null}},p=function(n){return null==n?null:n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},u=function(n,t){t=p(t);"undefined"!=typeof n.className.baseVal?n.className.baseVal=t:n.className=t},f=function(n){return"undefined"==typeof n.className.baseVal?n.className:n.className.baseVal},i=function(n,t,i){t=null==t?[]:jsPlumbUtil.isArray(t)?t:t.split(/\s+/);i=null==i?[]:jsPlumbUtil.isArray(i)?i:i.split(/\s+/);var o=f(n),r=o.split(/\s+/),e=function(n,t){for(var u,i=0;i<t.length;i++)n?-1==jsPlumbUtil.indexOf(r,t[i])&&r.push(t[i]):(u=jsPlumbUtil.indexOf(r,t[i]),-1!=u&&r.splice(u,1))};e(!0,t);e(!1,i);u(n,r.join(" "))};jsPlumb.extend(jsPlumbInstance.prototype,{headless:!1,pageLocation:h,screenLocation:c,clientLocation:l,getDragManager:function(){return null==this.dragManager&&(this.dragManager=new y(this)),this.dragManager},recalculateOffsets:function(n){this.getDragManager().updateOffsets(n)},createElement:function(n,t,i,r){return this.createElementNS(null,n,t,i,r)},createElementNS:function(n,t,i,r,u){var f,e=null==n?document.createElement(t):document.createElementNS(n,t);i=i||{};for(f in i)e.style[f]=i[f];r&&(e.className=r);u=u||{};for(f in u)e.setAttribute(f,""+u[f]);return e},getAttribute:function(n,t){return null!=n.getAttribute?n.getAttribute(t):null},setAttribute:function(n,t,i){null!=n.setAttribute&&n.setAttribute(t,i)},setAttributes:function(n,t){for(var i in t)t.hasOwnProperty(i)&&n.setAttribute(i,t[i])},appendToRoot:function(n){document.body.appendChild(n)},getRenderModes:function(){return["svg","vml"]},isRenderModeAvailable:function(t){return{svg:o,vml:n()}[t]},trySetRenderMode:function(n){var t,r,i;return n&&(n=n.toLowerCase(),r=this.isRenderModeAvailable("svg"),i=this.isRenderModeAvailable("vml"),"svg"===n?r?t="svg":i&&(t="vml"):i&&(t="vml")),t},addClass:function(n,t){jsPlumb.each(n,function(n){i(n,t)})},hasClass:function(n,t){return n=jsPlumb.getElement(n),n.classList?n.classList.contains(t):-1!=f(n).indexOf(t)},removeClass:function(n,t){jsPlumb.each(n,function(n){i(n,null,t)})},updateClasses:function(n,t,r){jsPlumb.each(n,function(n){i(n,t,r)})},setClass:function(n,t){jsPlumb.each(n,function(n){u(n,t)})},setPosition:function(n,t){n.style.left=t.left+"px";n.style.top=t.top+"px"},getPosition:function(n){var t=function(t){var i=n.style[t];return i?i.substring(0,i.length-2):0};return{left:t("left"),top:t("top")}},getStyle:function(n,t){return"undefined"!=typeof getComputedStyle?getComputedStyle(n,null).getPropertyValue(t):n.currentStyle[t]},getSelector:function(n,t){return 1==arguments.length?null!=n.nodeType?n:document.querySelectorAll(n):n.querySelectorAll(t)},getOffset:function(n,t){var f,e;n=jsPlumb.getElement(n);for(var i=this.getContainer(),u={left:n.offsetLeft,top:n.offsetTop},r=t||null!=i&&n.offsetParent!=i?n.offsetParent:null,o=function(t){null!=t&&t!==document.body&&(t.scrollTop>0||t.scrollLeft>0)&&(this.getStyle(n,"position"),u.left-=t.scrollLeft,u.top-=t.scrollTop)}.bind(this);null!=r;)u.left+=r.offsetLeft,u.top+=r.offsetTop,o(r),r=t?r.offsetParent:r.offsetParent==i?null:r.offsetParent;return null!=i&&!t&&(i.scrollTop>0||i.scrollLeft>0)&&(f=null!=n.offsetParent?this.getStyle(n.offsetParent,"position"):"static",e=this.getStyle(n,"position"),"absolute"!==e&&"fixed"!==e&&"absolute"!==f&&"fixed"!=f&&(u.left-=i.scrollLeft,u.top-=i.scrollTop)),u},getPositionOnElement:function(n,t,i){var r="undefined"!=typeof t.getBoundingClientRect?t.getBoundingClientRect():{left:0,top:0,width:0,height:0},u=document.body,f=document.documentElement,o=window.pageYOffset||f.scrollTop||u.scrollTop,s=window.pageXOffset||f.scrollLeft||u.scrollLeft,h=f.clientTop||u.clientTop||0,c=f.clientLeft||u.clientLeft||0,l=r.top+o-h+0*i,a=r.left+s-c+0*i,e=jsPlumb.pageLocation(n),v=r.width||t.offsetWidth*i,y=r.height||t.offsetHeight*i,p=(e[0]-a)/v,w=(e[1]-l)/y;return[p,w]},getAbsolutePosition:function(n){var t=function(t){var i=n.style[t];if(i)return parseFloat(i.substring(0,i.length-2))};return[t("left"),t("top")]},setAbsolutePosition:function(n,t,i,r){i?this.animate(n,{left:"+="+(t[0]-i[0]),top:"+="+(t[1]-i[1])},r):(n.style.left=t[0]+"px",n.style.top=t[1]+"px")},getSize:function(n){return[n.offsetWidth,n.offsetHeight]},getWidth:function(n){return n.offsetWidth},getHeight:function(n){return n.offsetHeight}})}.call(this),function(){"use strict";var r=this,n=r.jsPlumb,i=r.jsPlumbUtil,t="__label",u=function(i,r){var u={cssClass:r.cssClass,labelStyle:i.labelStyle,id:t,component:i,_jsPlumb:i._jsPlumb.instance},f=jsPlumb.extend(u,r);return new n.Overlays[i._jsPlumb.instance.getRenderMode()].Label(f)},f=function(t,r){var u=null,e,f;return i.isArray(r)?(e=r[0],f=n.extend({component:t,_jsPlumb:t._jsPlumb.instance},r[1]),3==r.length&&n.extend(f,r[2]),u=new n.Overlays[t._jsPlumb.instance.getRenderMode()][e](f)):u=r.constructor==String?new n.Overlays[t._jsPlumb.instance.getRenderMode()][r]({component:t,_jsPlumb:t._jsPlumb.instance}):r,u.id=u.id||i.uuid(),t.cacheTypeItem("overlay",u,u.id),t._jsPlumb.overlays[u.id]=u,u};n.OverlayCapableJsPlumbUIComponent=function(n){jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.overlays={};this._jsPlumb.overlayPositions={};n.label&&(this.getDefaultType().overlays[t]=["Label",{label:n.label,location:n.labelLocation||this.defaultLabelLocation||.5,labelStyle:n.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:t}]);this.setListenerComponent=function(n){if(this._jsPlumb)for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].setListenerComponent(n)}};n.OverlayCapableJsPlumbUIComponent.applyType=function(n,t){var i,u,f,r;if(t.overlays){u={};for(i in t.overlays)f=n._jsPlumb.overlays[t.overlays[i][1].id],f?(f.updateFrom(t.overlays[i][1]),u[t.overlays[i][1].id]=!0):(r=n.getCachedTypeItem("overlay",t.overlays[i][1].id),null!=r?(r.reattach(n._jsPlumb.instance),r.updateFrom(t.overlays[i][1]),n._jsPlumb.overlays[r.id]=r):r=n.addOverlay(t.overlays[i],!0),u[r.id]=!0);for(i in n._jsPlumb.overlays)null==u[n._jsPlumb.overlays[i].id]&&n.removeOverlay(n._jsPlumb.overlays[i].id)}};i.extend(n.OverlayCapableJsPlumbUIComponent,jsPlumbUIComponent,{setHover:function(n){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t][n?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(n,t){var i=f(this,n);return t||this.repaint(),i},getOverlay:function(n){return this._jsPlumb.overlays[n]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(n){var t=this.getOverlay(n);t&&t.hide()},hideOverlays:function(){for(var n in this._jsPlumb.overlays)this._jsPlumb.overlays[n].hide()},showOverlay:function(n){var t=this.getOverlay(n);t&&t.show()},showOverlays:function(){for(var n in this._jsPlumb.overlays)this._jsPlumb.overlays[n].show()},removeAllOverlays:function(n){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].cleanup&&this._jsPlumb.overlays[t].cleanup();this._jsPlumb.overlays={};this._jsPlumb.overlayPositions=null;n||this.repaint()},removeOverlay:function(n){var t=this._jsPlumb.overlays[n];t&&(t.cleanup&&t.cleanup(),delete this._jsPlumb.overlays[n],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[n])},removeOverlays:function(){for(var n=0,t=arguments.length;t>n;n++)this.removeOverlay(arguments[n])},moveParent:function(n){var i,t;this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),n.appendChild(this.bgCanvas));this.canvas.parentNode.removeChild(this.canvas);n.appendChild(this.canvas);for(i in this._jsPlumb.overlays)this._jsPlumb.overlays[i].isAppendedAtTopLevel&&(t=this._jsPlumb.overlays[i].getElement(),t.parentNode.removeChild(t),n.appendChild(t))},getLabel:function(){var n=this.getOverlay(t);return null!=n?n.getLabel():null},getLabelOverlay:function(){return this.getOverlay(t)},setLabel:function(n){var i=this.getOverlay(t),r;i?n.constructor==String||n.constructor==Function?i.setLabel(n):(n.label&&i.setLabel(n.label),n.location&&i.setLocation(n.location)):(r=n.constructor==String||n.constructor==Function?{label:n}:n,i=u(this,r),this._jsPlumb.overlays[t]=i);this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(n){for(var t in this._jsPlumb.overlays)this._jsPlumb.overlays[t].cleanup(n),this._jsPlumb.overlays[t].destroy(n);n&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(n){this[n?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(n,t){this._jsPlumb.overlayPositions[n.id]=t},getAbsoluteOverlayPosition:function(n){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[n.id]:null}})}.call(this),function(){"use strict";var i=this,n=i.jsPlumb,t=i.jsPlumbUtil,f=function(t,i){var r=!1;return{drag:function(){if(r)return r=!1,!0;var u=n.getUIPosition(arguments,i.getZoom());t.element&&(jsPlumb.setPosition(t.element,u),i.repaint(t.element,u))},stopDrag:function(){r=!0}}},e=function(n,t){var i=jsPlumb.createElement("div",{position:"absolute"}),r;t.appendElement(i);r=t.getId(i);t.manage(r,i);n.id=r;n.element=i},o=function(t,i,r,u,f,e,o,s){var h=new n.FloatingAnchor({reference:i,referenceCanvas:u,jsPlumbInstance:e});return o({paintStyle:t,endpoint:r,anchor:h,source:f,scope:s})},r=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],s=function(n,t){var r=0,i;if(null!=t)for(i=0;i<n.connections.length;i++)if(n.connections[i].sourceId==t||n.connections[i].targetId==t){r=i;break}return n.connections[r]},u=function(n,i){return t.findWithFunction(i.connections,function(t){return t.id==n.id})};n.Endpoint=function(i){var h=i._jsPlumb,d=i.newConnection,y=i.newEndpoint,c,l,a,v,p,w,b,k;return this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],n.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:i.connectionType,maxConnections:null==i.maxConnections?this._jsPlumb.instance.Defaults.MaxConnections:i.maxConnections,paintStyle:i.endpointStyle||i.paintStyle||i.style||this._jsPlumb.instance.Defaults.EndpointStyle||n.Defaults.EndpointStyle,hoverPaintStyle:i.endpointHoverStyle||i.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||n.Defaults.EndpointHoverStyle,connectorStyle:i.connectorStyle,connectorHoverStyle:i.connectorHoverStyle,connectorClass:i.connectorClass,connectorHoverClass:i.connectorHoverClass,connectorOverlays:i.connectorOverlays,connector:i.connector,connectorTooltip:i.connectorTooltip}),this._jsPlumb.enabled=!(i.enabled===!1),this._jsPlumb.visible=!0,this.element=n.getElement(i.source),this._jsPlumb.uuid=i.uuid,this._jsPlumb.floatingEndpoint=null,c=null,this._jsPlumb.uuid&&(i.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=i.elementId,this._jsPlumb.connectionCost=i.connectionCost,this._jsPlumb.connectionsDirected=i.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={},l=function(){var t=h.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass,n;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();n=h.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"_"+this._jsPlumb.currentAnchorClass:"");this.removeClass(t);this.addClass(n);jsPlumb.updateClasses(this.element,n,t)}.bind(this),this.prepareAnchor=function(n){var t=this._jsPlumb.instance.makeAnchor(n,this.elementId,h);return t.bind("anchorChanged",function(n){this.fire("anchorChanged",{endpoint:this,anchor:n});l()}.bind(this)),t},this.setPreparedAnchor=function(n,t){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=n,l(),t||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(n,t){var i=this.prepareAnchor(n);return this.setPreparedAnchor(i,t),this},a=function(n){if(this.connections.length>0)for(var t=0;t<this.connections.length;t++)this.connections[t].setHover(n,!1);else this.setHover(n)}.bind(this),this.bind("mouseover",function(){a(!0)}),this.bind("mouseout",function(){a(!1)}),i._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.prepareEndpoint=function(r,u){var e,o=function(t,i){var r=h.getRenderMode();if(n.Endpoints[r][t])return new n.Endpoints[r][t](i);if(!h.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+t+"'"};},f={_jsPlumb:this._jsPlumb.instance,cssClass:i.cssClass,container:i.container,tooltip:i.tooltip,connectorTooltip:i.connectorTooltip,endpoint:this};return t.isString(r)?e=o(r,f):t.isArray(r)?(f=t.merge(r[1],f),e=o(r[0],f)):e=r.clone(),e.clone=function(){return t.isString(r)?o(r,f):t.isArray(r)?(f=t.merge(r[1],f),o(r[0],f)):void 0}.bind(this),e.typeId=u,e},this.setEndpoint=function(n){var t=this.prepareEndpoint(n);this.setPreparedEndpoint(t,!0)},this.setPreparedEndpoint=function(n){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy());this.endpoint=n;this.type=this.endpoint.type;this.canvas=this.endpoint.canvas},n.extend(this,i,r),this.isSource=i.isSource||!1,this.isTemporarySource=i.isTemporarySource||!1,this.isTarget=i.isTarget||!1,this.connections=i.connections||[],this.connectorPointerEvents=i["connector-pointer-events"],this.scope=i.scope||h.getDefaultScope(),this.timestamp=null,this.reattachConnections=i.reattach||h.Defaults.ReattachConnections,this.connectionsDetachable=h.Defaults.ConnectionsDetachable,(i.connectionsDetachable===!1||i.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=i.dragAllowedWhenFull!==!1,i.onMaxConnections&&this.bind("maxConnections",i.onMaxConnections),this.addConnection=function(n){this.connections.push(n);this[(this.connections.length>0?"add":"remove")+"Class"](h.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](h.endpointFullClass)},this.detachFromConnection=function(n,t,i){t=null==t?u(n,this):t;t>=0&&(this.connections.splice(t,1),this[(this.connections.length>0?"add":"remove")+"Class"](h.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](h.endpointFullClass));!i&&this._deleteOnDetach&&0===this.connections.length&&h.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:!1})},this.detach=function(n,t,i,r,f,e,o){var c=null==o?u(n,this):o,s=!1;return r=r!==!1,c>=0&&(i||n._forceDetach||n.isDetachable()&&n.isDetachAllowed(n)&&this.isDetachAllowed(n)&&h.checkCondition("beforeDetach",n,e))&&(h.deleteObject({connection:n,fireEvent:!t&&r,originalEvent:f,deleteAttachedObjects:!1}),s=!0),s},this.detachAll=function(n,t){for(var r,i=[];this.connections.length>0;)r=this.detach(this.connections[0],!1,t===!0,n!==!1,null,this,0),r||(i.push(this.connections[0]),this.connections.splice(0,1));return this.connections=i,this},this.detachFrom=function(n,t,i){for(var f,u=[],r=0;r<this.connections.length;r++)(this.connections[r].endpoints[1]==n||this.connections[r].endpoints[0]==n)&&u.push(this.connections[r]);for(f=0;f<u.length;f++)this.detach(u[f],!1,!0,t,i);return this},this.getElement=function(){return this.element},this.setElement=function(n){var r=this._jsPlumb.instance.getId(n),u=this.elementId;return t.removeWithFunction(i.endpointsByElement[this.elementId],function(n){return n.id==this.id}.bind(this)),this.element=jsPlumb.getElement(n),this.elementId=h.getId(this.element),h.anchorManager.rehomeEndpoint(this,u,this.element),h.dragManager.endpointAdded(this.element),t.addToList(i.endpointsByElement,r,this),this},this.makeInPlaceCopy=function(){var n=this.anchor.getCurrentLocation({element:this}),t=this.anchor.getOrientation(this),r=this.anchor.getCssClass(),u={bind:function(){},compute:function(){return[n[0],n[1]]},getCurrentLocation:function(){return[n[0],n[1]]},getOrientation:function(){return t},getCssClass:function(){return r}};return y({dropOptions:i.dropOptions,anchor:u,source:this.element,paintStyle:this.getPaintStyle(),endpoint:i.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){var n=this.connections[0];return n?n:this.connections.length<this._jsPlumb.maxConnections||-1==this._jsPlumb.maxConnections?null:n},this.setStyle=this.setPaintStyle,this.paint=function(n){var t,l,c,u,f,a,v,i,r,o;if(n=n||{},t=n.timestamp,l=!(n.recalc===!1),(!t||this.timestamp!==t)&&(c=h.updateOffset({elId:this.elementId,timestamp:t}),u=n.offset?n.offset.o:c.o,null!=u)){if(f=n.anchorPoint,a=n.connectorPaintStyle,null==f){if(v=n.dimensions||c.s,i={xy:[u.left,u.top],wh:v,element:this,timestamp:t},l&&this.anchor.isDynamic&&this.connections.length>0){var e=s(this,n.elementWithPrecedence),y=e.endpoints[0]==this?1:0,b=0===y?e.sourceId:e.targetId,p=h.getCachedData(b),w=p.o,k=p.s;i.txy=[w.left,w.top];i.twh=k;i.tElement=e.endpoints[y]}f=this.anchor.compute(i)}this.endpoint.compute(f,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,a||this.paintStyleInUse);this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor);this.timestamp=t;for(r in this._jsPlumb.overlays)this._jsPlumb.overlays.hasOwnProperty(r)&&(o=this._jsPlumb.overlays[r],o.isVisible()&&(this._jsPlumb.overlayPlacements[r]=o.draw(this.endpoint,this._jsPlumb.paintStyleInUse),o.paint(this._jsPlumb.overlayPlacements[r])))}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint,v=!1,this.initDraggable=function(r){if(!v&&n.isDragSupported(this.element)){var s={id:null,element:null},u=null,p=!1,a=null,w=f(s,h),l=i.dragOptions||{},b=n.dragEvents.start,k=n.dragEvents.stop,g=n.dragEvents.drag,nt=function(){var r,b,l,k,f,n,v,g;if(u=this.connectorSelector(),r=!0,this.isEnabled()||(r=!1),null!=u||this.isSource||this.isTemporarySource||(r=!1),!this.isSource||!this.isFull()||null!=u&&this.dragAllowedWhenFull||(r=!1),null==u||u.isDetachable(this)||(r=!1),b=h.checkCondition(null==u?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:u}),b===!1&&(r=!1),r===!1)return h.stopDrag&&h.stopDrag(this.canvas),w.stopDrag(),!1;for(l=0;l<this.connections.length;l++)this.connections[l].setHover(!1);this.addClass("endpointDrag");h.setConnectionBeingDragged(!0);u&&!this.isFull()&&this.isSource&&(u=null);h.updateOffset({elId:this.elementId});c=this.makeInPlaceCopy();c.addClass(h.draggingClass);c.referenceEndpoint=this;c.paint();e(s,h);k=this._jsPlumb.instance.getOffset(c.canvas);f=this.canvas;(jsPlumb.setPosition(s.element,k),this.parentAnchor&&(this.anchor=h.makeAnchor(this.parentAnchor,this.elementId,h)),h.setAttributes(this.canvas,{dragId:s.id,elId:this.elementId}),this._jsPlumb.floatingEndpoint=o(this.getPaintStyle(),this.anchor,this.endpoint,this.canvas,s.element,h,y,this.scope),this.canvas.style.visibility="hidden",null==u)?(this.anchor.locked=!0,this.setHover(!1,!1),u=d({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.endpointWillMoveTo||this.element,target:s.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:i.connectorStyle,hoverPaintStyle:i.connectorHoverStyle,connector:i.connector,overlays:i.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,data:b}),u.addClass(h.draggingClass),this._jsPlumb.floatingEndpoint.addClass(h.draggingClass),h.fire("connectionDrag",u)):(p=!0,u.setHover(!1),n=u.endpoints[0].id==this.id?0:1,this.detachFromConnection(u,null,!0),v=h.getDragScope(f),h.setAttribute(this.canvas,"originalScope",v),g=h.getDropScope(f),h.setDragScope(f,g),h.fire("connectionDrag",u),0===n?(a=[u.source,u.sourceId,f,v],u.source=s.element,u.sourceId=s.id):(a=[u.target,u.targetId,f,v],u.target=s.element,u.targetId=s.id),u.endpoints[0===n?1:0].anchor.locked=!0,u.suspendedEndpoint=u.endpoints[n],u.suspendedElement=u.endpoints[n].getElement(),u.suspendedElementId=u.endpoints[n].elementId,u.suspendedElementType=0===n?"source":"target",u.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=u.suspendedEndpoint,u.endpoints[n]=this._jsPlumb.floatingEndpoint,u.addClass(h.draggingClass),this._jsPlumb.floatingEndpoint.addClass(h.draggingClass));h.floatingConnections[s.id]=u;h.anchorManager.addFloatingConnection(s.id,u);t.addToList(i.endpointsByElement,s.id,this._jsPlumb.floatingEndpoint);h.currentlyDragging=!0}.bind(this),tt=function(){var t,n,i;(h.setConnectionBeingDragged(!1),u&&null!=u.endpoints)&&(t=h.getDropEvent(arguments),n=h.getFloatingAnchorIndex(u),(u.endpoints[0===n?1:0].anchor.locked=!1,u.removeClass(h.draggingClass),this._jsPlumb&&(u.deleteConnectionNow||u.endpoints[n]==this._jsPlumb.floatingEndpoint)&&p&&u.suspendedEndpoint)&&(0===n?(u.source=a[0],u.sourceId=a[1]):(u.target=a[0],u.targetId=a[1]),i=this._jsPlumb.floatingEndpoint,h.setDragScope(a[2],a[3]),u.endpoints[n]=u.suspendedEndpoint,u.isReattach()||u._forceReattach||u._forceDetach||!u.endpoints[0===n?1:0].detach(u,!1,!1,!0,t,!0)?(u.setHover(!1),u._forceDetach=null,u._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(u),u.suspendedEndpoint.addConnection(u),h.repaint(a[1])):h.deleteObject({endpoint:i})),h.remove(s.element,!1),h.deleteObject({endpoint:c}),this.deleteAfterDragStop?h.deleteObject({endpoint:this}):this._jsPlumb&&(this._jsPlumb.floatingEndpoint=null,this.canvas.style.visibility="visible",this.anchor.locked=!1,this.paint({recalc:!1})),h.fire("connectionDragStop",u,t),h.currentlyDragging=!1,u=null)}.bind(this);l=n.extend({},l);l.scope=this.scope||l.scope;l[b]=t.wrap(l[b],nt,!1);l[g]=t.wrap(l[g],w.drag);l[k]=t.wrap(l[k],tt);l.multipleDrop=!1;l.definitionId=r;l.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0}.bind(this);h.initDraggable(this.canvas,l,"internal");this.canvas._jsPlumbRelatedElement=this.element;v=!0}},p=i.endpoint||this._jsPlumb.instance.Defaults.Endpoint||n.Defaults.Endpoint,this.setEndpoint(p,!0),w=i.anchor?i.anchor:i.anchors?i.anchors:h.Defaults.Anchor||"Top",this.setAnchor(w,!0),b=["default",i.type||""].join(" "),this.addType(b,i.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,(this.isSource||this.isTarget||this.isTemporarySource)&&this.initDraggable(this.isTarget?"_jsPlumbTarget":"_jsPlumbSource"),k=function(r,u,f,e,o){var s;if((this.isTarget||u)&&n.isDropSupported(this.element)){s=i.dropOptions||h.Defaults.DropOptions||n.Defaults.DropOptions;s=n.extend({},s);s.scope=s.scope||this.scope;var l=n.dragEvents.drop,a=n.dragEvents.over,v=n.dragEvents.out,c=this,y=h.EndpointDropHandler({getEndpoint:function(){return c},jsPlumb:h,enabled:function(){return null!=e?e.isEnabled():!0},isFull:function(){return e.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(n){c.addClass(n)},removeClass:function(n){c.removeClass(n)},isDropAllowed:function(){return c.isDropAllowed.apply(c,arguments)},reference:o,isRedrop:function(n,t){return n.suspendedEndpoint&&t.reference&&n.suspendedEndpoint.id===t.reference.id}});s[l]=t.wrap(s[l],y,!0);s[a]=t.wrap(s[a],function(){var f=n.getDragObject(arguments),e=h.getAttribute(n.getElement(f),"dragId"),t=h.floatingConnections[e],i,u,r;null!=t&&(i=h.getFloatingAnchorIndex(t),u=this.isTarget&&0!==i||t.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==t.suspendedEndpoint.id,u&&(r=h.checkCondition("checkDropAllowed",{sourceEndpoint:t.endpoints[i],targetEndpoint:this,connection:t}),this[(r?"add":"remove")+"Class"](h.endpointDropAllowedClass),this[(r?"remove":"add")+"Class"](h.endpointDropForbiddenClass),t.endpoints[i].anchor.over(this.anchor,this)))}.bind(this));s[v]=t.wrap(s[v],function(){var r=n.getDragObject(arguments),u=null==r?null:h.getAttribute(n.getElement(r),"dragId"),t=u?h.floatingConnections[u]:null,i,f;null!=t&&(i=h.getFloatingAnchorIndex(t),f=this.isTarget&&0!==i||t.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==t.suspendedEndpoint.id,f&&(this.removeClass(h.endpointDropAllowedClass),this.removeClass(h.endpointDropForbiddenClass),t.endpoints[i].anchor.out()))}.bind(this));h.initDroppable(r,s,"internal",f)}}.bind(this),this.anchor.isFloating||k(this.canvas,!0,!(i._transient||this.anchor.isFloating),this,i.reference),this};t.extend(n.Endpoint,n.OverlayCapableJsPlumbUIComponent,{setVisible:function(n,t,i){var r,u;if(this._jsPlumb.visible=n,this.canvas&&(this.canvas.style.display=n?"block":"none"),this[n?"showOverlays":"hideOverlays"](),!t)for(r=0;r<this.connections.length;r++)(this.connections[r].setVisible(n),i)||(u=this===this.connections[r].endpoints[0]?1:0,1==this.connections[r].endpoints[u].connections.length&&this.connections[r].endpoints[u].setVisible(n,!0,!0))},getAttachedElements:function(){return this.connections},applyType:function(t,i){this.setPaintStyle(t.endpointStyle||t.paintStyle,i);this.setHoverPaintStyle(t.endpointHoverStyle||t.hoverPaintStyle,i);null!=t.maxConnections&&(this._jsPlumb.maxConnections=t.maxConnections);t.scope&&(this.scope=t.scope);n.extend(this,t,r);null!=t.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass);n.OverlayCapableJsPlumbUIComponent.applyType(this,t)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(n){this._jsPlumb.enabled=n},cleanup:function(){var n=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"_"+this._jsPlumb.currentAnchorClass:"");jsPlumb.removeClass(this.element,n);this.anchor=null;this.endpoint.cleanup();this.endpoint.destroy();this.endpoint=null;this._jsPlumb.instance.destroyDraggable(this.canvas,"internal");this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(n){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(n)},isFull:function(){return 0===this._jsPlumb.maxConnections?!0:!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return null!=this.anchor&&this.anchor.isFloating},isConnectedTo:function(n){var i=!1,t;if(n)for(t=0;t<this.connections.length;t++)if(this.connections[t].endpoints[1]==n||this.connections[t].endpoints[0]==n){i=!0;break}return i},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(n){this._jsPlumb.connectionCost=n},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(n){this._jsPlumb.connectionsDirected=n},setElementId:function(n){this.elementId=n;this.anchor.elementId=n},setReferenceElement:function(t){this.element=n.getElement(t)},setDragAllowedWhenFull:function(n){this.dragAllowedWhenFull=n},equals:function(n){return this.anchor.equals(n.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(n){return this.anchor.compute(n)}});i.jsPlumbInstance.prototype.EndpointDropHandler=function(n){return function(t){var u=n.jsPlumb,f,r,e,c,l;n.removeClass(u.endpointDropAllowedClass);n.removeClass(u.endpointDropForbiddenClass);var s=u.getDropEvent(arguments),o=u.getDragObject(arguments),a=u.getAttribute(o,"dragId"),h=(u.getAttribute(o,"elId"),u.getAttribute(o,"originalScope")),i=u.floatingConnections[a];if(null!=i&&!(t.drag&&t.drop&&t.drag.params.definitionId===t.drop.params.definitionId&&null==i.suspendedEndpoint||i.suspendedEndpoint&&null==i.suspendedEndpoint._jsPlumb)){if(f=n.getEndpoint(i),n.isRedrop(i,n))return i._forceReattach=!0,i.setHover(!1),n.maybeCleanup&&n.maybeCleanup(f),void 0;if(r=u.getFloatingAnchorIndex(i),(0!==r||n.isSource)&&(1!==r||n.isTarget)){if(n.onDrop&&n.onDrop(i),h&&u.setDragScope(o,h),n.isFull(t)&&f.fire("maxConnections",{endpoint:this,connection:i,maxConnections:f._jsPlumb.maxConnections},s),!n.isFull()&&(0!==r||n.isSource)&&(1!=r||n.isTarget)&&n.enabled()){if(e=!0,0===r?(i.source=n.element,i.sourceId=n.elementId):(i.target=n.element,i.targetId=n.elementId),i.suspendedEndpoint&&i.suspendedEndpoint._jsPlumb&&i.suspendedEndpoint.id!=f.id&&(i.isDetachAllowed(i)&&i.endpoints[r].isDetachAllowed(i)&&i.suspendedEndpoint.isDetachAllowed(i)&&u.checkCondition("beforeDetach",i)||(e=!1)),c=function(n){var t,e,o,h;i.endpoints[r].detachFromConnection(i);i.suspendedEndpoint&&i.suspendedEndpoint.detachFromConnection(i);i.endpoints[r]=f;f.addConnection(i);t=f.getParameters();for(e in t)i.setParameter(e,t[e]);i.suspendedEndpoint?(o=i.suspendedEndpoint.elementId,u.fireMoveEvent({index:r,originalSourceId:0===r?o:i.sourceId,newSourceId:0===r?f.elementId:i.sourceId,originalTargetId:1==r?o:i.targetId,newTargetId:1==r?f.elementId:i.targetId,originalSourceEndpoint:0===r?i.suspendedEndpoint:i.endpoints[0],newSourceEndpoint:0===r?f:i.endpoints[0],originalTargetEndpoint:1==r?i.suspendedEndpoint:i.endpoints[1],newTargetEndpoint:1==r?f:i.endpoints[1],connection:i},s)):t.draggable&&u.initDraggable(this.element,dragOptions,"internal",u);(1==r?u.anchorManager.updateOtherEndpoint(i.sourceId,i.suspendedElementId,i.targetId,i):u.anchorManager.sourceChanged(i.suspendedEndpoint.elementId,i.sourceId,i),i.endpoints[0].finalEndpoint)&&(h=i.endpoints[0],h.detachFromConnection(i),i.endpoints[0]=i.endpoints[0].finalEndpoint,i.endpoints[0].addConnection(i));jsPlumbUtil.isObject(n)&&i.mergeData(n);u.finaliseConnection(i,null,s);i.setHover(!1)}.bind(this),l=function(){i.suspendedEndpoint&&(i.endpoints[r]=i.suspendedEndpoint,i.setHover(!1),i._forceDetach=!0,0===r?(i.source=i.suspendedEndpoint.element,i.sourceId=i.suspendedEndpoint.elementId):(i.target=i.suspendedEndpoint.element,i.targetId=i.suspendedEndpoint.elementId),i.suspendedEndpoint.addConnection(i),u.repaint(i.sourceId),i._forceDetach=!1)},e=e&&n.isDropAllowed(i.sourceId,i.targetId,i.scope,i,f))return c(e),!0;l()}n.maybeCleanup&&n.maybeCleanup(f);u.currentlyDragging=!1}}}}}.call(this),function(){"use strict";var i=this,n=i.jsPlumb,t=i.jsPlumbUtil,u=function(t,i,r,u,f){if(!t.Defaults.DoNotThrowErrors&&null==jsPlumb.Connectors[i][r])throw{msg:"jsPlumb: unknown connector type '"+r+"'"};return new n.Connectors[i][r](u,f)},r=function(n,t,i){return n?i.makeAnchor(n,t,i):null},f=function(n,i,r,u){null!=i&&(i._jsPlumbConnections=i._jsPlumbConnections||{},u?delete i._jsPlumbConnections[n.id]:i._jsPlumbConnections[n.id]=!0,t.isEmpty(i._jsPlumbConnections)?r.removeClass(i,r.connectedClass):r.addClass(i,r.connectedClass))};n.Connection=function(i){var g=i.newEndpoint,r,c,l,u,y,p,h,f,v;if(this.id=i.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=i.previousConnection,this.source=n.getElement(i.source),this.target=n.getElement(i.target),i.sourceEndpoint&&(this.source=i.sourceEndpoint.getElement()),i.targetEndpoint&&(this.target=i.targetEndpoint.getElement()),n.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.sourceId=this._jsPlumb.instance.getId(this.source),this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=i.scope,this.endpoints=[],this.endpointStyles=[],r=this._jsPlumb.instance,r.manage(this.sourceId,this.source),r.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.editable=i.editable===!0,this._jsPlumb.params={cssClass:i.cssClass,container:i.container,"pointer-events":i["pointer-events"],editorParams:i.editorParams,overlays:i.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.makeEndpoint=function(n,t,u,f){return u=u||this._jsPlumb.instance.getId(t),this.prepareEndpoint(r,g,this,f,n?0:1,i,t,u)},c=this.makeEndpoint(!0,this.source,this.sourceId,i.sourceEndpoint),l=this.makeEndpoint(!1,this.target,this.targetId,i.targetEndpoint),c&&t.addToList(i.endpointsByElement,this.sourceId,c),l&&t.addToList(i.endpointsByElement,this.targetId,l),this.scope||(this.scope=this.endpoints[0].scope),null!=i.deleteEndpointsOnDetach?(this.endpoints[0]._deleteOnDetach=i.deleteEndpointsOnDetach,this.endpoints[1]._deleteOnDetach=i.deleteEndpointsOnDetach):(this.endpoints[0]._doNotDeleteOnDetach||(this.endpoints[0]._deleteOnDetach=!0),this.endpoints[1]._doNotDeleteOnDetach||(this.endpoints[1]._deleteOnDetach=!0)),u=r.Defaults.ConnectionsDetachable,i.detachable===!1&&(u=!1),this.endpoints[0].connectionsDetachable===!1&&(u=!1),this.endpoints[1].connectionsDetachable===!1&&(u=!1),y=i.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||r.Defaults.ReattachConnections,this.appendToDefaultType({detachable:u,rettach:y,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||i.paintStyle||r.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||i.hoverPaintStyle||r.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle}),p=r.getSuspendedAt(),!r.isSuspendDrawing()){var w=r.getCachedData(this.sourceId),e=w.o,b=w.s,k=r.getCachedData(this.targetId),o=k.o,d=k.s,s=p||r.timestamp(),a=this.endpoints[0].anchor.compute({xy:[e.left,e.top],wh:b,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[o.left,o.top],twh:d,tElement:this.endpoints[1],timestamp:s});this.endpoints[0].paint({anchorLoc:a,timestamp:s});a=this.endpoints[1].anchor.compute({xy:[o.left,o.top],wh:d,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[e.left,e.top],twh:b,tElement:this.endpoints[0],timestamp:s});this.endpoints[1].paint({anchorLoc:a,timestamp:s})}this.getTypeDescriptor=function(){return"connection"};this.getAttachedElements=function(){return this.endpoints};this.isDetachable=function(){return this._jsPlumb.detachable===!0};this.setDetachable=function(n){this._jsPlumb.detachable=n===!0};this.isReattach=function(){return this._jsPlumb.reattach===!0||this.endpoints[0].reattachConnections===!0||this.endpoints[1].reattachConnections===!0};this.setReattach=function(n){this._jsPlumb.reattach=n===!0};this._jsPlumb.cost=i.cost||this.endpoints[0].getConnectionCost();this._jsPlumb.directed=i.directed;null==i.directed&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());h=jsPlumb.extend({},this.endpoints[1].getParameters());n.extend(h,this.endpoints[0].getParameters());n.extend(h,this.getParameters());this.setParameters(h);this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||i.connector||r.Defaults.Connector||n.Defaults.Connector,!0);f=null!=i.data&&jsPlumbUtil.isObject(i.data)?i.data:{};this.getData=function(){return f};this.setData=function(n){f=n||{}};this.mergeData=function(n){f=jsPlumb.extend(f,n)};v=["default",i.type,this.endpoints[0].connectionType,this.endpoints[1].connectionType].join(" ");/[^\s]/.test(v)&&this.addType(v,i.data,!0);this.updateConnectedClass()};t.extend(n.Connection,n.OverlayCapableJsPlumbUIComponent,{applyType:function(t,i,r){null!=t.detachable&&this.setDetachable(t.detachable);null!=t.reattach&&this.setReattach(t.reattach);t.scope&&(this.scope=t.scope);null!=t.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,t.cssClass);var u=null;t.anchor?(u=this.getCachedTypeItem("anchors",r.anchor),null==u&&(u=[this._jsPlumb.instance.makeAnchor(t.anchor),this._jsPlumb.instance.makeAnchor(t.anchor)],this.cacheTypeItem("anchors",u,r.anchor))):t.anchors&&(u=this.getCachedTypeItem("anchors",r.anchors),null==u&&(u=[this._jsPlumb.instance.makeAnchor(t.anchors[0]),this._jsPlumb.instance.makeAnchor(t.anchors[1])],this.cacheTypeItem("anchors",u,r.anchors)));null!=u&&(this.endpoints[0].anchor=u[0],this.endpoints[1].anchor=u[1]);n.OverlayCapableJsPlumbUIComponent.applyType(this,t)},addClass:function(n,t){t&&(this.endpoints[0].addClass(n),this.endpoints[1].addClass(n),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(n));this.connector&&this.connector.addClass(n)},removeClass:function(n,t){t&&(this.endpoints[0].removeClass(n),this.endpoints[1].removeClass(n),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(n));this.connector&&this.connector.removeClass(n)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(n){this._jsPlumb.visible=n;this.connector&&this.connector.setVisible(n);this.repaint()},cleanup:function(){this.updateConnectedClass(!0);this.endpoints=null;this.source=null;this.target=null;null!=this.connector&&(this.connector.cleanup(!0),this.connector.destroy(!0));this.connector=null},updateConnectedClass:function(n){f(this,this.source,this._jsPlumb.instance,n);f(this,this.target,this._jsPlumb.instance,n)},setHover:function(n){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(n),i.jsPlumb[n?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),i.jsPlumb[n?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb.cost},setCost:function(n){this._jsPlumb.cost=n},isDirected:function(){return this._jsPlumb.directed===!0},getConnector:function(){return this.connector},prepareConnector:function(n,i){var r,f={_jsPlumb:this._jsPlumb.instance,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},e=this._jsPlumb.instance.getRenderMode();return t.isString(n)?r=u(this._jsPlumb.instance,e,n,f,this):t.isArray(n)&&(r=1==n.length?u(this._jsPlumb.instance,e,n[0],f,this):u(this._jsPlumb.instance,e,n[0],t.merge(n[1],f),this)),null!=i&&(r.typeId=i),r},setPreparedConnector:function(n,t,i,r){var e,f,u;if(null!=this.connector&&(e=this.connector,this.connector.cleanup(),this.connector.destroy()),this.connector=n,r&&this.cacheTypeItem("connector",n,r),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),null!=e)for(f=this.getOverlays(),u=0;u<f.length;u++)f[u].transfer&&f[u].transfer(this.connector);i||this.setListenerComponent(this.connector);t||this.repaint()},setConnector:function(n,t,i,r){var u=this.prepareConnector(n,r);this.setPreparedConnector(u,t,i,r)},paint:function(n){var t,i,o,c,l;if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){n=n||{};var r=n.timestamp,e=!1,b=e?this.sourceId:this.targetId,k=e?this.targetId:this.sourceId,a=e?0:1,v=e?1:0;if(null==r||r!=this._jsPlumb.lastPaintedAt){var u=this._jsPlumb.instance.updateOffset({elId:k}).o,f=this._jsPlumb.instance.updateOffset({elId:b}).o,y=this.endpoints[v],p=this.endpoints[a],d=y.anchor.getCurrentLocation({xy:[u.left,u.top],wh:[u.width,u.height],element:y,timestamp:r}),g=p.anchor.getCurrentLocation({xy:[f.left,f.top],wh:[f.width,f.height],element:p,timestamp:r});this.connector.resetBounds();this.connector.compute({sourcePos:d,targetPos:g,sourceEndpoint:this.endpoints[v],targetEndpoint:this.endpoints[a],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:u,targetInfo:f});t={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(i in this._jsPlumb.overlays)this._jsPlumb.overlays.hasOwnProperty(i)&&(o=this._jsPlumb.overlays[i],o.isVisible()&&(this._jsPlumb.overlayPlacements[i]=o.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(o)),t.minX=Math.min(t.minX,this._jsPlumb.overlayPlacements[i].minX),t.maxX=Math.max(t.maxX,this._jsPlumb.overlayPlacements[i].maxX),t.minY=Math.min(t.minY,this._jsPlumb.overlayPlacements[i].minY),t.maxY=Math.max(t.maxY,this._jsPlumb.overlayPlacements[i].maxY)));var s=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2,h=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0),w={xmin:Math.min(this.connector.bounds.minX-(s+h),t.minX),ymin:Math.min(this.connector.bounds.minY-(s+h),t.minY),xmax:Math.max(this.connector.bounds.maxX+(s+h),t.maxX),ymax:Math.max(this.connector.bounds.maxY+(s+h),t.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,w);for(c in this._jsPlumb.overlays)this._jsPlumb.overlays.hasOwnProperty(c)&&(l=this._jsPlumb.overlays[c],l.isVisible()&&l.paint(this._jsPlumb.overlayPlacements[c],w))}this._jsPlumb.lastPaintedAt=r}},repaint:function(n){n=n||{};this.paint({elId:this.sourceId,recalc:!(n.recalc===!1),timestamp:n.timestamp})},prepareEndpoint:function(t,i,u,f,e,o,s,h){var a,v,c,l,y,p;return f?(u.endpoints[e]=f,f.addConnection(u)):(o.endpoints||(o.endpoints=[null,null]),v=o.endpoints[e]||o.endpoint||t.Defaults.Endpoints[e]||jsPlumb.Defaults.Endpoints[e]||t.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,o.endpointStyles||(o.endpointStyles=[null,null]),o.endpointHoverStyles||(o.endpointHoverStyles=[null,null]),c=o.endpointStyles[e]||o.endpointStyle||t.Defaults.EndpointStyles[e]||jsPlumb.Defaults.EndpointStyles[e]||t.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,null==c.fillStyle&&null!=o.paintStyle&&(c.fillStyle=o.paintStyle.strokeStyle),null==c.outlineColor&&null!=o.paintStyle&&(c.outlineColor=o.paintStyle.outlineColor),null==c.outlineWidth&&null!=o.paintStyle&&(c.outlineWidth=o.paintStyle.outlineWidth),l=o.endpointHoverStyles[e]||o.endpointHoverStyle||t.Defaults.EndpointHoverStyles[e]||jsPlumb.Defaults.EndpointHoverStyles[e]||t.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,null!=o.hoverPaintStyle&&(null==l&&(l={}),null==l.fillStyle&&(l.fillStyle=o.hoverPaintStyle.strokeStyle)),y=o.anchors?o.anchors[e]:o.anchor?o.anchor:r(t.Defaults.Anchors[e],h,t)||r(n.Defaults.Anchors[e],h,t)||r(t.Defaults.Anchor,h,t)||r(n.Defaults.Anchor,h,t),p=o.uuids?o.uuids[e]:null,a=i({paintStyle:c,hoverPaintStyle:l,endpoint:v,connections:[u],uuid:p,anchor:y,source:s,scope:o.scope,reattach:o.reattach||t.Defaults.ReattachConnections,detachable:o.detachable||t.Defaults.ConnectionsDetachable}),u.endpoints[e]=a,o.drawEndpoints===!1&&a.setVisible(!1,!0,!0)),a}})}.call(this),function(){"use strict";var u=this,n=u.jsPlumbUtil,t=u.jsPlumb,f,i,r;t.AnchorManager=function(i){var f={},l={},s={},y={},b={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},o=["left","top","right","bottom"],r={},h=this,u={},e=i.jsPlumbInstance,v={},k=function(n,t,i,r,u,f){var s,h;if(n===t)return{orientation:b.IDENTITY,a:["top","top"]};var y=Math.atan2(r.centery-i.centery,r.centerx-i.centerx),p=Math.atan2(i.centery-r.centery,i.centerx-r.centerx),e=[],l={};for(!function(n,t){for(var i=0;i<n.length;i++)l[n[i]]={left:[t[i].left,t[i].centery],right:[t[i].right,t[i].centery],top:[t[i].centerx,t[i].top],bottom:[t[i].centerx,t[i].bottom]}}(["source","target"],[i,r]),s=0;s<o.length;s++)for(h=0;h<o.length;h++)s!=h&&e.push({source:o[s],target:o[h],dist:Biltong.lineLength(l.source[o[s]],l.target[o[h]])});e.sort(function(n,t){return n.dist<t.dist?-1:n.dist>t.dist?1:0});for(var a=e[0].source,v=e[0].target,c=0;c<e.length&&(a=!u.isContinuous||u.isEdgeSupported(e[c].source)?e[c].source:null,v=!f.isContinuous||f.isEdgeSupported(e[c].target)?e[c].target:null,null==a||null==v);c++);return{a:[a,v],theta:y,theta2:p}},d=function(n,t,i,r,u,f,e){for(var s,h,c=[],v=t[u?0:1]/(r.length+1),o=0;o<r.length;o++){s=(o+1)*v;h=f*t[u?1:0];e&&(s=t[u?0:1]-s);var l=u?s:h,y=i[0]+l,p=l/t[0],a=u?h:s,w=i[1]+a,b=a/t[1];c.push([y,w,p,b,r[o][1],r[o][2]])}return c},p=function(n){return function(t,i){var r=!0;return r=n?t[0][0]<i[0][0]:t[0][0]>i[0][0],r===!1?-1:1}},g=function(n,t){var i=n[0][0]<0?-Math.PI-n[0][0]:Math.PI-n[0][0],r=t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0];return i>r?1:n[0][1]>t[0][1]?1:-1},nt={top:function(n,t){return n[0]>t[0]?1:-1},right:p(!0),bottom:p(!0),left:g},tt=function(n,t){return n.sort(t)},it=function(n,t){var f=e.getCachedData(n),r=f.s,i=f.o,u=function(t,i,r,u,f,e,o){if(u.length>0)for(var v=tt(u,nt[t]),p="right"===t||"top"===t,h=d(t,i,r,v,f,e,p),a=function(n,t){l[n.id]=[t[0],t[1],t[2],t[3]];y[n.id]=o},s=0;s<h.length;s++){var c=h[s][4],w=c.endpoints[0].elementId===n,b=c.endpoints[1].elementId===n;w?a(c.endpoints[0],h[s]):b&&a(c.endpoints[1],h[s])}};u("bottom",r,[i.left,i.top],t.bottom,!0,1,[0,1]);u("top",r,[i.left,i.top],t.top,!0,0,[0,-1]);u("left",r,[i.left,i.top],t.left,!1,0,[-1,0]);u("right",r,[i.left,i.top],t.right,!1,1,[1,0])},a,c,w;this.reset=function(){f={};r={};u={}};this.addFloatingConnection=function(n,t){v[n]=t};this.removeFloatingConnection=function(n){delete v[n]};this.newConnection=function(i){var f=i.sourceId,e=i.targetId,u=i.endpoints,o=!0,s=function(s,h,c,l,a){f==e&&c.isContinuous&&(i._jsPlumb.instance.removeElement(u[1].canvas),o=!1);n.addToList(r,l,[a,h,c.constructor==t.DynamicAnchor])};s(0,u[0],u[0].anchor,e,i);o&&s(1,u[1],u[1].anchor,f,i)};a=function(t){!function(t,i){if(t){var r=function(n){return n[4]==i};n.removeWithFunction(t.top,r);n.removeWithFunction(t.left,r);n.removeWithFunction(t.bottom,r);n.removeWithFunction(t.right,r)}}(u[t.elementId],t.id)};this.connectionDetached=function(i){var u=i.connection||i,o=i.sourceId,s=i.targetId,f=u.endpoints,e=function(i,u,f,e,o){null!=f&&f.constructor==t.FloatingAnchor||n.removeWithFunction(r[e],function(n){return n[0].id==o.id})};e(1,f[1],f[1].anchor,o,u);e(0,f[0],f[0].anchor,s,u);a(u.endpoints[0]);a(u.endpoints[1]);h.redraw(u.sourceId);h.redraw(u.targetId)};this.add=function(t,i){n.addToList(f,i,t)};this.changeId=function(n,t){r[t]=r[n];f[t]=f[n];delete r[n];delete f[n]};this.getConnectionsFor=function(n){return r[n]||[]};this.getEndpointsFor=function(n){return f[n]||[]};this.deleteEndpoint=function(t){n.removeWithFunction(f[t.elementId],function(n){return n.id==t.id});a(t)};this.clearFor=function(n){delete f[n];f[n]=[]};c=function(t,r,u,f,e,o,s,h,c,l,a,v){var y,p,tt=-1,k=-1,d=f.endpoints[s],it=d.id,g=[1,0][s],rt=[[r,u],f,e,o,it],w=t[c],b=d._continuousAnchorEdge?t[d._continuousAnchorEdge]:null,nt,ut;if(b&&(nt=n.findWithFunction(b,function(n){return n[4]==it}),-1!=nt))for(b.splice(nt,1),y=0;y<b.length;y++)p=b[y][1],n.addWithFunction(a,p,function(n){return n.id==p.id}),n.addWithFunction(v,b[y][1].endpoints[s],function(n){return n.id==p.endpoints[s].id}),n.addWithFunction(v,b[y][1].endpoints[g],function(n){return n.id==p.endpoints[g].id});for(y=0;y<w.length;y++)p=w[y][1],1==i.idx&&w[y][3]===o&&-1==k&&(k=y),n.addWithFunction(a,p,function(n){return n.id==p.id}),n.addWithFunction(v,w[y][1].endpoints[s],function(n){return n.id==p.endpoints[s].id}),n.addWithFunction(v,w[y][1].endpoints[g],function(n){return n.id==p.endpoints[g].id});-1!=tt?w[tt]=rt:(ut=h?-1!=k?k:0:w.length,w.splice(ut,0,rt));d._continuousAnchorEdge=c};this.updateOtherEndpoint=function(i,u,f,e){var o=n.findWithFunction(r[i],function(n){return n[0].id===e.id}),s=n.findWithFunction(r[u],function(n){return n[0].id===e.id});-1!=o&&(r[i][o][0]=e,r[i][o][1]=e.endpoints[1],r[i][o][2]=e.endpoints[1].anchor.constructor==t.DynamicAnchor);s>-1&&(r[u].splice(s,1),n.addToList(r,f,[e,e.endpoints[0],e.endpoints[0].anchor.constructor==t.DynamicAnchor]));e.updateConnectedClass()};this.sourceChanged=function(i,u,f){if(i!==u){n.removeWithFunction(r[i],function(n){return n[0].id===f.id});var e=n.findWithFunction(r[f.targetId],function(n){return n[0].id===f.id});e>-1&&(r[f.targetId][e][0]=f,r[f.targetId][e][1]=f.endpoints[0],r[f.targetId][e][2]=f.endpoints[0].anchor.constructor==t.DynamicAnchor);n.addToList(r,u,[f,f.endpoints[1],f.endpoints[1].anchor.constructor==t.DynamicAnchor]);f.updateConnectedClass()}};this.rehomeEndpoint=function(t,i,r){var s=f[i]||[],c=e.getId(r),o,l,u;for(c!==i&&(o=n.indexOf(s,t),o>-1&&(l=s.splice(o,1)[0],h.add(l,c))),u=0;u<t.connections.length;u++)t.connections[u].sourceId==i?(t.connections[u].sourceId=t.elementId,t.connections[u].source=t.element,h.sourceChanged(i,t.elementId,t.connections[u])):t.connections[u].targetId==i&&(t.connections[u].targetId=t.elementId,t.connections[u].target=t.element,h.updateOtherEndpoint(t.connections[u].sourceId,i,t.elementId,t.connections[u]))};this.redraw=function(i,o,s,h,l,a){var pt,wt,ct,rt,st,lt;if(!e.isSuspendDrawing()){var nt=f[i]||[],g=r[i]||[],d=[],tt=[],ft=[];s=s||e.timestamp();h=h||{left:0,top:0};o&&(o={left:o.left+h.left,top:o.top+h.top});for(var at=e.updateOffset({elId:i,offset:o,recalc:!1,timestamp:s}),vt={},y=0;y<g.length;y++){var w=g[y][0],p=w.sourceId,b=w.targetId,et=w.endpoints[0].anchor.isContinuous,ot=w.endpoints[1].anchor.isContinuous;if(et||ot){var yt=p+"_"+b,ut=vt[yt],ht=w.sourceId==i?1:0;et&&!u[p]&&(u[p]={top:[],right:[],bottom:[],left:[]});ot&&!u[b]&&(u[b]={top:[],right:[],bottom:[],left:[]});i!=b&&e.updateOffset({elId:b,timestamp:s});i!=p&&e.updateOffset({elId:p,timestamp:s});pt=e.getCachedData(b);wt=e.getCachedData(p);b==p&&(et||ot)?c(u[p],-Math.PI/2,0,w,!1,b,0,!1,"top",p,d,tt):(ut||(ut=k(p,b,wt.o,pt.o,w.endpoints[0].anchor,w.endpoints[1].anchor),vt[yt]=ut),et&&c(u[p],ut.theta,0,w,!1,b,0,!1,ut.a[0],p,d,tt),ot&&c(u[b],ut.theta2,-1,w,!0,p,1,!0,ut.a[1],b,d,tt));et&&n.addWithFunction(ft,p,function(n){return n===p});ot&&n.addWithFunction(ft,b,function(n){return n===b});n.addWithFunction(d,w,function(n){return n.id==w.id});(et&&0===ht||ot&&1===ht)&&n.addWithFunction(tt,w.endpoints[ht],function(n){return n.id==w.endpoints[ht].id})}}for(y=0;y<nt.length;y++)0===nt[y].connections.length&&nt[y].anchor.isContinuous&&(u[i]||(u[i]={top:[],right:[],bottom:[],left:[]}),c(u[i],-Math.PI/2,0,{endpoints:[nt[y],nt[y]],paint:function(){}},!1,i,0,!1,nt[y].anchor.getDefaultFace(),i,d,tt),n.addWithFunction(ft,i,function(n){return n===i}));for(y=0;y<ft.length;y++)it(ft[y],u[ft[y]]);for(y=0;y<nt.length;y++)nt[y].paint({timestamp:s,offset:at,dimensions:at.s,recalc:a!==!0});for(y=0;y<tt.length;y++)ct=e.getCachedData(tt[y].elementId),tt[y].paint({timestamp:s,offset:ct,dimensions:ct.s});for(y=0;y<g.length;y++)if(rt=g[y][1],rt.anchor.constructor==t.DynamicAnchor)for(rt.paint({elementWithPrecedence:i,timestamp:s}),n.addWithFunction(d,g[y][0],function(n){return n.id==g[y][0].id}),st=0;st<rt.connections.length;st++)rt.connections[st]!==g[y][0]&&n.addWithFunction(d,rt.connections[st],function(n){return n.id==rt.connections[st].id});else rt.anchor.constructor==t.Anchor&&n.addWithFunction(d,g[y][0],function(n){return n.id==g[y][0].id});for(lt=v[i],lt&&lt.paint({timestamp:s,recalc:!1,elId:i}),y=0;y<d.length;y++)d[y].paint({elId:i,timestamp:s,recalc:!1,clearEdits:l})}};w=function(t){n.EventGenerator.apply(this);this.type="Continuous";this.isDynamic=!0;this.isContinuous=!0;for(var r=t.faces||["top","right","bottom","left"],f=!(t.clockwise===!1),i={},e={top:"bottom",right:"left",left:"right",bottom:"top"},o={top:"right",right:"bottom",left:"top",bottom:"left"},h={top:"left",right:"top",left:"bottom",bottom:"right"},c=f?o:h,a=f?h:o,v=t.cssClass||"",u=0;u<r.length;u++)i[r[u]]=!0;this.getDefaultFace=function(){return 0===r.length?"top":r[0]};this.verifyEdge=function(n){return i[n]?n:i[e[n]]?e[n]:i[c[n]]?c[n]:i[a[n]]?a[n]:n};this.isEdgeSupported=function(n){return i[n]===!0};this.compute=function(n){return s[n.element.id]||l[n.element.id]||[0,0]};this.getCurrentLocation=function(n){return s[n.element.id]||l[n.element.id]||[0,0]};this.getOrientation=function(n){return y[n.id]||[0,0]};this.clearUserDefinedLocation=function(){delete s[t.elementId]};this.setUserDefinedLocation=function(n){s[t.elementId]=n};this.getCssClass=function(){return v}};e.continuousAnchorFactory={get:function(n){return new w(n)},clear:function(n){delete s[n];delete l[n]}}};t.Anchor=function(t){this.x=t.x||0;this.y=t.y||0;this.elementId=t.elementId;this.cssClass=t.cssClass||"";this.userDefinedLocation=null;this.orientation=t.orientation||[0,0];this.lastReturnValue=null;this.offsets=t.offsets||[0,0];this.timestamp=null;n.EventGenerator.apply(this);this.compute=function(n){var i=n.xy,r=n.wh,t=n.timestamp;return n.clearUserDefinedLocation&&(this.userDefinedLocation=null),t&&t===self.timestamp?this.lastReturnValue:(this.lastReturnValue=null!=this.userDefinedLocation?this.userDefinedLocation:[i[0]+this.x*r[0]+this.offsets[0],i[1]+this.y*r[1]+this.offsets[1]],this.timestamp=t,this.lastReturnValue)};this.getCurrentLocation=function(n){return null==this.lastReturnValue||null!=n.timestamp&&this.timestamp!=n.timestamp?this.compute(n):this.lastReturnValue}};n.extend(t.Anchor,n.EventGenerator,{equals:function(n){if(!n)return!1;var t=n.getOrientation(),i=this.getOrientation();return this.x==n.x&&this.y==n.y&&this.offsets[0]==n.offsets[0]&&this.offsets[1]==n.offsets[1]&&i[0]==t[0]&&i[1]==t[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(n){this.userDefinedLocation=n},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}});t.FloatingAnchor=function(n){t.Anchor.apply(this,arguments);var f=n.reference,e=n.referenceCanvas,u=t.getSize(e),o=0,s=0,i=null,r=null;this.orientation=null;this.x=0;this.y=0;this.isFloating=!0;this.compute=function(n){var t=n.xy,i=[t[0]+u[0]/2,t[1]+u[1]/2];return r=i,i};this.getOrientation=function(n){if(i)return i;var t=f.getOrientation(n);return[-1*Math.abs(t[0])*o,-1*Math.abs(t[1])*s]};this.over=function(n,t){i=n.getOrientation(t)};this.out=function(){i=null};this.getCurrentLocation=function(n){return null==r?this.compute(n):r}};n.extend(t.FloatingAnchor,t.Anchor);f=function(n,i,r){return n.constructor==t.Anchor?n:i.makeAnchor(n,r,i)};t.DynamicAnchor=function(n){var r;for(t.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=n.elementId,this.jsPlumbInstance=n.jsPlumbInstance,r=0;r<n.anchors.length;r++)this.anchors[r]=f(n.anchors[r],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors};this.locked=!1;var i=this.anchors.length>0?this.anchors[0]:null,u=i,e=this,o=function(n,t,i,r,u){var f=r[0]+n.x*u[0],e=r[1]+n.y*u[1],o=r[0]+u[0]/2,s=r[1]+u[1]/2;return Math.sqrt(Math.pow(t-f,2)+Math.pow(i-e,2))+Math.sqrt(Math.pow(o-f,2)+Math.pow(s-e,2))},s=n.selector||function(n,t,i,r,u){for(var e,c=i[0]+r[0]/2,l=i[1]+r[1]/2,s=-1,h=1/0,f=0;f<u.length;f++)e=o(u[f],c,l,n,t),h>e&&(s=f+0,h=e);return u[s]};this.compute=function(n){var o=n.xy,h=n.wh,r=n.txy,f=n.twh,t;return this.timestamp=n.timestamp,t=e.getUserDefinedLocation(),null!=t?t:this.locked||null==r||null==f?i.compute(n):(n.timestamp=null,i=s(o,h,r,f,this.anchors),this.x=i.x,this.y=i.y,i!=u&&this.fire("anchorChanged",i),u=i,i.compute(n))};this.getCurrentLocation=function(n){return this.getUserDefinedLocation()||(null!=i?i.getCurrentLocation(n):null)};this.getOrientation=function(n){return null!=i?i.getOrientation(n):[0,0]};this.over=function(n,t){null!=i&&i.over(n,t)};this.out=function(){null!=i&&i.out()};this.getCssClass=function(){return i&&i.getCssClass()||""}};n.extend(t.DynamicAnchor,t.Anchor);i=function(n,i,r,u,f,e){t.Anchors[f]=function(t){var o=t.jsPlumbInstance.makeAnchor([n,i,r,u,0,0],t.elementId,t.jsPlumbInstance);return o.type=f,e&&e(o,t),o}};i(.5,0,0,-1,"TopCenter");i(.5,1,0,1,"BottomCenter");i(0,.5,-1,0,"LeftMiddle");i(1,.5,1,0,"RightMiddle");i(.5,0,0,-1,"Top");i(.5,1,0,1,"Bottom");i(0,.5,-1,0,"Left");i(1,.5,1,0,"Right");i(.5,.5,0,0,"Center");i(1,0,0,-1,"TopRight");i(1,1,0,1,"BottomRight");i(0,0,0,-1,"TopLeft");i(0,1,0,1,"BottomLeft");t.Defaults.DynamicAnchors=function(n){return n.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],n.elementId,n.jsPlumbInstance)};t.Anchors.AutoDefault=function(n){var i=n.jsPlumbInstance.makeDynamicAnchor(t.Defaults.DynamicAnchors(n));return i.type="AutoDefault",i};r=function(n,i){t.Anchors[n]=function(t){var r=t.jsPlumbInstance.makeAnchor(["Continuous",{faces:i}],t.elementId,t.jsPlumbInstance);return r.type=n,r}};t.Anchors.Continuous=function(n){return n.jsPlumbInstance.continuousAnchorFactory.get(n)};r("ContinuousLeft",["left"]);r("ContinuousTop",["top"]);r("ContinuousBottom",["bottom"]);r("ContinuousRight",["right"]);i(0,0,0,0,"Assign",function(n,t){var i=t.position||"Fixed";n.positionFinder=i.constructor==String?t.jsPlumbInstance.AnchorPositionFinders[i]:i;n.constructorParams=t});jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(n,t,i){return[(n.left-t.left)/i[0],(n.top-t.top)/i[1]]},Grid:function(n,t,i,r){var e=n.left-t.left,o=n.top-t.top,u=i[0]/r.grid[0],f=i[1]/r.grid[1],s=Math.floor(e/u),h=Math.floor(o/f);return[(s*u+u/2)/i[0],(h*f+f/2)/i[1]]}};t.Anchors.Perimeter=function(n){var t,i,r,f;if(n=n||{},t=n.anchorCount||60,i=n.shape,!i)throw new Error("no shape supplied to Perimeter Anchor type");var e=function(){for(var f,e,n=.5,o=2*Math.PI/t,i=0,r=[],u=0;t>u;u++)f=n+n*Math.sin(i),e=n+n*Math.cos(i),r.push([f,e,0,0]),i+=o;return r},o=function(n){for(var i=t/n.length,u=[],f=function(n,r,f,e,o){i=t*o;for(var h=(f-n)/i,c=(e-r)/i,s=0;i>s;s++)u.push([n+h*s,r+c*s,0,0])},r=0;r<n.length;r++)f.apply(null,n[r]);return u},u=function(n){for(var i=[],t=0;t<n.length;t++)i.push([n[t][0],n[t][1],n[t][2],n[t][3],1/n.length]);return o(i)},s=function(){return u([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},h={Circle:e,Ellipse:e,Diamond:function(){return u([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:s,Square:s,Triangle:function(){return u([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(n){for(var f,u,i=n.points,r=[],e=0,t=0;t<i.length-1;t++)f=Math.sqrt(Math.pow(i[t][2]-i[t][0])+Math.pow(i[t][3]-i[t][1])),e+=f,r.push([i[t][0],i[t][1],i[t+1][0],i[t+1][1],f]);for(u=0;u<r.length;u++)r[u][4]=r[u][4]/e;return o(r)}},c=function(n,t){for(var u,f,e=[],r=t/180*Math.PI,i=0;i<n.length;i++)u=n[i][0]-.5,f=n[i][1]-.5,e.push([.5+(u*Math.cos(r)-f*Math.sin(r)),.5+(u*Math.sin(r)+f*Math.cos(r)),n[i][2],n[i][3]]);return e};if(!h[i])throw new Error("Shape ["+i+"] is unknown by Perimeter Anchor type");return r=h[i](n),n.rotation&&(r=c(r,n.rotation)),f=n.jsPlumbInstance.makeDynamicAnchor(r),f.type="Perimeter",f}}.call(this),function(){"use strict";var r=this,n=r.jsPlumb,t=r.jsPlumbUtil,i=r.Biltong,e,h,f,u,s,o;n.Segments={AbstractSegment:function(n){this.params=n;this.findClosestPointOnPath=function(){return{d:1/0,x:null,y:null,l:null}};this.getBounds=function(){return{minX:Math.min(n.x1,n.x2),minY:Math.min(n.y1,n.y2),maxX:Math.max(n.x1,n.x2),maxY:Math.max(n.y1,n.y2)}}},Straight:function(t){var s,o,l,r,f,u,e,a=(n.Segments.AbstractSegment.apply(this,arguments),function(){s=Math.sqrt(Math.pow(f-r,2)+Math.pow(e-u,2));o=i.gradient({x:r,y:u},{x:f,y:e});l=-1/o}),h,c;this.type="Straight";this.getLength=function(){return s};this.getGradient=function(){return o};this.getCoordinates=function(){return{x1:r,y1:u,x2:f,y2:e}};this.setCoordinates=function(n){r=n.x1;u=n.y1;f=n.x2;e=n.y2;a()};this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2});this.getBounds=function(){return{minX:Math.min(r,f),minY:Math.min(u,e),maxX:Math.max(r,f),maxY:Math.max(u,e)}};this.pointOnPath=function(n,t){if(0!==n||t){if(1!=n||t){var o=t?n>0?n:s+n:n*s;return i.pointOnLine({x:r,y:u},{x:f,y:e},o)}return{x:f,y:e}}return{x:r,y:u}};this.gradientAtPoint=function(){return o};this.pointAlongPathFrom=function(n,t,o){var s=this.pointOnPath(n,o),h=0>=t?{x:r,y:u}:{x:f,y:e};return 0>=t&&Math.abs(t)>1&&(t*=-1),i.pointOnLine(s,h,t)};h=function(n,t,i){return i>=Math.min(n,t)&&i<=Math.max(n,t)};c=function(n,t,i){return Math.abs(i-n)<Math.abs(i-t)?n:t};this.findClosestPointOnPath=function(n,t){var a={d:1/0,x:null,y:null,l:null,x1:r,x2:f,y1:u,y2:e},w;if(0===o)a.y=u,a.x=h(r,f,n)?n:c(r,f,n);else if(1/0==o||o==-1/0)a.x=r,a.y=h(u,e,t)?t:c(u,e,t);else{var p=u-o*r,b=t-l*n,v=(b-p)/(o-l),y=o*v+p;a.x=h(r,f,v)?v:c(r,f,v);a.y=h(u,e,y)?y:c(u,e,y)}return w=i.lineLength([a.x,a.y],[r,u]),a.d=i.lineLength([n,t],[a.x,a.y]),a.l=w/s,a}},Arc:function(t){var e=(n.Segments.AbstractSegment.apply(this,arguments),function(n,r){return i.theta([t.cx,t.cy],[n,r])}),c=function(n,t){var i,u,f,e;return n.anticlockwise?(i=n.startAngle<n.endAngle?n.startAngle+r:n.startAngle,u=Math.abs(i-n.endAngle),i-u*t):(f=n.endAngle<n.startAngle?n.endAngle+r:n.endAngle,e=Math.abs(f-n.startAngle),n.startAngle+e*t)},r=2*Math.PI,o,u,f;this.radius=t.r;this.anticlockwise=t.ac;this.type="Arc";t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=e(t.x1,t.y1),this.endAngle=e(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2);this.endAngle<0&&(this.endAngle+=r);this.startAngle<0&&(this.startAngle+=r);this.segment=i.quadrant([this.x1,this.y1],[this.x2,this.y2]);o=this.endAngle<this.startAngle?this.endAngle+r:this.endAngle;this.sweep=Math.abs(o-this.startAngle);this.anticlockwise&&(this.sweep=r-this.sweep);var s=2*Math.PI*this.radius,l=this.sweep/r,h=s*l;this.getLength=function(){return h};this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};u=1e-10;f=function(n){var t=Math.floor(n),i=Math.ceil(n);return u>n-t?t:u>i-n?i:n};this.pointOnPath=function(n,i){if(0===n)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1==n)return{x:this.x2,y:this.y2,theta:this.endAngle};i&&(n/=h);var r=c(this,n),u=t.cx+t.r*Math.cos(r),e=t.cy+t.r*Math.sin(r);return{x:f(u),y:f(e),theta:r}};this.gradientAtPoint=function(n,r){var f=this.pointOnPath(n,r),u=i.normal([t.cx,t.cy],[f.x,f.y]);return this.anticlockwise||1/0!=u&&u!=-1/0||(u*=-1),u};this.pointAlongPathFrom=function(n,i,r){var f=this.pointOnPath(n,r),e=2*(i/s)*Math.PI,o=this.anticlockwise?-1:1,u=f.theta+o*e,h=t.cx+this.radius*Math.cos(u),c=t.cy+this.radius*Math.sin(u);return{x:h,y:c}}},Bezier:function(t){this.curve=[{x:t.x1,y:t.y1},{x:t.cp1x,y:t.cp1y},{x:t.cp2x,y:t.cp2y},{x:t.x2,y:t.y2}];n.Segments.AbstractSegment.apply(this,arguments);this.bounds={minX:Math.min(t.x1,t.x2,t.cp1x,t.cp2x),minY:Math.min(t.y1,t.y2,t.cp1y,t.cp2y),maxX:Math.max(t.x1,t.x2,t.cp1x,t.cp2x),maxY:Math.max(t.y1,t.y2,t.cp1y,t.cp2y)};this.type="Bezier";var i=function(n,t,i){return i&&(t=r.jsBezier.locationAlongCurveFrom(n,t>0?0:1,t)),t};this.pointOnPath=function(n,t){return n=i(this.curve,n,t),r.jsBezier.pointOnCurve(this.curve,n)};this.gradientAtPoint=function(n,t){return n=i(this.curve,n,t),r.jsBezier.gradientAtPoint(this.curve,n)};this.pointAlongPathFrom=function(n,t,u){return n=i(this.curve,n,u),r.jsBezier.pointAlongCurveFrom(this.curve,n,t)};this.getLength=function(){return r.jsBezier.getLength(this.curve)};this.getBounds=function(){return this.bounds}}};e=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}};this.resetBounds()};n.Connectors.AbstractConnector=function(r){var b;e.apply(this,arguments);var f=[],u=0,s=[],p=[],h=r.stub||0,c=t.isArray(h)?h[0]:h,l=t.isArray(h)?h[1]:h,a=r.gap||0,v=t.isArray(a)?a[0]:a,y=t.isArray(a)?a[1]:a,k=null,d=!1,o=null;this.getPath=function(){};this.setPath=function(){};this.findSegmentForPoint=function(n,t){for(var r,i={d:1/0,s:null,x:null,y:null,l:null},u=0;u<f.length;u++)r=f[u].findClosestPointOnPath(n,t),r.d<i.d&&(i.d=r.d,i.l=r.l,i.x=r.x,i.y=r.y,i.s=f[u],i.x1=r.x1,i.x2=r.x2,i.y1=r.y1,i.y2=r.y2,i.index=u);return i};var g=function(){for(var i,t=0,n=0;n<f.length;n++)i=f[n].getLength(),p[n]=i/u,s[n]=[t,t+=i/u]},w=function(n,t){t&&(n=n>0?n/u:(u+n)/u);for(var r=s.length-1,e=1,i=0;i<s.length;i++)if(s[i][1]>=n){r=i;e=1==n?1:0===n?0:(n-s[i][0])/p[i];break}return{segment:f[r],proportion:e,index:r}},nt=function(t,i,r){if(r.x1!=r.x2||r.y1!=r.y2){var e=new n.Segments[i](r);f.push(e);u+=e.getLength();t.updateBounds(e)}},tt=function(){u=f.length=s.length=p.length=0};return this.setSegments=function(n){k=[];u=0;for(var t=0;t<n.length;t++)k.push(n[t]),u+=n[t].getLength()},this.getLength=function(){return u},b=function(n){var u,k;this.lineWidth=n.lineWidth;var tt=i.quadrant(n.sourcePos,n.targetPos),w=n.targetPos[0]<n.sourcePos[0],b=n.targetPos[1]<n.sourcePos[1],it=n.lineWidth||1,t=n.sourceEndpoint.anchor.getOrientation(n.sourceEndpoint),r=n.targetEndpoint.anchor.getOrientation(n.targetEndpoint),g=w?n.targetPos[0]:n.sourcePos[0],nt=b?n.targetPos[1]:n.sourcePos[1],h=Math.abs(n.targetPos[0]-n.sourcePos[0]),a=Math.abs(n.targetPos[1]-n.sourcePos[1]);(0===t[0]&&0===t[1]||0===r[0]&&0===r[1])&&(u=h>a?0:1,k=[1,0][u],t=[],r=[],t[u]=n.sourcePos[u]>n.targetPos[u]?-1:1,r[u]=n.sourcePos[u]>n.targetPos[u]?1:-1,t[k]=0,r[k]=0);var f=w?h+v*t[0]:v*t[0],e=b?a+v*t[1]:v*t[1],o=w?y*r[0]:h+y*r[0],s=b?y*r[1]:a+y*r[1],d=t[0]*r[0]+t[1]*r[1],p={sx:f,sy:e,tx:o,ty:s,lw:it,xSpan:Math.abs(o-f),ySpan:Math.abs(s-e),mx:(f+o)/2,my:(e+s)/2,so:t,to:r,x:g,y:nt,w:h,h:a,segment:tt,startStubX:f+t[0]*c,startStubY:e+t[1]*c,endStubX:o+r[0]*l,endStubY:s+r[1]*l,isXGreaterThanStubTimes2:Math.abs(f-o)>c+l,isYGreaterThanStubTimes2:Math.abs(e-s)>c+l,opposite:-1==d,perpendicular:0===d,orthogonal:1==d,sourceAxis:0===t[0]?"y":"x",points:[g,nt,h,a,f,e,o,s]};return p.anchorOrientation=p.opposite?"opposite":p.orthogonal?"orthogonal":"perpendicular",p},this.getSegments=function(){return f},this.updateBounds=function(n){var t=n.getBounds();this.bounds.minX=Math.min(this.bounds.minX,t.minX);this.bounds.maxX=Math.max(this.bounds.maxX,t.maxX);this.bounds.minY=Math.min(this.bounds.minY,t.minY);this.bounds.maxY=Math.max(this.bounds.maxY,t.maxY)},this.pointOnPath=function(n,t){var i=w(n,t);return i.segment&&i.segment.pointOnPath(i.proportion,!1)||[0,0]},this.gradientAtPoint=function(n,t){var i=w(n,t);return i.segment&&i.segment.gradientAtPoint(i.proportion,!1)||0},this.pointAlongPathFrom=function(n,t,i){var r=w(n,i);return r.segment&&r.segment.pointAlongPathFrom(r.proportion,t,!1)||[0,0]},this.compute=function(n){d||(o=b.call(this,n));tt();this._compute(o,n);this.x=o.points[0];this.y=o.points[1];this.w=o.points[2];this.h=o.points[3];this.segment=o.segment;g()},{addSegment:nt,prepareCompute:b,sourceStub:c,targetStub:l,maxStub:Math.max(c,l),sourceGap:v,targetGap:y,maxGap:Math.max(v,y)}};t.extend(n.Connectors.AbstractConnector,e);h=n.Connectors.Straight=function(){this.type="Straight";var t=n.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(n){t.addSegment(this,"Straight",{x1:n.sx,y1:n.sy,x2:n.startStubX,y2:n.startStubY});t.addSegment(this,"Straight",{x1:n.startStubX,y1:n.startStubY,x2:n.endStubX,y2:n.endStubY});t.addSegment(this,"Straight",{x1:n.endStubX,y1:n.endStubY,x2:n.tx,y2:n.ty})}};t.extend(n.Connectors.Straight,n.Connectors.AbstractConnector);n.registerConnectorType(h,"Straight");n.Endpoints.AbstractEndpoint=function(n){e.apply(this,arguments);var t=this.compute=function(){var n=this._compute.apply(this,arguments);return this.x=n[0],this.y=n[1],this.w=n[2],this.h=n[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,n};return{compute:t,cssClass:n.cssClass}};t.extend(n.Endpoints.AbstractEndpoint,e);n.Endpoints.Dot=function(t){this.type="Dot";n.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{};this.radius=t.radius||10;this.defaultOffset=.5*this.radius;this.defaultInnerRadius=this.radius/3;this._compute=function(n,t,i){var r;this.radius=i.radius||this.radius;var u=n[0]-this.radius,f=n[1]-this.radius,e=2*this.radius,o=2*this.radius;return i.strokeStyle&&(r=i.lineWidth||1,u-=r,f-=r,e+=2*r,o+=2*r),[u,f,e,o,this.radius]}};t.extend(n.Endpoints.Dot,n.Endpoints.AbstractEndpoint);n.Endpoints.Rectangle=function(t){this.type="Rectangle";n.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{};this.width=t.width||20;this.height=t.height||20;this._compute=function(n,t,i){var r=i.width||this.width,u=i.height||this.height,f=n[0]-r/2,e=n[1]-u/2;return[f,e,r,u]}};t.extend(n.Endpoints.Rectangle,n.Endpoints.AbstractEndpoint);f=function(){n.jsPlumbUIComponent.apply(this,arguments);this._jsPlumb.displayElements=[]};t.extend(f,n.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(n){this._jsPlumb.displayElements.push(n)}});n.Endpoints.Image=function(i){this.type="Image";f.apply(this,arguments);n.Endpoints.AbstractEndpoint.apply(this,arguments);var u=i.onload,e=i.src||i.url,o=i.cssClass?" "+i.cssClass:"";this._jsPlumb.img=new Image;this._jsPlumb.ready=!1;this._jsPlumb.initialized=!1;this._jsPlumb.deleted=!1;this._jsPlumb.widthToUse=i.width;this._jsPlumb.heightToUse=i.height;this._jsPlumb.endpoint=i.endpoint;this._jsPlumb.img.onload=function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,u&&u(this))}.bind(this);this._jsPlumb.endpoint.setImage=function(n,t){var i=n.constructor==String?n:n.src;u=t;this._jsPlumb.img.src=i;null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this);this._jsPlumb.endpoint.setImage(e,u);this._compute=function(n){return this.anchorPoint=n,this._jsPlumb.ready?[n[0]-this._jsPlumb.widthToUse/2,n[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]};this.canvas=jsPlumb.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+o);this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse);this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse);this._jsPlumb.instance.appendElement(this.canvas);this.actuallyPaint=function(){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var n=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,i=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;t.sizeElement(this.canvas,n,i,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}};this.paint=function(n,t){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(n,t):r.setTimeout(function(){this.paint(n,t)}.bind(this),200))}};t.extend(n.Endpoints.Image,[f,n.Endpoints.AbstractEndpoint],{cleanup:function(n){n&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}});n.Endpoints.Blank=function(i){n.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank";f.apply(this,arguments);this._compute=function(n){return[n[0],n[1],10,0]};var r=i.cssClass?" "+i.cssClass:"";this.canvas=jsPlumb.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+r);this._jsPlumb.instance.appendElement(this.canvas);this.paint=function(){t.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}};t.extend(n.Endpoints.Blank,[n.Endpoints.AbstractEndpoint,f],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}});n.Endpoints.Triangle=function(t){this.type="Triangle";n.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{};t.width=t.width||55;t.height=t.height||55;this.width=t.width;this.height=t.height;this._compute=function(n,t,i){var r=i.width||self.width,u=i.height||self.height,f=n[0]-r/2,e=n[1]-u/2;return[f,e,r,u]}};u=n.Overlays.AbstractOverlay=function(n){this.visible=!0;this.isAppendedAtTopLevel=!0;this.component=n.component;this.loc=null==n.location?.5:n.location;this.endpointLoc=null==n.endpointLocation?[.5,.5]:n.endpointLocation};u.prototype={cleanup:function(n){n&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(){},setVisible:function(n){this.visible=n;this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(n){this.loc+=n;this.component.repaint()},setLocation:function(n){this.loc=n;this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}};n.Overlays.Arrow=function(n){this.type="Arrow";u.apply(this,arguments);this.isAppendedAtTopLevel=!1;n=n||{};this.length=n.length||20;this.width=n.width||20;this.id=n.id;var r=(n.direction||1)<0?-1:1,f=n.paintStyle||{lineWidth:1},e=n.foldback||.623;this.computeMaxSize=function(){return 1.5*self.width};this.draw=function(n,u){var o,c,s,h,v,l,a,y,p;if(n.pointAlongPathFrom){t.isString(this.loc)||this.loc>1||this.loc<0?(l=parseInt(this.loc,10),a=this.loc<0?1:0,o=n.pointAlongPathFrom(a,l,!1),c=n.pointAlongPathFrom(a,l-r*this.length/2,!1),s=i.pointOnLine(o,c,this.length)):1==this.loc?(o=n.pointOnPath(this.loc),c=n.pointAlongPathFrom(this.loc,-this.length),s=i.pointOnLine(o,c,this.length),-1==r)&&(y=s,s=o,o=y):0===this.loc?(s=n.pointOnPath(this.loc),c=n.pointAlongPathFrom(this.loc,this.length),o=i.pointOnLine(s,c,this.length),-1==r)&&(p=s,s=o,o=p):(o=n.pointAlongPathFrom(this.loc,r*this.length/2),c=n.pointOnPath(this.loc),s=i.pointOnLine(o,c,this.length));h=i.perpendicularLineTo(o,s,this.width);v=i.pointOnLine(o,s,e*this.length);var w={hxy:o,tail:h,cxy:v},b=f.strokeStyle||u.strokeStyle,k=f.fillStyle||u.strokeStyle,d=f.lineWidth||u.lineWidth;return{component:n,d:w,lineWidth:d,strokeStyle:b,fillStyle:k,minX:Math.min(o.x,h[0].x,h[1].x),maxX:Math.max(o.x,h[0].x,h[1].x),minY:Math.min(o.y,h[0].y,h[1].y),maxY:Math.max(o.y,h[0].y,h[1].y)}}return{component:n,minX:0,maxX:0,minY:0,maxY:0}}};t.extend(n.Overlays.Arrow,u,{updateFrom:function(n){this.length=n.length||this.length;this.width=n.width||this.width;this.direction=null!=n.direction?n.direction:this.direction;this.foldback=n.foldback||this.foldback}});n.Overlays.PlainArrow=function(t){t=t||{};var i=n.extend(t,{foldback:1});n.Overlays.Arrow.call(this,i);this.type="PlainArrow"};t.extend(n.Overlays.PlainArrow,n.Overlays.Arrow);n.Overlays.Diamond=function(t){t=t||{};var i=t.length||40,r=jsPlumb.extend(t,{length:i/2,foldback:2});n.Overlays.Arrow.call(this,r);this.type="Diamond"};t.extend(n.Overlays.Diamond,n.Overlays.Arrow);s=function(n,t){return(null==n._jsPlumb.cachedDimensions||t)&&(n._jsPlumb.cachedDimensions=n.getDimensions()),n._jsPlumb.cachedDimensions};o=function(i){n.jsPlumbUIComponent.apply(this,arguments);u.apply(this,arguments);var r=this.fire;this.fire=function(){r.apply(this,arguments);this.component&&this.component.fire.apply(this.component,arguments)};this.detached=!1;this.id=i.id;this._jsPlumb.div=null;this._jsPlumb.initialised=!1;this._jsPlumb.component=i.component;this._jsPlumb.cachedDimensions=null;this._jsPlumb.create=i.create;this._jsPlumb.initiallyInvisible=i.visible===!1;this.getElement=function(){var n,t;return null==this._jsPlumb.div&&(n=this._jsPlumb.div=jsPlumb.getElement(this._jsPlumb.create(this._jsPlumb.component)),n.style.position="absolute",n.className=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:i.cssClass?i.cssClass:""),this._jsPlumb.instance.appendElement(n),this._jsPlumb.instance.getId(n),this.canvas=n,t="translate(-50%, -50%)",n.style.webkitTransform=t,n.style.mozTransform=t,n.style.msTransform=t,n.style.oTransform=t,n.style.transform=t,n._jsPlumb=this,i.visible===!1&&(n.style.display="none")),this._jsPlumb.div};this.draw=function(n,i,r){var u=s(this),f,h,c,l,e,o;return null!=u&&2==u.length?(f={x:0,y:0},r?f={x:r[0],y:r[1]}:n.pointOnPath?(h=this.loc,c=!1,(t.isString(this.loc)||this.loc<0||this.loc>1)&&(h=parseInt(this.loc,10),c=!0),f=n.pointOnPath(h,c)):(l=this.loc.constructor==Array?this.loc:this.endpointLoc,f={x:l[0]*n.w,y:l[1]*n.h}),e=f.x-u[0]/2,o=f.y-u[1]/2,{component:n,d:{minx:e,miny:o,td:u,cxy:f},minX:e,maxX:e+u[0],minY:o,maxY:o+u[1]}):{minX:0,maxX:0,minY:0,maxY:0}}};t.extend(o,[n.jsPlumbUIComponent,u],{getDimensions:function(){return t.oldIE?n.getSize(this.getElement()):[1,1]},setVisible:function(n){this._jsPlumb.div&&(this._jsPlumb.div.style.display=n?"block":"none",n&&this._jsPlumb.initiallyInvisible&&(s(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(n){n?null!=this._jsPlumb.div&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(n){null!=this._jsPlumb.div&&n.getContainer().appendChild(this._jsPlumb.div);this.detached=!1},computeMaxSize:function(){var n=s(this);return Math.max(n[0],n[1])},paint:function(n){this._jsPlumb.initialised||(this.getElement(),n.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div));this._jsPlumb.div.style.left=n.component.x+n.d.minx+"px";this._jsPlumb.div.style.top=n.component.y+n.d.miny+"px"}});n.Overlays.Custom=function(){this.type="Custom";o.apply(this,arguments)};t.extend(n.Overlays.Custom,o);n.Overlays.GuideLines=function(){var t=this;t.length=50;t.lineWidth=5;this.type="GuideLines";u.apply(this,arguments);n.jsPlumbUIComponent.apply(this,arguments);this.draw=function(n){var u=n.pointAlongPathFrom(t.loc,t.length/2),e=n.pointOnPath(t.loc),f=i.pointOnLine(u,e,t.length),o=i.perpendicularLineTo(u,f,40),r=i.perpendicularLineTo(f,u,20);return{connector:n,head:u,tail:f,headLine:r,tailLine:o,minX:Math.min(u.x,f.x,r[0].x,r[1].x),minY:Math.min(u.y,f.y,r[0].y,r[1].y),maxX:Math.max(u.x,f.x,r[0].x,r[1].x),maxY:Math.max(u.y,f.y,r[0].y,r[1].y)}}};n.Overlays.Label=function(t){var r,i,u;this.labelStyle=t.labelStyle;this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;r=n.extend({create:function(){return jsPlumb.createElement("div")}},t);(n.Overlays.Custom.call(this,r),this.type="Label",this.label=t.label||"",this.labelText=null,this.labelStyle)&&(i=this.getElement(),(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",i.style.font=this.labelStyle.font,i.style.color=this.labelStyle.color||"black",this.labelStyle.fillStyle&&(i.style.background=this.labelStyle.fillStyle),this.labelStyle.borderWidth>0)&&(u=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black",i.style.border=this.labelStyle.borderWidth+"px solid "+u),this.labelStyle.padding&&(i.style.padding=this.labelStyle.padding))};t.extend(n.Overlays.Label,n.Overlays.Custom,{cleanup:function(n){n&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(n){this.label=n;this.labelText=null;this.clearCachedDimensions();this.update();this.component.repaint()},getDimensions:function(){return this.update(),o.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var n=this.label(this);this.getElement().innerHTML=n.replace(/\r\n/g,"<br/>")}else null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(n){n.label&&this.setLabel(n.label)}})}.call(this),function(){"use strict";var n=this,t=n.jsPlumb,i=function(t){var i=t._mottle;return i||(i=t._mottle=new n.Mottle),i};t.extend(n.jsPlumbInstance.prototype,{getEventManager:function(){return i(this)},on:function(){this.getEventManager().on.apply(this,arguments)},off:function(){this.getEventManager().off.apply(this,arguments)}})}.call(this),function(){"use strict";var t=this,n=t.jsPlumb,r=t.jsPlumbUtil,i=function(t){this.type="Flowchart";t=t||{};t.stub=null==t.stub?30:t.stub;var i,y,u=n.Connectors.AbstractConnector.apply(this,arguments),h=null==t.midpoint?.5:t.midpoint,p=t.alwaysRespectStubs===!0,r=null,f=null,e=null,c=null!=t.cornerRadius?t.cornerRadius:0,o=function(n){return 0>n?-1:0===n?0:1},s=function(n,t,i,r){if(f!=t||e!=i){var u=null==f?r.sx:f,s=null==e?r.sy:e,h=u==t?"v":"h",c=o(t-u),l=o(i-s);f=t;e=i;n.push([u,s,t,i,h,c,l])}},l=function(n){return Math.sqrt(Math.pow(n[0]-n[2],2)+Math.pow(n[1]-n[3],2))},a=function(n){var t=[];return t.push.apply(t,n),t},v=function(n,t,i){for(var f,e,v,y,r=null,o=0;o<t.length-1;o++){if(r=r||a(t[o]),f=a(t[o+1]),c>0&&r[4]!=f[4]){e=Math.min(c,l(r),l(f));r[2]-=r[5]*e;r[3]-=r[6]*e;f[0]+=f[5]*e;f[1]+=f[6]*e;var s=r[6]==f[5]&&1==f[5]||r[6]==f[5]&&0===f[5]&&r[5]!=f[6]||r[6]==f[5]&&-1==f[5],p=f[1]>r[3]?1:-1,w=f[0]>r[2]?1:-1,h=p==w,b=h&&s||!h&&!s?f[0]:r[2],k=h&&s||!h&&!s?r[3]:f[1];u.addSegment(n,"Straight",{x1:r[0],y1:r[1],x2:r[2],y2:r[3]});u.addSegment(n,"Arc",{r:e,x1:r[2],y1:r[3],x2:f[0],y2:f[1],cx:b,cy:k,ac:s})}else v=r[2]==r[0]?0:r[2]>r[0]?i.lw/2:-(i.lw/2),y=r[3]==r[1]?0:r[3]>r[1]?i.lw/2:-(i.lw/2),u.addSegment(n,"Straight",{x1:r[0]-v,y1:r[1]-y,x2:r[2]+v,y2:r[3]+y});r=f}null!=f&&u.addSegment(n,"Straight",{x1:f[0],y1:f[1],x2:f[2],y2:f[3]})};this.setSegments=function(n){r=n};this.isEditable=function(){return!0};this.getOriginalSegments=function(){return r||i};this._compute=function(n,t){var w,b;if(t.clearEdits&&(r=null),null!=r)return v(this,r,n),void 0;i=[];f=null;e=null;y=null;var o=n.startStubX+(n.endStubX-n.startStubX)*h,c=n.startStubY+(n.endStubY-n.startStubY)*h,k={x:[0,1],y:[1,0]},d=function(){return[n.startStubX,n.startStubY,n.endStubX,n.endStubY]},nt={perpendicular:d,orthogonal:d,opposite:function(t){var i=n,r="x"==t?0:1,u={x:function(){return 1==i.so[r]&&(i.startStubX>i.endStubX&&i.tx>i.startStubX||i.sx>i.endStubX&&i.tx>i.sx)||-1==i.so[r]&&(i.startStubX<i.endStubX&&i.tx<i.startStubX||i.sx<i.endStubX&&i.tx<i.sx)},y:function(){return 1==i.so[r]&&(i.startStubY>i.endStubY&&i.ty>i.startStubY||i.sy>i.endStubY&&i.ty>i.sy)||-1==i.so[r]&&(i.startStubY<i.endStubY&&i.ty<i.startStubY||i.sy<i.endStubY&&i.ty<i.sy)}};return!p&&u[t]()?{x:[(n.sx+n.tx)/2,n.startStubY,(n.sx+n.tx)/2,n.endStubY],y:[n.startStubX,(n.sy+n.ty)/2,n.endStubX,(n.sy+n.ty)/2]}[t]:[n.startStubX,n.startStubY,n.endStubX,n.endStubY]}},tt={perpendicular:function(t){var i=n,h={x:[[i.startStubX,i.endStubX],null,[i.endStubX,i.startStubX]],y:[[i.startStubY,i.endStubY],null,[i.endStubY,i.startStubY]]},v={x:[[o,i.startStubY],[o,i.endStubY]],y:[[i.startStubX,c],[i.endStubX,c]]},y={x:[[i.endStubX,i.startStubY]],y:[[i.startStubX,i.endStubY]]},p={x:[[i.startStubX,i.endStubY],[i.endStubX,i.endStubY]],y:[[i.endStubX,i.startStubY],[i.endStubX,i.endStubY]]},w={x:[[i.startStubX,c],[i.endStubX,c],[i.endStubX,i.endStubY]],y:[[o,i.startStubY],[o,i.endStubY],[i.endStubX,i.endStubY]]},u={x:[i.startStubY,i.endStubY],y:[i.startStubX,i.endStubX]},b=k[t][0],f=k[t][1],e=i.so[b]+1,d=i.to[f]+1,s=-1==i.to[f]&&u[t][1]<u[t][0]||1==i.to[f]&&u[t][1]>u[t][0],l=h[t][e][0],a=h[t][e][1],r={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[t][e][d];return i.segment==r[3]||i.segment==r[2]&&s?v[t]:i.segment==r[2]&&l>a?y[t]:i.segment==r[2]&&a>=l||i.segment==r[1]&&!s?w[t]:i.segment==r[0]||i.segment==r[1]&&s?p[t]:void 0},orthogonal:function(t,i,r,u,f){var o=n,e={x:-1==o.so[0]?Math.min(i,u):Math.max(i,u),y:-1==o.so[1]?Math.min(i,u):Math.max(i,u)}[t];return{x:[[e,r],[e,f],[u,f]],y:[[r,e],[f,e],[f,u]]}[t]},opposite:function(i,r,f,e){var s=n,l={x:"y",y:"x"}[i],v={x:"height",y:"width"}[i],y=s["is"+i.toUpperCase()+"GreaterThanStubTimes2"],h;return t.sourceEndpoint.elementId==t.targetEndpoint.elementId?(h=f+(1-t.sourceEndpoint.anchor[l])*t.sourceInfo[v]+u.maxStub,{x:[[r,h],[e,h]],y:[[h,r],[h,e]]}[i]):!y||1==s.so[a]&&r>e||-1==s.so[a]&&e>r?{x:[[r,c],[e,c]],y:[[o,r],[o,e]]}[i]:1==s.so[a]&&e>r||-1==s.so[a]&&r>e?{x:[[o,s.sy],[o,s.ty]],y:[[s.sx,c],[s.tx,c]]}[i]:void 0}},l=nt[n.anchorOrientation](n.sourceAxis),a="x"==n.sourceAxis?0:1,g="x"==n.sourceAxis?1:0,it=l[a],rt=l[g],ut=l[a+2],ft=l[g+2];if(s(i,l[0],l[1],n),w=tt[n.anchorOrientation](n.sourceAxis,it,rt,ut,ft),w)for(b=0;b<w.length;b++)s(i,w[b][0],w[b][1],n);s(i,l[2],l[3],n);s(i,n.tx,n.ty,n);v(this,i,n)};this.getPath=function(){for(var t=null,f=null,e=[],o=r||i,u=0;u<o.length;u++){var n=o[u],s=n[4],h="v"==s?3:2;null!=t&&f===s?t[h]=n[h]:(n[0]!=n[2]||n[1]!=n[3])&&(e.push({start:[n[0],n[1]],end:[n[2],n[3]]}),t=n,f=n[4])}return e};this.setPath=function(n){var t;for(r=[],t=0;t<n.length;t++){var i=n[t].start[0],f=n[t].start[1],u=n[t].end[0],e=n[t].end[1],s=i==u?"v":"h",h=o(u-i),c=o(e-f);r.push([i,f,u,e,s,h,c])}}};r.extend(i,n.Connectors.AbstractConnector);n.registerConnectorType(i,"Flowchart")}.call(this),function(){"use strict";var t=this,n=t.jsPlumb,r=t.jsPlumbUtil,u=function(n,t,i,r){return i>=n&&t>=r?1:i>=n&&r>=t?2:n>=i&&r>=t?3:4},f=function(n,t,i,r,u,f,e,o,s){return s>=o?[n,t]:1===i?r[3]<=0&&u[3]>=1?[n+(r[2]<.5?-1*f:f),t]:r[2]>=1&&u[2]<=0?[n,t+(r[3]<.5?-1*e:e)]:[n+-1*f,t+-1*e]:2===i?r[3]>=1&&u[3]<=0?[n+(r[2]<.5?-1*f:f),t]:r[2]>=1&&u[2]<=0?[n,t+(r[3]<.5?-1*e:e)]:[n+f,t+-1*e]:3===i?r[3]>=1&&u[3]<=0?[n+(r[2]<.5?-1*f:f),t]:r[2]<=0&&u[2]>=1?[n,t+(r[3]<.5?-1*e:e)]:[n+-1*f,t+-1*e]:4===i?r[3]<=0&&u[3]>=1?[n+(r[2]<.5?-1*f:f),t]:r[2]<=0&&u[2]>=1?[n,t+(r[3]<.5?-1*e:e)]:[n+f,t+-1*e]:void 0},i=function(t){t=t||{};this.type="StateMachine";var e=n.Connectors.AbstractConnector.apply(this,arguments),o=t.curviness||10,i=t.margin||5,s=t.proximityLimit||80,h=t.orientation&&"clockwise"===t.orientation,r=t.loopbackRadius||25,c=t.showLoopback!==!1;this._compute=function(n,t){var g=Math.abs(t.sourcePos[0]-t.targetPos[0]),nt=Math.abs(t.sourcePos[1]-t.targetPos[1]);if(c&&t.sourceEndpoint.elementId===t.targetEndpoint.elementId){var k=t.sourcePos[0],d=t.sourcePos[1]-i,tt=k,it=d-r,rt=2*r,ut=2*r,p=tt-r,w=it-r;n.points[0]=p;n.points[1]=w;n.points[2]=rt;n.points[3]=ut;e.addSegment(this,"Arc",{loopback:!0,x1:k-p+4,y1:d-w,startAngle:0,endAngle:2*Math.PI,r:r,ac:!h,x2:k-p-4,y2:d-w,cx:tt-p,cy:it-w})}else{var l=t.sourcePos[0]<t.targetPos[0]?0:g,a=t.sourcePos[1]<t.targetPos[1]?0:nt,v=t.sourcePos[0]<t.targetPos[0]?g:0,y=t.sourcePos[1]<t.targetPos[1]?nt:0;0===t.sourcePos[2]&&(l-=i);1===t.sourcePos[2]&&(l+=i);0===t.sourcePos[3]&&(a-=i);1===t.sourcePos[3]&&(a+=i);0===t.targetPos[2]&&(v-=i);1===t.targetPos[2]&&(v+=i);0===t.targetPos[3]&&(y-=i);1===t.targetPos[3]&&(y+=i);var ft=(l+v)/2,et=(a+y)/2,ot=u(l,a,v,y),st=Math.sqrt(Math.pow(v-l,2)+Math.pow(y-a,2)),b=f(ft,et,ot,t.sourcePos,t.targetPos,o,o,st,s);e.addSegment(this,"Bezier",{x1:v,y1:y,x2:l,y2:a,cp1x:b[0],cp1y:b[1],cp2x:b[0],cp2y:b[1]})}}};r.extend(i,n.Connectors.AbstractConnector);n.registerConnectorType(i,"StateMachine")}.call(this),function(){"use strict";var t=this,n=t.jsPlumb,r=t.jsPlumbUtil,i=function(t){t=t||{};var u=n.Connectors.AbstractConnector.apply(this,arguments),r=t.curviness||150,i=10;this.type="Bezier";this.getCurviness=function(){return r};this._findControlPoint=function(n,t,u,f,e,o,s){var c=o[0]!=s[0]||o[1]==s[1],h=[];return c?(0===s[0]?h.push(u[0]<t[0]?n[0]+i:n[0]-i):h.push(n[0]+r*s[0]),0===s[1]?h.push(u[1]<t[1]?n[1]+i:n[1]-i):h.push(n[1]+r*o[1])):(0===o[0]?h.push(t[0]<u[0]?n[0]+i:n[0]-i):h.push(n[0]-r*o[0]),0===o[1]?h.push(t[1]<u[1]?n[1]+i:n[1]-i):h.push(n[1]+r*s[1])),h};this._compute=function(n,t){var i=t.sourcePos,r=t.targetPos,f=Math.abs(i[0]-r[0]),e=Math.abs(i[1]-r[1]),o=i[0]<r[0]?f:0,s=i[1]<r[1]?e:0,h=i[0]<r[0]?0:f,c=i[1]<r[1]?0:e,l=this._findControlPoint([o,s],i,r,t.sourceEndpoint,t.targetEndpoint,n.so,n.to),a=this._findControlPoint([h,c],r,i,t.targetEndpoint,t.sourceEndpoint,n.to,n.so);u.addSegment(this,"Bezier",{x1:o,y1:s,x2:h,y2:c,cp1x:l[0],cp1y:l[1],cp2x:a[0],cp2y:a[1]})}};r.extend(i,n.Connectors.AbstractConnector);n.registerConnectorType(i,"Bezier")}.call(this),function(){"use strict";var l=this,n=l.jsPlumb,t=l.jsPlumbUtil,a={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},o="stroke-dasharray",h="dashstyle",d="linearGradient",g="radialGradient",nt="defs",v="fill",tt="stop",y="stroke",it="stroke-width",rt="style",p="none",ut="jsplumb_gradient_",ft="lineWidth",w={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},r=function(n,t){for(var i in t)n.setAttribute(i,""+t[i])},i=function(n,t){return t=t||{},t.version="1.1",t.xmlns=w.xhtml,jsPlumb.createElementNS(w.svg,n,null,null,t)},s=function(n){return"position:absolute;left:"+n[0]+"px;top:"+n[1]+"px"},b=function(n){for(var i=n.querySelectorAll(" defs linearGradient radialGradient"),t=0;t<i.length;t++)i[t].parentNode.removeChild(i[t])},et=function(n,r,u,f,e){var s=ut+e._jsPlumb.instance.idstamp(),h,c,o,l;for(b(n),h=u.gradient.offset?i(g,{id:s}):i(d,{id:s,gradientUnits:"userSpaceOnUse"}),c=i(nt),n.appendChild(c),c.appendChild(h),o=0;o<u.gradient.stops.length;o++){var a=1==e.segment||2==e.segment?o:u.gradient.stops.length-1-o,p=t.convertStyle(u.gradient.stops[a][1],!0),w=i(tt,{offset:Math.floor(100*u.gradient.stops[o][0])+"%","stop-color":p});h.appendChild(w)}l=u.strokeStyle?y:v;r.setAttribute(l,"url(#"+s+")")},c=function(n,i,r,u,f){var e;if(i.setAttribute(v,r.fillStyle?t.convertStyle(r.fillStyle,!0):p),i.setAttribute(y,r.strokeStyle?t.convertStyle(r.strokeStyle,!0):p),r.gradient?et(n,i,r,u,f):(b(n),i.setAttribute(rt,"")),r.lineWidth&&i.setAttribute(it,r.lineWidth),r[h]&&r[ft]&&!r[o]){var s=-1==r[h].indexOf(",")?" ":",",l=r[h].split(s),c="";l.forEach(function(n){c+=Math.floor(n*r.lineWidth)+s});i.setAttribute(o,c)}else r[o]&&i.setAttribute(o,r[o]);for(e in a)r[e]&&i.setAttribute(a[e],r[e])},k=function(n,t,i){n.childNodes.length>i?n.insertBefore(t,n.childNodes[i]):n.appendChild(t)},f,e,u;t.svg={node:i,attr:r,pos:s};f=function(u){var c=u.pointerEventsSpec||"all",o={},f,h,e;return n.jsPlumbUIComponent.apply(this,u.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null,f=u.cssClass+" "+(u.originalArgs[0].cssClass||""),h={style:"",width:0,height:0,"pointer-events":c,position:"absolute"},this.svg=i("svg",h),u.useDivWrapper?(this.canvas=jsPlumb.createElement("div",{position:"absolute"}),t.sizeElement(this.canvas,0,0,1,1),this.canvas.className=f):(r(this.svg,{"class":f}),this.canvas=this.svg),u._jsPlumb.appendElement(this.canvas,u.originalArgs[0].parent),u.useDivWrapper&&this.canvas.appendChild(this.svg),e=[this.canvas],this.getDisplayElements=function(){return e},this.appendDisplayElement=function(n){e.push(n)},this.paint=function(n,i,f){if(null!=n){var c,e=[this.x,this.y],h=[this.w,this.h];null!=f&&(f.xmin<0&&(e[0]+=f.xmin),f.ymin<0&&(e[1]+=f.ymin),h[0]=f.xmax+(f.xmin<0?-f.xmin:0),h[1]=f.ymax+(f.ymin<0?-f.ymin:0));u.useDivWrapper?(t.sizeElement(this.canvas,e[0],e[1],h[0],h[1]),e[0]=0,e[1]=0,c=s([0,0])):c=s([e[0],e[1]]);o.paint.apply(this,arguments);r(this.svg,{style:c,width:h[0]||0,height:h[1]||0})}},{renderer:o}};t.extend(f,n.jsPlumbUIComponent,{cleanup:function(n){n||null==this.typeId?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(n){var t=n.getContainer();this.canvas&&null==this.canvas.parentNode&&t.appendChild(this.canvas);this.bgCanvas&&null==this.bgCanvas.parentNode&&t.appendChild(this.bgCanvas)},setVisible:function(n){this.canvas&&(this.canvas.style.display=n?"block":"none")}});n.ConnectorRenderers.svg=function(u){var e=this,o=f.apply(this,[{cssClass:u._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:u._jsPlumb}]);o.renderer.paint=function(f,o,s){var y=e.getSegments(),p="",l=[0,0],a,b,d;if(s.xmin<0&&(l[0]=-s.xmin),s.ymin<0&&(l[1]=-s.ymin),y.length>0){for(a=0;a<y.length;a++)p+=n.Segments.svg.SegmentRenderer.getPath(y[a]),p+=" ";var v={d:p,transform:"translate("+l[0]+","+l[1]+")","pointer-events":u["pointer-events"]||"visibleStroke"},h=null,w=[e.x,e.y,e.w,e.h];f.outlineColor&&(b=f.outlineWidth||1,d=f.lineWidth+2*b,h=n.extend({},f),delete h.gradient,h.strokeStyle=t.convertStyle(f.outlineColor),h.lineWidth=d,null==e.bgPath?(e.bgPath=i("path",v),n.addClass(e.bgPath,n.connectorOutlineClass),k(e.svg,e.bgPath,0)):r(e.bgPath,v),c(e.svg,e.bgPath,h,w,e));null==e.path?(e.path=i("path",v),k(e.svg,e.path,f.outlineColor?1:0)):r(e.path,v);c(e.svg,e.path,f,w,e)}}};t.extend(n.ConnectorRenderers.svg,f);n.Segments.svg={SegmentRenderer:{getPath:function(n){return{Straight:function(){var t=n.getCoordinates();return"M "+t.x1+" "+t.y1+" L "+t.x2+" "+t.y2},Bezier:function(){var t=n.params;return"M "+t.x1+" "+t.y1+" C "+t.cp1x+" "+t.cp1y+" "+t.cp2x+" "+t.cp2y+" "+t.x2+" "+t.y2},Arc:function(){var t=n.params,i=n.sweep>Math.PI?1:0,r=n.anticlockwise?0:1;return"M"+n.x1+" "+n.y1+" A "+n.radius+" "+t.r+" 0 "+i+","+r+" "+n.x2+" "+n.y2}}[n.type]()}}};e=n.SvgEndpoint=function(i){var r=f.apply(this,[{cssClass:i._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:i._jsPlumb}]);r.renderer.paint=function(i){var r=n.extend({},i);r.outlineColor&&(r.strokeWidth=r.outlineWidth,r.strokeStyle=t.convertStyle(r.outlineColor,!0));null==this.node?(this.node=this.makeNode(r),this.svg.appendChild(this.node)):null!=this.updateNode&&this.updateNode(this.node);c(this.svg,this.node,r,[this.x,this.y,this.w,this.h],this);s(this.node,[this.x,this.y])}.bind(this)};t.extend(e,f);n.Endpoints.svg.Dot=function(){n.Endpoints.Dot.apply(this,arguments);e.apply(this,arguments);this.makeNode=function(){return i("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})};this.updateNode=function(n){r(n,{cx:this.w/2,cy:this.h/2,r:this.radius})}};t.extend(n.Endpoints.svg.Dot,[n.Endpoints.Dot,e]);n.Endpoints.svg.Rectangle=function(){n.Endpoints.Rectangle.apply(this,arguments);e.apply(this,arguments);this.makeNode=function(){return i("rect",{width:this.w,height:this.h})};this.updateNode=function(n){r(n,{width:this.w,height:this.h})}};t.extend(n.Endpoints.svg.Rectangle,[n.Endpoints.Rectangle,e]);n.Endpoints.svg.Image=n.Endpoints.Image;n.Endpoints.svg.Blank=n.Endpoints.Blank;n.Overlays.svg.Label=n.Overlays.Label;n.Overlays.svg.Custom=n.Overlays.Custom;u=function(t,u){t.apply(this,u);n.jsPlumbUIComponent.apply(this,u);this.isAppendedAtTopLevel=!1;this.path=null;this.paint=function(n,t){if(n.component.svg&&t){null==this.path&&(this.path=i("path",{"pointer-events":"all"}),n.component.svg.appendChild(this.path),this.canvas=n.component.svg);var o=u&&1==u.length?u[0].cssClass||"":"",e=[0,0];t.xmin<0&&(e[0]=-t.xmin);t.ymin<0&&(e[1]=-t.ymin);r(this.path,{d:f(n.d),"class":o,stroke:n.strokeStyle?n.strokeStyle:null,fill:n.fillStyle?n.fillStyle:null,transform:"translate("+e[0]+","+e[1]+")"})}};var f=function(n){return isNaN(n.cxy.x)||isNaN(n.cxy.y)?"":"M"+n.hxy.x+","+n.hxy.y+" L"+n.tail[0].x+","+n.tail[0].y+" L"+n.cxy.x+","+n.cxy.y+" L"+n.tail[1].x+","+n.tail[1].y+" L"+n.hxy.x+","+n.hxy.y};this.transfer=function(n){n.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),n.canvas.appendChild(this.path))}};t.extend(u,[n.jsPlumbUIComponent,n.Overlays.AbstractOverlay],{cleanup:function(n){null!=this.path&&(n?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(){this.path&&this.canvas&&null==this.path.parentNode&&this.canvas.appendChild(this.path)},setVisible:function(n){null!=this.path&&(this.path.style.display=n?"block":"none")}});n.Overlays.svg.Arrow=function(){u.apply(this,[n.Overlays.Arrow,arguments])};t.extend(n.Overlays.svg.Arrow,[n.Overlays.Arrow,u]);n.Overlays.svg.PlainArrow=function(){u.apply(this,[n.Overlays.PlainArrow,arguments])};t.extend(n.Overlays.svg.PlainArrow,[n.Overlays.PlainArrow,u]);n.Overlays.svg.Diamond=function(){u.apply(this,[n.Overlays.Diamond,arguments])};t.extend(n.Overlays.svg.Diamond,[n.Overlays.Diamond,u]);n.Overlays.svg.GuideLines=function(){var f,e,u=null,t=this,o;n.Overlays.GuideLines.apply(this,arguments);this.paint=function(n,s){null==u&&(u=i("path"),n.connector.svg.appendChild(u),t.attachListeners(u,n.connector),t.attachListeners(u,t),f=i("path"),n.connector.svg.appendChild(f),t.attachListeners(f,n.connector),t.attachListeners(f,t),e=i("path"),n.connector.svg.appendChild(e),t.attachListeners(e,n.connector),t.attachListeners(e,t));var h=[0,0];s.xmin<0&&(h[0]=-s.xmin);s.ymin<0&&(h[1]=-s.ymin);r(u,{d:o(n.head,n.tail),stroke:"red",fill:null,transform:"translate("+h[0]+","+h[1]+")"});r(f,{d:o(n.tailLine[0],n.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+h[0]+","+h[1]+")"});r(e,{d:o(n.headLine[0],n.headLine[1]),stroke:"green",fill:null,transform:"translate("+h[0]+","+h[1]+")"})};o=function(n,t){return"M "+n.x+","+n.y+" L"+t.x+","+t.y}};t.extend(n.Overlays.svg.GuideLines,n.Overlays.GuideLines)}.call(this),function(){"use strict";var v=this,n=v.jsPlumb,i=v.jsPlumbUtil,k={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},y=null,l,p,c,b,h,f;if(document.createStyleSheet&&document.namespaces){for(l=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],p="behavior:url(#default#VML);position:absolute;",y=document.createStyleSheet(),c=0;c<l.length;c++)y.addRule(l[c],p);document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}n.vml={};var r=1e3,o=function(n,t){for(var i in t)n[i]=t[i]},u=function(n,t,i,r,u,f){i=i||{};var e=document.createElement("jsplumb:"+n);return f?u.appendElement(e,r):r.appendChild(e),e.className=(i["class"]?i["class"]+" ":"")+"jsplumb_vml",s(e,t),o(e,i),e},s=function(n,t,i){n.style.left=t[0]+"px";n.style.top=t[1]+"px";n.style.width=t[2]+"px";n.style.height=t[3]+"px";n.style.position="absolute";i&&(n.style.zIndex=i)},t=n.vml.convertValue=function(n){return Math.floor(n*r)},w=function(n,t,i,r){"transparent"===t?r.setOpacity(i,"0.0"):r.setOpacity(i,"1.0")},a=function(n,t,r,f){var e={},s,h;if(t.strokeStyle?(e.stroked="true",s=i.convertStyle(t.strokeStyle,!0),e.strokecolor=s,w(e,s,"stroke",r),e.strokeweight=t.lineWidth+"px"):e.stroked="false",t.fillStyle?(e.filled="true",h=i.convertStyle(t.fillStyle,!0),e.fillcolor=h,w(e,h,"fill",r)):e.filled="false",t.dashstyle)null==r.strokeNode?r.strokeNode=u("stroke",[0,0,0,0],{dashstyle:t.dashstyle},n,f):r.strokeNode.dashstyle=t.dashstyle;else if(t["stroke-dasharray"]&&t.lineWidth){for(var a=-1==t["stroke-dasharray"].indexOf(",")?" ":",",v=t["stroke-dasharray"].split(a),c="",l=0;l<v.length;l++)c+=Math.floor(v[l]/t.lineWidth)+a;null==r.strokeNode?r.strokeNode=u("stroke",[0,0,0,0],{dashstyle:c},n,f):r.strokeNode.dashstyle=c}o(n,e)},e=function(){var t=this,i;n.jsPlumbUIComponent.apply(this,arguments);this.opacityNodes={stroke:null,fill:null};this.initOpacityNodes=function(n){t.opacityNodes.stroke=u("stroke",[0,0,1,1],{opacity:"0.0"},n,t._jsPlumb.instance);t.opacityNodes.fill=u("fill",[0,0,1,1],{opacity:"0.0"},n,t._jsPlumb.instance)};this.setOpacity=function(n,i){var r=t.opacityNodes[n];r&&(r.opacity=""+i)};i=[];this.getDisplayElements=function(){return i};this.appendDisplayElement=function(n,r){r||t.canvas.parentNode.appendChild(n);i.push(n)}};i.extend(e,n.jsPlumbUIComponent,{cleanup:function(){this.bgCanvas&&this.bgCanvas.parentNode.removeChild(this.bgCanvas);this.canvas&&this.canvas.parentNode.removeChild(this.canvas)}});b=n.ConnectorRenderers.vml=function(t,f){this.strokeNode=null;this.canvas=null;e.apply(this,arguments);var h=this._jsPlumb.instance.connectorClass+(t.cssClass?" "+t.cssClass:"");this.paint=function(e){var y;if(null!==e){this.w=Math.max(this.w,1);this.h=Math.max(this.h,1);for(var p=this.getSegments(),l={path:""},c=[this.x,this.y,this.w,this.h],v=0;v<p.length;v++)l.path+=n.Segments.vml.SegmentRenderer.getPath(p[v]),l.path+=" ";if(e.outlineColor){var b=e.outlineWidth||1,d=e.lineWidth+2*b,w={strokeStyle:i.convertStyle(e.outlineColor),lineWidth:d};for(y in k)w[y]=e[y];null==this.bgCanvas?(l["class"]=h,l.coordsize=c[2]*r+","+c[3]*r,this.bgCanvas=u("shape",c,l,t.parent,this._jsPlumb.instance,!0),s(this.bgCanvas,c),this.appendDisplayElement(this.bgCanvas,!0),this.initOpacityNodes(this.bgCanvas,["stroke"]),this.bgCanvas._jsPlumb=f):(l.coordsize=c[2]*r+","+c[3]*r,s(this.bgCanvas,c),o(this.bgCanvas,l));a(this.bgCanvas,w,this)}null==this.canvas?(l["class"]=h,l.coordsize=c[2]*r+","+c[3]*r,this.canvas=u("shape",c,l,t.parent,this._jsPlumb.instance,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(this.canvas,["stroke"]),this.canvas._jsPlumb=f):(l.coordsize=c[2]*r+","+c[3]*r,s(this.canvas,c),o(this.canvas,l));a(this.canvas,e,this,this._jsPlumb.instance)}}};i.extend(b,e,{setVisible:function(n){this.canvas&&(this.canvas.style.display=n?"block":"none");this.bgCanvas&&(this.bgCanvas.style.display=n?"block":"none")}});h=n.VmlEndpoint=function(n){e.apply(this,arguments);this._jsPlumb.vml=null;this.canvas=document.createElement("div");this.canvas.style.position="absolute";this._jsPlumb.clazz=this._jsPlumb.instance.endpointClass+(n.cssClass?" "+n.cssClass:"");n._jsPlumb.appendElement(this.canvas,n.parent);this.paint=function(n,t){var u={},r=this._jsPlumb.vml;i.sizeElement(this.canvas,this.x,this.y,this.w,this.h);null==this._jsPlumb.vml?(u["class"]=this._jsPlumb.clazz,r=this._jsPlumb.vml=this.getVml([0,0,this.w,this.h],u,t,this.canvas,this._jsPlumb.instance),this.appendDisplayElement(r,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(r,["fill"])):(s(r,[0,0,this.w,this.h]),o(r,u));a(r,n,this)}};i.extend(h,e);n.Segments.vml={SegmentRenderer:{getPath:function(n){return{Straight:function(n){var i=n.params;return"m"+t(i.x1)+","+t(i.y1)+" l"+t(i.x2)+","+t(i.y2)+" e"},Bezier:function(n){var i=n.params;return"m"+t(i.x1)+","+t(i.y1)+" c"+t(i.cp1x)+","+t(i.cp1y)+","+t(i.cp2x)+","+t(i.cp2y)+","+t(i.x2)+","+t(i.y2)+" e"},Arc:function(n){var i=n.params,r=Math.min(i.x1,i.x2),u=(Math.max(i.x1,i.x2),Math.min(i.y1,i.y2)),f=(Math.max(i.y1,i.y2),n.anticlockwise?1:0),e=n.anticlockwise?"at ":"wa ",o=function(){if(i.loopback)return"0,0,"+t(2*i.r)+","+t(2*i.r);var e=[null,[function(){return[r,u]},function(){return[r-i.r,u-i.r]}],[function(){return[r-i.r,u]},function(){return[r,u-i.r]}],[function(){return[r-i.r,u-i.r]},function(){return[r,u]}],[function(){return[r,u-i.r]},function(){return[r-i.r,u]}]][n.segment][f]();return t(e[0])+","+t(e[1])+","+t(e[0]+2*i.r)+","+t(e[1]+2*i.r)};return e+" "+o()+","+t(i.x1)+","+t(i.y1)+","+t(i.x2)+","+t(i.y2)+" e"}}[n.type](n)}}};n.Endpoints.vml.Dot=function(){n.Endpoints.Dot.apply(this,arguments);h.apply(this,arguments);this.getVml=function(n,t,i,r,f){return u("oval",n,t,r,f)}};i.extend(n.Endpoints.vml.Dot,h);n.Endpoints.vml.Rectangle=function(){n.Endpoints.Rectangle.apply(this,arguments);h.apply(this,arguments);this.getVml=function(n,t,i,r,f){return u("rect",n,t,r,f)}};i.extend(n.Endpoints.vml.Rectangle,h);n.Endpoints.vml.Image=n.Endpoints.Image;n.Endpoints.vml.Blank=n.Endpoints.Blank;n.Overlays.vml.Label=n.Overlays.Label;n.Overlays.vml.Custom=n.Overlays.Custom;f=function(n,f){var h,c;n.apply(this,f);e.apply(this,f);h=this;this.canvas=null;this.isAppendedAtTopLevel=!0;c=function(n){return"m "+t(n.hxy.x)+","+t(n.hxy.y)+" l "+t(n.tail[0].x)+","+t(n.tail[0].y)+" "+t(n.cxy.x)+","+t(n.cxy.y)+" "+t(n.tail[1].x)+","+t(n.tail[1].y)+" x e"};this.paint=function(n,t){var w,b;if(n.component.canvas&&t){var l={},e=n.d,a=n.component;n.strokeStyle&&(l.stroked="true",l.strokecolor=i.convertStyle(n.strokeStyle,!0));n.lineWidth&&(l.strokeweight=n.lineWidth+"px");n.fillStyle&&(l.filled="true",l.fillcolor=n.fillStyle);var y=Math.min(e.hxy.x,e.tail[0].x,e.tail[1].x,e.cxy.x),p=Math.min(e.hxy.y,e.tail[0].y,e.tail[1].y,e.cxy.y),k=Math.max(e.hxy.x,e.tail[0].x,e.tail[1].x,e.cxy.x),d=Math.max(e.hxy.y,e.tail[0].y,e.tail[1].y,e.cxy.y),g=Math.abs(k-y),nt=Math.abs(d-p),v=[y,p,g,nt];(l.path=c(e),l.coordsize=a.w*r+","+a.h*r,v[0]=a.x,v[1]=a.y,v[2]=a.w,v[3]=a.h,null==h.canvas)?(w=a._jsPlumb.overlayClass||"",b=f&&1==f.length?f[0].cssClass||"":"",l["class"]=b+" "+w,h.canvas=u("shape",v,l,a.canvas.parentNode,a._jsPlumb.instance,!0),a.appendDisplayElement(h.canvas,!0)):(s(h.canvas,v),o(h.canvas,l))}};this.cleanup=function(){null!=this.canvas&&this._jsPlumb.instance.removeElement(this.canvas)}};i.extend(f,[e,n.Overlays.AbstractOverlay],{setVisible:function(n){this.canvas.style.display=n?"block":"none"}});n.Overlays.vml.Arrow=function(){f.apply(this,[n.Overlays.Arrow,arguments])};i.extend(n.Overlays.vml.Arrow,[n.Overlays.Arrow,f]);n.Overlays.vml.PlainArrow=function(){f.apply(this,[n.Overlays.PlainArrow,arguments])};i.extend(n.Overlays.vml.PlainArrow,[n.Overlays.PlainArrow,f]);n.Overlays.vml.Diamond=function(){f.apply(this,[n.Overlays.Diamond,arguments])};i.extend(n.Overlays.vml.Diamond,[n.Overlays.Diamond,f])}.call(this),function(){"use strict";var t=this,i=t.jsPlumb,r=t.jsPlumbUtil,f=t.Katavorio,e=t.Biltong,n=function(n,t){t=t||"main";var u="_katavorio_"+t,i=n[u],o=n.getEventManager();return i||(i=new f({bind:o.on,unbind:o.off,getSize:jsPlumb.getSize,getPosition:function(t){var i=n.getOffset(t);return[i.left,i.top]},setPosition:function(n,t){n.style.left=t[0]+"px";n.style.top=t[1]+"px"},addClass:jsPlumb.addClass,removeClass:jsPlumb.removeClass,intersects:e.intersects,indexOf:r.indexOf,css:{noSelect:n.dragSelectClass,droppable:"jsplumb-droppable",draggable:"jsplumb-draggable",drag:"jsplumb-drag",selected:"jsplumb-drag-selected",active:"jsplumb-drag-active",hover:"jsplumb-drag-hover"}}),n[u]=i,n.bind("zoom",i.setZoom)),i},o=function(n,t){var i=function(i){if(t[i]){if(r.isString(t[i])){var u=t[i].match(/-=/)?-1:1,f=t[i].substring(2);return n[i]+u*f}return t[i]}return n[i]};return[i("left"),i("top")]},u;i.extend(t.jsPlumbInstance.prototype,{animationSupported:!0,scopeChange:function(){},getElement:function(n){return null==n?null:(n="string"==typeof n?n:null!=n.length&&null==n.enctype?n[0]:n,"string"==typeof n?document.getElementById(n):n)},removeElement:function(t){n(this).elementRemoved(t);this.getEventManager().remove(t)},doAnimate:function(n,t,i){i=i||{};var r=this.getOffset(n),s=o(r,t),h=s[0]-r.left,c=s[1]-r.top,e=i.duration||250,u=15,l=e/u,a=u/e*h,v=u/e*c,f=0,y=setInterval(function(){jsPlumb.setPosition(n,{left:r.left+a*(f+1),top:r.top+v*(f+1)});null!=i.step&&i.step();f++;f>=l&&(window.clearInterval(y),null!=i.complete&&i.complete())},u)},destroyDraggable:function(t,i){n(this,i).destroyDraggable(t)},destroyDroppable:function(t,i){n(this,i).destroyDroppable(t)},initDraggable:function(t,i,r){n(this,r).draggable(t,i)},initDroppable:function(t,i,r){n(this,r).droppable(t,i)},isAlreadyDraggable:function(n){return null!=n._katavorioDrag},isDragSupported:function(){return!0},isDropSupported:function(){return!0},isElementDraggable:function(n){return n=jsPlumb.getElement(n),n._katavorioDrag&&n._katavorioDrag.isEnabled()},getDragObject:function(n){return n[0].drag.getDragElement()},getDragScope:function(n){return n._katavorioDrag&&n._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(n){return n[0].e},getDropScope:function(n){return n._katavorioDrop&&n._katavorioDrop.scopes.join(" ")||""},getUIPosition:function(n){return{left:n[0].pos[0],top:n[0].pos[1]}},setDragFilter:function(n,t,i){n._katavorioDrag&&n._katavorioDrag.setFilter(t,i)},setElementDraggable:function(n,t){n=jsPlumb.getElement(n);n._katavorioDrag&&n._katavorioDrag.setEnabled(t)},setDragScope:function(n,t){n._katavorioDrag&&n._katavorioDrag.k.setDragScope(n,t)},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},animEvents:{step:"step",complete:"complete"},stopDrag:function(n){n._katavorioDrag&&n._katavorioDrag.abort()},addToDragSelection:function(t){n(this).select(t)},removeFromDragSelection:function(t){n(this).deselect(t)},clearDragSelection:function(){n(this).deselectAll()},getOriginalEvent:function(n){return n},trigger:function(n,t,i){this.getEventManager().trigger(n,t,i)},doReset:function(){for(var n in this)0===n.indexOf("_katavorio_")&&this[n].reset()}});u=function(n){var t=function(){/complete|loaded|interactive/.test(document.readyState)&&"undefined"!=typeof document.body&&null!=document.body?n():setTimeout(t,9)};t()};u(i.init)}.call(this);