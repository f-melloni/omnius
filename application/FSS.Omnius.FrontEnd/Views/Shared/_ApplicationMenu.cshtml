@using FSS.Omnius.Modules.Entitron.Entity.Tapestry
@model List<TapestryDesignerMenuItem>

@if (Model.Count() > 0)
{
    <ul @((int)ViewBag.Level == 0 ? " id=appMenu" : "")>
        @foreach (TapestryDesignerMenuItem item in Model.OrderBy(i => i.MenuOrder))
        {
            @Raw("@if (Context.GetLoggedUser().canUseBlock(\"" + item.rights + "\"," + ViewBag.AppId + "))")
            @("{")
            <li>
                @if (item.IsMetablock)
                {
                    <h4>@item.Name</h4>
                    @Raw(item.SubMenu)
                }
                else
                {
                    <a href="/@ViewBag.AppName/@item.BlockName">@item.Name</a>
                }
            </li>
            @("}")
        }
    </ul>
}
